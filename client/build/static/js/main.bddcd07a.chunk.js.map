{"version":3,"sources":["pages/Home/styles_Home.js","pages/Home/Introduction/main_Introduction.js","pages/Home/Tutorial/main_Tutorial.js","pages/Home/annotateComponents/ImageCanvas/useMouse.js","pages/Home/annotateComponents/ImageCanvas/useProjectBox.js","pages/Home/annotateComponents/ImageCanvas/regionTools.js","pages/Home/annotateComponents/RegionLabel/styles_RegionLabel.js","pages/Home/annotateComponents/RegionLabel/main_RegionLabel.js","pages/Home/annotateComponents/RegionTags/main_RegionTags.js","pages/Home/annotateComponents/TransformBoxes/main_TransformBoxes.js","pages/Home/annotateComponents/ImageCanvas/background.js","pages/Home/annotateComponents/ShortcutsManager/main_ShortcutsManager.js","pages/Home/annotateComponents/RegionShapes/main_RegionShapes.js","pages/Home/annotateComponents/ImageCanvas/main_ImageCanvas.js","pages/Home/annotateComponents/ImageCanvas/styles_ImageCanvas.js","pages/Home/annotateComponents/MainLayout/styles_MainLayout.js","pages/Home/annotateComponents/reducers/getActiveImage.js","pages/Home/annotateComponents/MainLayout/iconDictionary.js","pages/Home/annotateComponents/MainLayout/main_MainLayout.js","pages/Home/annotateComponents/reducers/historyHandler.js","pages/Home/annotateComponents/ImageCanvas/colors.js","pages/Home/annotateComponents/reducers/generalReducer.js","pages/Home/annotateComponents/reducers/imageReducer.js","pages/Home/annotateComponents/main_Annotate.js","pages/Home/annotateComponents/reducers/combineReducers.js","pages/Home/SubmitHIT/main_SubmitHIT.js","pages/Home/main_Home.js","pages/ShowResult/main_ShowResult.js","route.js","pages/Home/SubmitHIT/serviceWorker.js","index.js"],"names":["homeContainer","margin","width","fontFamily","introTutorial","backgroundColor","paddingBottom","introContainer","color","textAlign","paddingTop","jumbotron","introContent","padding","fontSize","introTitle","fontWeight","bold","buttonTitle","card","tutorialTitles","imageContainer","display","maxWidth","media","height","avatar","red","steps","paddingLeft","annotateContainer","marginTop","myStyle","makeStyles","styles","Introduction","props","classes","React","useState","opened","setOpened","title","setTitle","className","Jumbotron","intro","Button","variant","size","onClick","e","class","children","Tutorial","data","dense","root","Card","Box","boxShadow","CardHeader","subheader","CardMedia","image","tutorial","imgUrl","CardContent","List","console","log","map","step","ListItem","ListItemText","primary","canvasEl","changeMat","changeDragging","zoomStart","changeZoomStart","zoomEnd","changeZoomEnd","layoutParams","zoomWithPrimary","dragWithPrimary","mat","onMouseMove","onMouseUp","onMouseDown","dragging","mousePosition","useRef","x","y","prevMousePosition","zoomIn","direction","point","mx","my","scale","to","a","translate","scaleU","clone","mouseEvents","current","getBoundingClientRect","left","top","clientX","clientY","projMouse","applyToPoint","iw","ih","preventDefault","specialEvent","button","type","Math","abs","min","newMat","Matrix","from","onWheel","deltaY","onContextMenu","useEventCallback","r","bbox","region","rectangle","points","w","h","max","xr","yr","Error","getEnclosingBox","cbox","inverse","d","regionInfo","cursor","transition","opacity","grey","flexDirection","alignItems","marginRight","borderRadius","textDecoration","commentBox","memo","editing","allowedTags","onDelete","onChange","onClose","onOpen","allowComments","commentInputRef","Paper","classnames","highlighted","style","paddingRight","textShadow","flexGrow","IconButton","tabIndex","length","newTags","tags","t","value","placeholder","c","label","isMulti","options","asMutable","TextField","InputProps","fullWidth","multiline","rows","ref","_","commentInput","focus","comment","event","target","cls","key","prevProps","nextProps","RegionTags","regions","projectRegionBox","regionTagList","onBeginRegionEdit","onChangeRegion","onCloseRegionEdit","onDeleteRegion","imageSrc","RegionEditLabel","onRegionClassAdded","RegionLabel","DefaultRegionLabel","filter","visible","undefined","pbox","labelBoxHeight","editingLabels","locked","displayOnTop","coords","id","position","zIndex","bottom","pointerEvents","onMouseEnter","obj","newObj","args","arg","copyWithout","TransformMyStyles","styled","border","boxCursorMap","RegionSelectAndTransformBox","createWithPrimary","onBeginMovePoint","onSelectRegion","onBeginBoxTransform","onBeginMovePolygonPoint","onBeginMovePolygon1Point","onAddPolygonPoint","onBeginMoveKeypoint","onAddPolygon1Point","onBeginCircleTransform","i","px","py","sqrt","pow","proj","open","p1","p2","pa","prev","next","RegionSelectAndTransformBoxes","n","p","StyledImage","right","whiteSpace","imagePosition","onLoad","useCrossOrigin","imageRef","error","setError","onImageLoaded","imageElm","currentTarget","naturalWidth","naturalHeight","onImageError","stylePosition","useMemo","bottomRight","topLeft","imageRendering","isNaN","src","onError","crossOrigin","RegionComponents","transform","strokeWidth","stroke","fill","colorAlpha","circle","rx","ry","cx","cy","polygon1","Component","fullSegmentationMode","join","polygon","pixel","WrappedRegionList","keypointDefinitions","regionId","RegionShapes","canvas","zoomIndicator","getCanvasDimension","allowedArea","dimension","ImageCanvas","onLoaded","zoomOnAllowedArea","nBeginCircleTransform","useRafState","useMouse","useProjectRegionBox","imageDimensions","changeImageDimensions","imageLoaded","Boolean","ImageLoaded","dims","clientWidth","clientHeight","fitScale","canvasWidth","canvasHeight","useEffect","useLayoutEffect","context","getContext","save","toArray","globalAlpha","outer","inner","moveTo","forEach","lineTo","closePath","reverse","restore","zoomBox","maxHeight","overflow","toFixed","container","headerTitle","state","pathToActiveImage","activeImage","currentImageIndex","annotationType","selectedImage","getIn","defaultKeyMap","description","binding","useDispatchHotkeyHandlers","dispatch","zoom_tool","selectedTool","create_point","create_rectangle","pan_tool","create_polygon","create_polygon1","create_circle","save_and_previous_sample","buttonName","save_and_next_sample","save_and_exit_sample","delete_region","undo","faStyle","marginBottom","iconDictionary","pan","fixedWidth","icon","faHandPaper","zoom","faSearch","faCrosshairs","faVectorSquare","faDrawPolygon","faMinusSquare","faCircle","HotkeyDiv","withHotKeys","hotKeys","divRef","MainLayout","dispatchAction","memoizedActionFns","action","params","fnKey","fn","reduce","acc","getActiveImage","images","useKey","detectKeys","innerContainerRef","hotkeyHandlers","refocusOnMouseEvent","useCallback","contains","document","activeElement","showTags","realSize","pointDistancePrecision","includes","onClickIconSidebarItem","item","name","onClickHeaderItem","onMouseOver","allowChanges","handlers","Workspace","headerLeftSide","headerItems","selectedTools","iconSidebarItems","helperText","alwaysShowing","enabledTools","typesToSaveWithHistory","BEGIN_BOX_TRANSFORM","BEGIN_MOVE_POINT","DELETE_REGION","BEGIN_CIRCLE_TRANSFORM","saveToHistory","updateIn","time","moment","toDate","without","concat","slice","colors","muiColors","rrggbb","bbggrr","replace","substr","parseInt","reverseParseColor","getRandomId","random","toString","split","Date","now","lastMouseMoveCall","setIn","getRegionIndex","regionIndex","findIndex","getRegion","modifyRegion","closeEditors","setNewImage","img","index","imageIndex","oldRegion","clsIndex","regionClsList","indexOf","isEqual","delta","Object","keys","mode","directions","freedom","original","pointIndex","splice","point1Index","point1","holes","creatingHole","mouseDownAt","moveRegion","xFree","yFree","ox","oy","ow","oh","dx","dw","dy","dh","newRegion","region1Index","defaultRegionCls","defaultRegionColor","editLabelEditorAfter","isNew","newRegions","toLowerCase","some","metadata","Annotator","onExit","onNextImage","onPrevImage","reducer","useReducer","reducers","combineReducers","imageReducer","generalReducer","prevState","nextState","history","makeImmutable","dispatchToReducer","alwaysShowNextButton","alwaysShowPrevButton","config","require","SubmitHIT","isLoaded","EnabledTools","AllowComments","Tags","imgData","submitTask","bind","getSubmissionUrl","handleSubmit","componentDidMount","res","Tools","fetch","then","json","result","push","getEnabledTools","setState","url","queryString","queryPieces","pieces","paramName","paramValue","input","getElementById","setAttribute","JSON","stringify","this","form","HTMLFormElement","prototype","submit","call","axios","post","response","catch","assignmentID","parseParameters","window","location","href","message","method","output","block","main_ShowResult","resultsArr","results","Submit","Annotation","customHistory","createBrowserHistory","exact","path","component","setTutorial","setIntro","hasError","setHasError","loading","setLoading","err","preview","hostname","match","ReactDOM","render","route","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.bddcd07a.chunk.js","sourcesContent":["import {red} from \"@material-ui/core/colors\";\nimport {bold} from \"colorette\";\n\nexport default {\n    homeContainer:{\n        margin: \"auto\",\n        width:\"85%\",\n        fontFamily: \"Arial\",\n    },\n    introTutorial:{\n        backgroundColor: \"#E8E8E8\",\n        paddingBottom:20,\n    },\n    /*intro*/\n    introContainer:{\n        color: \"DodgerBlue\",\n        textAlign: \"center\",\n       paddingTop: 10\n    },\n    jumbotron:{\n        paddingTop:100,\n        backgroundColor: \"#E8E8E8\"\n    },\n    introContent:{\n        padding: 40,\n        fontSize: \"x-large\",\n    },\n    introTitle: {\n        fontWeight: bold(),\n    },\n    buttonTitle: {\n        padding: \"40px\",\n    },\n    // tutorial\n    card:{\n        margin: 20,\n\n    },\n    tutorialTitles:{\n        textAlign: \"center\",\n\n    },\n    imageContainer: {\n        display: \"block\",\n        margin: \"auto\",\n        maxWidth: 1000,\n        padding:5,\n    },\n    media: {\n        height: 0,\n        paddingTop: '56.25%', // 16:9\n\n    },\n\n    avatar: {\n        backgroundColor: red[500],\n    },\n    steps:{\n        paddingLeft:\"25%\",\n    },\n    /*annotate*/\n    annotateContainer: {\n        marginTop: \"170px\",\n    }\n}\n\n","import React from \"react\";\nimport Button from 'react-bootstrap/Button';\nimport styles from \"../styles_Home\"\nimport {Jumbotron} from \"react-bootstrap\";\nimport { makeStyles } from '@material-ui/core/styles';\n// get style from style.js\nconst myStyle = makeStyles(styles);\n\nexport default function Introduction (props){\n    const classes = myStyle();\n    const [opened, setOpened] = React.useState(false);\n    const [title, setTitle]=React.useState('Show Tutorial');\n    function toggleTutorial(e) {\n        if (opened) {\n            setTitle('Show Tutorial');\n\n        } else {\n            setTitle('Hide Tutorial');\n\n        }\n        setOpened(!opened);\n\n    }\n    return (\n        <div>\n            <div className={classes.introContainer}>\n                <Jumbotron  className={classes.jumbotron}>\n                    <h1 className={classes.introTitle}>Task Overview</h1>\n                    <p className={classes.introContent}>\n                        { props.intro.intro}\n                    </p>\n                    <p>\n                        <div className={classes.buttonTitle}>\n                            <Button\n                                variant=\"outline-primary\"\n                                size=\"lg\"\n                                onClick={e => toggleTutorial(e)}>\n                                {title}\n                            </Button>\n                        </div>\n                    </p>\n                </Jumbotron>\n            </div>\n            {opened && (\n\n                <div class=\"boxContent\">\n                    {props.children}\n                </div>\n            )}\n        </div>\n    );\n}\n","import React, {useEffect, useState} from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport styles from \"../styles_Home\"\nimport {Card, CardContent, CardHeader, CardMedia, Box} from \"@material-ui/core\";\n// get style from style.js\n\nconst myStyle = makeStyles(styles);\n\nfunction generateSteps(data) {\n    console.log(\"data before is:\",data)\n    return !data ? null :data.map(step => {\n        return (<ListItem>\n            <ListItemText primary={step} />\n        </ListItem>)\n    });\n\n};\nexport default function Tutorial(props) {\n    const classes = myStyle();\n    const [dense, setDense] = React.useState(false);\n        return (\n            <div className={classes.root}>\n                <Card className={classes.card}>\n                    <Box boxShadow={3}>\n                        <CardHeader\n                            className={classes.tutorialTitles}\n                            title=\"Tutorial\"\n                            subheader=\"This short tutorial is meant to guide you through the annotation process. \"\n                        />\n                    </Box>\n                    <div className={classes.imageContainer}>\n                        <CardMedia\n                            className={classes.media}\n                            image={props.tutorial.imgUrl}/>\n                    </div>\n                    <Box boxShadow={3}>\n                        <CardContent className={classes.steps}>\n                            <List dense={dense}>\n                                {generateSteps(props.tutorial.steps)}\n                            </List>\n                        </CardContent>\n                    </Box>\n                </Card>\n            </div>\n        );\n    // }\n}\n","\nimport { useRef } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  canvasEl,\n  changeMat,\n  changeDragging,\n  zoomStart,\n  zoomEnd,\n  changeZoomStart,\n  changeZoomEnd,\n  layoutParams,\n  zoomWithPrimary,\n  dragWithPrimary,\n  mat,\n  onMouseMove,\n  onMouseUp,\n  onMouseDown,\n  dragging,\n}) => {\n  const mousePosition = useRef({ x: 0, y: 0 })\n  const prevMousePosition = useRef({ x: 0, y: 0 })\n\n  const zoomIn = (direction, point) => {\n    const [mx, my] = [point.x, point.y]\n    let scale =\n      typeof direction === \"object\" ? direction.to / mat.a : 1 + 0.2 * direction\n\n    //  mutating mat here\n    mat.translate(mx, my).scaleU(scale)\n    if (mat.a > 2) mat.scaleU(2 / mat.a)\n    if (mat.a < 0.05) mat.scaleU(0.05 / mat.a)\n    mat.translate(-mx, -my)\n\n    changeMat(mat.clone())\n  }\n\n  const mouseEvents = {\n    onMouseMove: (e) => {\n      const { left, top } = canvasEl.current.getBoundingClientRect()\n      prevMousePosition.current.x = mousePosition.current.x\n      prevMousePosition.current.y = mousePosition.current.y\n      mousePosition.current.x = e.clientX - left\n      mousePosition.current.y = e.clientY - top\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n\n      if (zoomWithPrimary && zoomStart) {\n        changeZoomEnd(projMouse)\n      }\n\n      const { iw, ih } = layoutParams.current\n      onMouseMove({ x: projMouse.x / iw, y: projMouse.y / ih })\n\n      if (dragging) {\n        mat.translate(\n          prevMousePosition.current.x - mousePosition.current.x,\n          prevMousePosition.current.y - mousePosition.current.y\n        )\n\n        changeMat(mat.clone())\n      }\n      e.preventDefault()\n    },\n    onMouseDown: (e, specialEvent = {}) => {\n      e.preventDefault()\n\n      if (\n        e.button === 1 ||\n        e.button === 2 ||\n        (e.button === 0 && dragWithPrimary)\n      )\n        return changeDragging(true)\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomWithPrimary && e.button === 0) {\n        changeZoomStart(projMouse)\n        changeZoomEnd(projMouse)\n        return\n      }\n      if (e.button === 0) {\n        if (specialEvent.type === \"resize-box\") {\n        }\n        if (specialEvent.type === \"move-region\") {\n        }\n        const { iw, ih } = layoutParams.current\n        onMouseDown({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onMouseUp: (e) => {\n      e.preventDefault()\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomStart) {\n        const zoomEnd = projMouse\n        if (\n          Math.abs(zoomStart.x - zoomEnd.x) < 10 &&\n          Math.abs(zoomStart.y - zoomEnd.y) < 10\n        ) {\n          if (mat.a < 1) {\n            zoomIn({ to: 1 }, mousePosition.current)\n          } else {\n            zoomIn({ to: 0.25 }, mousePosition.current)\n          }\n        } else {\n          const { iw, ih } = layoutParams.current\n\n          if (zoomStart.x > zoomEnd.x) {\n            ;[zoomStart.x, zoomEnd.x] = [zoomEnd.x, zoomStart.x]\n          }\n          if (zoomStart.y > zoomEnd.y) {\n            ;[zoomStart.y, zoomEnd.y] = [zoomEnd.y, zoomStart.y]\n          }\n\n          // The region defined by zoomStart and zoomEnd should be the new transform\n          let scale = Math.min(\n            (zoomEnd.x - zoomStart.x) / iw,\n            (zoomEnd.y - zoomStart.y) / ih\n          )\n          if (scale < 0.05) scale = 0.05\n          if (scale > 10) scale = 10\n\n          const newMat = getDefaultMat()\n            .translate(zoomStart.x, zoomStart.y)\n            .scaleU(scale)\n\n          changeMat(newMat.clone())\n        }\n\n        changeZoomStart(null)\n        changeZoomEnd(null)\n      }\n      if (\n        e.button === 1 ||\n        e.button === 2 ||\n        (e.button === 0 && dragWithPrimary)\n      )\n        return changeDragging(false)\n      if (e.button === 0) {\n        const { iw, ih } = layoutParams.current\n        onMouseUp({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onWheel: (e) => {\n      const direction = e.deltaY > 0 ? 1 : e.deltaY < 0 ? -1 : 0\n      zoomIn(direction, mousePosition.current)\n    },\n    onContextMenu: (e) => {\n      e.preventDefault()\n    },\n  }\n  return { mouseEvents, mousePosition }\n}\n","import useEventCallback from \"use-event-callback\"\nimport { getEnclosingBox } from \"./regionTools.js\"\n\nexport default ({ layoutParams, mat }) => {\n  return useEventCallback((r) => {\n    const { iw, ih } = layoutParams.current\n    const bbox = getEnclosingBox(r)\n    const margin = r.type === \"point\" ? 15 : 2\n    const cbox = {\n      x: bbox.x * iw - margin,\n      y: bbox.y * ih - margin,\n      w: bbox.w * iw + margin * 2,\n      h: bbox.h * ih + margin * 2,\n    }\n    const pbox = {\n      ...mat.clone().inverse().applyToPoint(cbox.x, cbox.y),\n      w: cbox.w / mat.a,\n      h: cbox.h / mat.d,\n    }\n    return pbox\n  })\n}\n","\nexport type BaseRegion = {\n  id: string | number,\n  cls?: string,\n  locked?: boolean,\n  visible?: boolean,\n  color: string,\n  editingLabels?: boolean,\n  highlighted?: boolean,\n  tags?: Array<string>,\n}\n\nexport type Point = {|\n  ...$Exact<BaseRegion>,\n  type: \"point\",\n  x: number,\n  y: number,\n|}\n\nexport type Rectangle = {|\n  ...$Exact<BaseRegion>,\n  type: \"rectangle\",\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n|}\n\nexport type Polygon = {|\n  ...$Exact<BaseRegion>,\n  type: \"polygon\",\n  open?: boolean,\n  points: Array<[number, number]>,\n|}\n\nexport type Polygon1 = {|\n...$Exact<BaseRegion>,\n    type:\n\"polygon1\",\n    points:Array<[number, number]>,\n    holes: Array<[number, number]>,\n    open?: boolean,\n    creatingHole?:  boolean,\n|}\nexport type Circle = {|\n...$Exact<BaseRegion>,\n    type: \"circle\",\n    // x and y indicate the coordinates of the centre of the circle\n    x: number,\n    y: number,\n    // x and y radius (technically, Circles are capable of representing Ovals)\n    xr: number,\n    xr: number\n|}\nexport type Region =\n  | Point\n  | Rectangle\n  | Polygon\n  | Polygon1\n  |Circle\n\nexport const getEnclosingBox = (region: Region) => {\n  switch (region.type) {\n    case \"polygon\": {\n      const rectangle = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0,\n      }\n      rectangle.w = Math.max(...region.points.map(([x, y]) => x)) - rectangle.x\n      rectangle.h = Math.max(...region.points.map(([x, y]) => y)) - rectangle.y\n      return rectangle\n    }\n    case \"polygon1\": {\n      const rectangle = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0,\n      }\n      rectangle.w = Math.max(...region.points.map(([x, y]) => x)) - rectangle.x\n      rectangle.h = Math.max(...region.points.map(([x, y]) => y)) - rectangle.y\n      return rectangle\n    }\n    case \"circle\": {\n      return {\n        x: region.x - region.xr,\n        y: region.y - region.yr,\n        w: region.xr * 2,\n        h: region.yr * 2\n      }\n    }\n    case \"rectangle\": {\n      return { x: region.x, y: region.y, w: region.w, h: region.h }\n    }\n    case \"point\": {\n      return { x: region.x, y: region.y, w: 0, h: 0 }\n    }\n    default: {\n      return { x: 0, y: 0, w: 0, h: 0 }\n    }\n  }\n  throw new Error(\"unknown region\")\n}\n\nexport const moveRegion = (region: Region, x: number, y: number) => {\n  switch (region.type) {\n    case \"point\": {\n      return { ...region, x, y }\n    }\n    case \"rectangle\": {\n      return { ...region, x: x - region.w / 2, y: y - region.h / 2 }\n    }\n    case \"circle\": {\n      return {\n        ...region,\n        x,\n        y\n      }\n    }\n  }\n  return region\n}\n","\nimport { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  regionInfo: {\n    fontSize: 12,\n    cursor: \"default\",\n    transition: \"opacity 200ms\",\n    opacity: 0.5,\n    \"&:hover\": {\n      opacity: 0.9,\n      cursor: \"pointer\",\n    },\n    \"&.highlighted\": {\n      opacity: 0.9,\n      \"&:hover\": {\n        opacity: 1,\n      },\n    },\n    fontWeight: 600,\n    color: grey[900],\n    padding: 8,\n    \"& .name\": {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      \"& .circle\": {\n        marginRight: 4,\n        boxShadow: \"0px 0px 2px rgba(0,0,0,0.4)\",\n        width: 10,\n        height: 10,\n        borderRadius: 5,\n      },\n    },\n    \"& .tags\": {\n      \"& .tag\": {\n        color: grey[700],\n        display: \"inline-block\",\n        margin: 1,\n        fontSize: 10,\n        textDecoration: \"underline\",\n      },\n    },\n  },\n  commentBox: {\n    fontWeight: 400,\n    fontSize: 13,\n  },\n}\n","\nimport React, { useRef, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles_RegionLabel\"\nimport classnames from \"classnames\"\nimport type { Region } from \"../ImageCanvas/regionTools.js\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Button from \"@material-ui/core/Button\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport CheckIcon from \"@material-ui/icons/Check\"\nimport TextField from \"@material-ui/core/TextField\"\nimport Select from \"react-select\"\nimport { asMutable } from \"seamless-immutable\"\n// get style from style.js\nconst myStyle = makeStyles(styles)\n\ntype Props = {\n  region: Region,\n  editing?: boolean,\n  allowedTags?: Array<string>,\n  cls?: string,\n  tags?: Array<string>,\n  onDelete: (Region) => null,\n  onChange: (Region) => null,\n  onClose: (Region) => null,\n  onOpen: (Region) => null,\n  allowComments?: boolean,\n}\n\nexport const RegionLabel = ({\n  region,\n  editing,\n  allowedTags,\n  onDelete,\n  onChange,\n  onClose,\n  onOpen,\n                              allowComments,\n}: Props) => {\n  const classes = myStyle()\n  const commentInputRef = useRef(null)\n  const onCommentInputClick = (_) => {\n    // The TextField wraps the <input> tag with two divs\n    const commentInput = commentInputRef.current.children[0].children[0]\n\n    if (commentInput) return commentInput.focus()\n  }\n  return (\n    <Paper\n      onClick={() => (!editing ? onOpen(region) : null)}\n      className={classnames(classes.regionInfo, {\n        highlighted: region.highlighted,\n      })}\n    >\n      {!editing ? (\n        <div>\n          {region.cls && (\n            <div className=\"name\">\n              <div\n                className=\"circle\"\n                style={{ backgroundColor: region.color }}\n              />\n              {region.cls}\n            </div>\n          )}\n          {region.tags && (\n            <div className=\"tags\">\n              {region.tags.map((t) => (\n                <div key={t} className=\"tag\">\n                  {t}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ width: 200 }}>\n          <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                backgroundColor: region.color || \"#888\",\n                color: \"#fff\",\n                padding: 4,\n                paddingLeft: 8,\n                paddingRight: 8,\n                borderRadius: 4,\n                fontWeight: \"bold\",\n                textShadow: \"0px 0px 5px rgba(0,0,0,0.4)\",\n              }}\n            >\n              {region.type}\n            </div>\n            <div style={{ flexGrow: 1 }} />\n            <IconButton\n              onClick={() => onDelete(region)}\n              tabIndex={-1}\n              style={{ width: 22, height: 22 }}\n              size=\"small\"\n              variant=\"outlined\"\n            >\n              <TrashIcon style={{ marginTop: -8, width: 16, height: 16 }} />\n            </IconButton>\n          </div>\n          {(allowedTags || []).length > 0 && (\n            <div style={{ marginTop: 4 }}>\n              <Select\n                onChange={(newTags) =>\n                  onChange({\n                    ...(region: any),\n                    tags: newTags.map((t) => t.value),\n                  })\n                }\n                placeholder=\"Tags\"\n                value={(region.tags || []).map((c) => ({ label: c, value: c }))}\n                isMulti\n                options={asMutable(\n                  allowedTags.map((c) => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          {allowComments && (\n              <TextField\n                  InputProps={{\n                    className: classes.commentBox,\n                  }}\n                  fullWidth\n                  multiline\n                  rows={3}\n                  ref={commentInputRef}\n                  onClick={onCommentInputClick}\n                  value={region.comment || \"\"}\n                  onChange={(event) =>\n                      onChange({ ...(region: any), comment: event.target.value })\n                  }\n              />\n          )}\n          {onClose && (\n            <div style={{ marginTop: 4, display: \"flex\" }}>\n              <div style={{ flexGrow: 1 }} />\n              <Button\n                onClick={() => onClose(region)}\n                size=\"small\"\n                variant=\"contained\"\n                color=\"primary\"\n              >\n                <CheckIcon />\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </Paper>\n  )\n}\n\nexport default memo(\n  RegionLabel,\n  (prevProps, nextProps) =>\n    prevProps.editing === nextProps.editing &&\n    prevProps.region === nextProps.region\n)\n","\nimport React from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport DefaultRegionLabel from \"../RegionLabel/main_RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\n\nconst copyWithout = (obj, ...args) => {\n  const newObj = { ...obj }\n  for (const arg of args) {\n    delete newObj[arg]\n  }\n  return newObj\n}\n\nexport const RegionTags = ({\n  regions,\n  projectRegionBox,\n  mouseEvents,\n  regionTagList,\n  onBeginRegionEdit,\n  onChangeRegion,\n  onCloseRegionEdit,\n  onDeleteRegion,\n  layoutParams,\n  imageSrc,\n  RegionEditLabel,\n  onRegionClassAdded,\n                               allowComments,\n}) => {\n  const RegionLabel =\n    RegionEditLabel != null ? RegionEditLabel : DefaultRegionLabel\n  return regions\n    .filter((r) => r.visible || r.visible === undefined)\n    .map((region) => {\n      const pbox = projectRegionBox(region)\n      const { iw, ih } = layoutParams.current\n      let margin = 8\n      if (region.highlighted && region.type === \"rectangle\") margin += 6\n      const labelBoxHeight =\n        region.editingLabels && !region.locked ? 170 : region.tags ? 60 : 50\n      const displayOnTop = pbox.y > labelBoxHeight\n\n      const coords = displayOnTop\n        ? {\n            left: pbox.x,\n            top: pbox.y - margin / 2,\n          }\n        : { left: pbox.x, top: pbox.y + pbox.h + margin / 2 }\n      if (region.locked) {\n        return (\n          <div\n            key={region.id}\n            style={{\n              position: \"absolute\",\n              ...coords,\n              zIndex: 10 + (region.editingLabels ? 5 : 0),\n            }}\n          >\n            <Paper\n              style={{\n                position: \"absolute\",\n                left: 0,\n                ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n                zIndex: 10,\n                backgroundColor: \"#fff\",\n                borderRadius: 4,\n                padding: 2,\n                paddingBottom: 0,\n                opacity: 0.5,\n                pointerEvents: \"none\",\n              }}\n            >\n              <LockIcon style={{ width: 16, height: 16, color: \"#333\" }} />\n            </Paper>\n          </div>\n        )\n      }\n      return (\n        <div\n          key={region.id}\n          style={{\n            position: \"absolute\",\n            ...coords,\n            zIndex: 10 + (region.editingLabels ? 5 : 0),\n            width: 200,\n          }}\n          onMouseDown={(e) => e.preventDefault()}\n          onMouseUp={(e) => e.preventDefault()}\n          onMouseEnter={(e) => {\n            if (region.editingLabels) {\n              mouseEvents.onMouseUp(e)\n              e.button = 1\n              mouseEvents.onMouseUp(e)\n            }\n          }}\n        >\n          <div\n            style={{\n              position: \"absolute\",\n              zIndex: 20,\n              left: 0,\n              ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n            }}\n            {...(!region.editingLabels\n              ? copyWithout(mouseEvents, \"onMouseDown\", \"onMouseUp\")\n              : {})}\n          >\n            <RegionLabel\n              allowedTags={regionTagList}\n              onOpen={onBeginRegionEdit}\n              onChange={onChangeRegion}\n              onClose={onCloseRegionEdit}\n              onDelete={onDeleteRegion}\n              editing={region.editingLabels}\n              region={region}\n              regions={regions}\n              imageSrc={imageSrc}\n              onRegionClassAdded={onRegionClassAdded}\n              allowComments={allowComments}\n            />\n          </div>\n        </div>\n      )\n    })\n}\n\nexport default RegionTags\n","import React, { Fragment, memo } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst TransformMyStyles = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\",\n})\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"],\n]\n\nconst arePropsEqual = (prev, next) => {\n  return (\n    prev.region === next.region &&\n    prev.dragWithPrimary === next.dragWithPrimary &&\n    prev.createWithPrimary === next.createWithPrimary &&\n    prev.zoomWithPrimary === next.zoomWithPrimary &&\n    prev.mat === next.mat\n  )\n}\n\nexport const RegionSelectAndTransformBox = memo(\n  ({\n    region: r,\n    mouseEvents,\n    projectRegionBox,\n    dragWithPrimary,\n    createWithPrimary,\n    zoomWithPrimary,\n    onBeginMovePoint,\n    onSelectRegion,\n    layoutParams,\n    mat,\n    onBeginBoxTransform,\n    onBeginMovePolygonPoint,\n       onBeginMovePolygon1Point,\n    onBeginMoveKeypoint,\n    onAddPolygonPoint,\n       onAddPolygon1Point,\n       onBeginCircleTransform\n  }) => {\n    const pbox = projectRegionBox(r)\n    const { iw, ih } = layoutParams.current\n    return (\n      <Fragment>\n        <div>\n          {r.type === \"rectangle\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            mat.a < 1.2 &&\n            [\n              [0, 0],\n              [0.5, 0],\n              [1, 0],\n              [1, 0.5],\n              [1, 1],\n              [0.5, 1],\n              [0, 1],\n              [0, 0.5],\n              [0.5, 0.5],\n            ].map(([px, py], i) => (\n              <TransformMyStyles\n                key={i}\n                {...mouseEvents}\n                onMouseDown={(e) => {\n                  if (e.button === 0)\n                    return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                  mouseEvents.onMouseDown(e)\n                }}\n                style={{\n                  left: pbox.x - 4 - 2 + pbox.w * px,\n                  top: pbox.y - 4 - 2 + pbox.h * py,\n                  cursor: boxCursorMap[py * 2][px * 2],\n                  borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined,\n                }}\n              />\n            ))}\n            {\n                r.type === \"circle\" &&\n                !dragWithPrimary &&\n                !zoomWithPrimary &&\n                !r.locked &&\n                r.highlighted &&\n                [\n                    [r.x, r.y],\n                    [(r.x*iw + Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/iw, r.y],\n                    [r.x, (r.y*ih + Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/ih],\n                    [(r.x*iw - Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/iw, r.y],\n                    [r.x, (r.y*ih - Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/ih]\n                ].map(([px, py], i) => {\n                    const proj = mat\n                        .clone()\n                        .inverse()\n                        .applyToPoint(px * iw, py * ih)\n                    return(\n                        <div\n                            key={i}\n                            // className={classes.transformGrabber}\n                            {...mouseEvents}\n                            onMouseDown={e => {\n                                if (e.button === 0 && i==0){\n                                    return onBeginCircleTransform(r, \"MOVE_REGION\")\n                                }else if(e.button === 0 && i!=0){\n                                    return onBeginCircleTransform(r, \"RESIZE_CIRCLE\")\n                                }\n                                mouseEvents.onMouseDown(e)\n                            }}\n                            style={{\n                                left: proj.x - 4,\n                                top: proj.y - 4,\n                                borderRadius: px === r.x && py === r.y ? 4 : undefined\n                            }}\n                        />\n                    )\n                })\n            }\n          {r.type === \"polygon\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n              const proj = mat\n                .clone()\n                .inverse()\n                .applyToPoint(px * iw, py * ih)\n              return (\n                <TransformMyStyles\n                  key={i}\n                  {...mouseEvents}\n                  onMouseDown={(e) => {\n                    if (e.button === 0 && (!r.open || i === 0))\n                      return onBeginMovePolygonPoint(r, i)\n                    mouseEvents.onMouseDown(e)\n                  }}\n                  style={{\n                    cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                    zIndex: 10,\n                    pointerEvents:\n                      r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                    left: proj.x - 4,\n                    top: proj.y - 4,\n                  }}\n                />\n              )\n            })}\n            {r.type === \"polygon1\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n                const proj = mat\n                    .clone()\n                    .inverse()\n                    .applyToPoint(px * iw, py * ih)\n                return (\n                    <TransformMyStyles\n                        key={i}\n                        {...mouseEvents}\n                        onMouseDown={(e) => {\n                            if (e.button === 0 && (!r.open || i === 0))\n                                return onBeginMovePolygon1Point(r, i)\n                            mouseEvents.onMouseDown(e)\n                        }}\n                        style={{\n                            cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                            zIndex: 10,\n                            pointerEvents:\n                                r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                            left: proj.x - 4,\n                            top: proj.y - 4,\n                        }}\n                    />\n                )\n            })}\n          {r.type === \"polygon\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n              .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n              .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n              .map((pa, i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(pa[0] * iw, pa[1] * ih)\n                return (\n                  <TransformMyStyles\n                    key={i}\n                    {...mouseEvents}\n                    onMouseDown={(e) => {\n                      if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      cursor: \"copy\",\n                      zIndex: 10,\n                      left: proj.x - 4,\n                      top: proj.y - 4,\n                      border: \"2px dotted #fff\",\n                      opacity: 0.5,\n                    }}\n                  />\n                )\n              })}\n            {r.type === \"polygon1\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n                .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n                .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n                .map((pa, i) => {\n                    const proj = mat\n                        .clone()\n                        .inverse()\n                        .applyToPoint(pa[0] * iw, pa[1] * ih)\n                    return (\n                        <TransformMyStyles\n                            key={i}\n                            {...mouseEvents}\n                            onMouseDown={(e) => {\n                                if (e.button === 0) return onAddPolygon1Point(r, pa, i + 1)\n                                mouseEvents.onMouseDown(e)\n                            }}\n                            style={{\n                                cursor: \"copy\",\n                                zIndex: 10,\n                                left: proj.x - 4,\n                                top: proj.y - 4,\n                                border: \"2px dotted #fff\",\n                                opacity: 0.5,\n                            }}\n                        />\n                    )\n                })}\n        </div>\n      </Fragment>\n    )\n  },\n  arePropsEqual\n)\n\nexport const RegionSelectAndTransformBoxes = memo(\n  (props) => {\n    return props.regions\n      .filter((r) => r.visible || r.visible === undefined)\n      .filter((r) => !r.locked)\n      .map((r, i) => {\n        return <RegionSelectAndTransformBox key={r.id} {...props} region={r} />\n      })\n  },\n  (n, p) => n.regions === p.regions && n.mat === p.mat\n)\n\nexport default RegionSelectAndTransformBoxes\n","\nimport React, { useRef, useEffect, useMemo, useState } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\n\nconst StyledImage = styled(\"img\")({\n  zIndex: 0,\n  position: \"absolute\",\n})\n\nconst Error = styled(\"div\")({\n  zIndex: 0,\n  position: \"absolute\",\n  left: 0,\n  right: 0,\n  bottom: 0,\n  top: 0,\n  backgroundColor: \"rgba(255,0,0,0.2)\",\n  color: \"#ff0000\",\n  fontWeight: \"bold\",\n  whiteSpace: \"pre-wrap\",\n  padding: 50,\n})\n\nexport default ({\n  imagePosition,\n  mouseEvents,\n  imageSrc,\n  onLoad,\n  useCrossOrigin = false,\n}) => {\n  // const settings = useSettings()\n  const imageRef = useRef()\n  const [error, setError] = useState()\n\n  const onImageLoaded = useEventCallback((event) => {\n    const imageElm = event.currentTarget\n    if (onLoad)\n      onLoad({\n        naturalWidth: imageElm.naturalWidth,\n        naturalHeight: imageElm.naturalHeight,\n        imageElm,\n      })\n  })\n  const onImageError = useEventCallback((event) => {\n    setError(\n      `Could not load image\\n\\nMake sure your image works by visiting ${\n        imageSrc \n      } in a web browser. If that URL works, the server hosting the URL may be not allowing you to access the image from your current domain. Adjust server settings to enable the image to be viewed.${\n        !useCrossOrigin\n          ? \"\"\n          : `\\n\\nYour image may be blocked because it's not being sent with CORs headers. To do pixel segmentation, browser web security requires CORs headers in order for the algorithm to read the pixel data from the image. CORs headers are easy to add if you're using an S3 bucket or own the server hosting your images.`\n      }\\n\\n If you need a hand, reach out to the community at universaldatatool.slack.com`\n    )\n  })\n\n  const stylePosition = useMemo(() => {\n    let width = imagePosition.bottomRight.x - imagePosition.topLeft.x\n    let height = imagePosition.bottomRight.y - imagePosition.topLeft.y\n    return {\n      imageRendering: \"pixelated\",\n      left: imagePosition.topLeft.x,\n      top: imagePosition.topLeft.y,\n      width: isNaN(width) ? 0 : width,\n      height: isNaN(height) ? 0 : height,\n    }\n  }, [\n    imagePosition.topLeft.x,\n    imagePosition.topLeft.y,\n    imagePosition.bottomRight.x,\n    imagePosition.bottomRight.y,\n  ])\n\n  if (!imageSrc)\n    return <Error>No imageSrc or videoSrc provided</Error>\n\n  if (error) return <Error>{error}</Error>\n\n  return  (\n    <StyledImage\n      {...mouseEvents}\n      src={imageSrc}\n      ref={imageRef}\n      style={stylePosition}\n      onLoad={onImageLoaded}\n      onError={onImageError}\n      crossOrigin={useCrossOrigin ? \"anonymous\" : undefined}\n    />\n  )\n}\n","import React, { useMemo } from \"react\"\nimport { HotKeys } from \"react-hotkeys\"\n\nexport const defaultHotkeys = [\n  {\n    id: \"zoom_tool\",\n    description: \"Select the Zoom Tool\",\n  },\n  {\n    id: \"create_point\",\n    description: \"Create a point\",\n  },\n  {\n    id: \"create_rectangle\",\n    description: \"Create a rectangle\",\n  },\n  {\n    id: \"pan_tool\",\n    description: \"Select the Pan Tool\",\n  },\n  {\n    id: \"create_polygon\",\n    description: \"Create a Polygon\",\n  },\n  {\n    id: \"create_polygon1\",\n    description: \"Create a Polygon with Holes\",\n  },\n  {\n    id: \"create_circle\",\n    description: \"Create a Ellipse\",\n  },\n  {\n    id: \"save_and_previous_sample\",\n    description: \"Save and go to previous sample\",\n  },\n  {\n    id: \"save_and_next_sample\",\n    description: \"Save and go to next sample\",\n  },\n  {\n    id: \"save_and_exit_sample\",\n    description: \"Save and exit current sample\",\n  },\n  {\n    id: \"exit_sample\",\n    description: \"Exit sample without saving\",\n  },\n  {\n    id: \"delete_region\",\n    description: \"Delete selected region\",\n  },\n  {\n    id: \"undo\",\n    description: \"Undo latest change\",\n  },\n]\nexport const defaultKeyMap = {}\nfor (const { id, binding } of defaultHotkeys) defaultKeyMap[id] = binding\n\nexport const useDispatchHotkeyHandlers = ({ dispatch }) => {\n  const handlers = useMemo(\n    () => ({\n\n      zoom_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"zoom\",\n        })\n      },\n      create_point: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-point\",\n        })\n      },\n      create_rectangle: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-rectangle\",\n        })\n      },\n      pan_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"pan\",\n        })\n      },\n      create_polygon: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-polygon\",\n        })\n      },\n      create_polygon1: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-polygon1\",\n        })\n      },\n      create_circle: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-circle\",\n        })\n      },\n\n      save_and_previous_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Prev\",\n        })\n      },\n      save_and_next_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Next\",\n        })\n      },\n      save_and_exit_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Save\",\n        })\n      },\n      delete_region: () => {\n        dispatch({\n          type: \"DELETE_SELECTED_REGION\",\n        })\n      },\n      undo: () => {\n        dispatch({\n          type: \"RESTORE_HISTORY\",\n        })\n      },\n    }),\n    [dispatch]\n  )\n  return handlers\n}\n\nexport default ({ children, dispatch }) => {\n  const handlers = useDispatchHotkeyHandlers({ dispatch })\n  return (\n    <HotKeys allowChanges handlers={handlers}>\n      {children}\n    </HotKeys>\n  )\n}\n","\nimport React, { memo } from \"react\"\nimport colorAlpha from \"color-alpha\"\n\nfunction clamp(num, min, max) {\n  return num <= min ? min : num >= max ? max : num\n}\n\nconst RegionComponents = {\n  point: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n      <path\n        d={\"M0 8L8 0L0 -8L-8 0Z\"}\n        strokeWidth={2}\n        stroke={region.color}\n        fill=\"transparent\"\n      />\n    </g>\n  )),\n    rectangle: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n      <rect\n        strokeWidth={2}\n        x={0}\n        y={0}\n        width={Math.max(region.w * iw, 0)}\n        height={Math.max(region.h * ih, 0)}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}\n      />\n    </g>\n  )),\n    circle: memo(({ region, iw, ih }) => (\n        <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n            <ellipse\n                strokeWidth={2}\n                rx={Math.max(region.xr*iw,0)}\n                ry={Math.max(region.yr*ih,0)}\n                cx={region.x}\n                cy={region.y}\n                stroke={colorAlpha(region.color, 0.75)}\n                fill={colorAlpha(region.color, 0.25)}\n            />\n        </g>\n    )),\n  polygon1: memo(({ region, iw, ih, fullSegmentationMode }) => {\n    const Component = region.open? \"polyline\" : \"polygon\"\n\n      // const Hole=region.creatingHole ? \"polyline\" : \"polygon\"\n    return (\n      <Component\n          // paths={[region.points,region.holes]}\n        points={region.points\n          .map(([x, y]) => [x * iw, y * ih])\n          .map((a) => a.join(\" \"))\n          .join(\" \")}\n        // holes={region.holes\n        //     .map(([x, y]) => [x * iw, y * ih])\n        //     .map((a) => a.join(\" \"))\n        //     .join(\" \")}\n        strokeWidth={2}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}>\n\n         </Component>\n\n\n    )\n  }),\n    polygon: memo(({ region, iw, ih, fullSegmentationMode }) => {\n        const Component = region.open ? \"polyline\" : \"polygon\"\n        return (\n            <Component\n                points={region.points\n                    .map(([x, y]) => [x * iw, y * ih])\n                    .map((a) => a.join(\" \"))\n                    .join(\" \")}\n                strokeWidth={2}\n                stroke={colorAlpha(region.color, 0.75)}\n                fill={colorAlpha(region.color, 0.25)}\n            />\n        )\n    }),\n  pixel: () => null,\n}\n\n\nexport const WrappedRegionList = memo(\n  ({ regions, keypointDefinitions, iw, ih, fullSegmentationMode }) => {\n    return regions\n      .filter((r) => r.visible !== false)\n      .map((r) => {\n        const Component = RegionComponents[r.type]\n        return (\n          <Component\n            key={r.regionId}\n            region={r}\n            iw={iw}\n            ih={ih}\n          />\n        )\n      })\n  },\n  (n, p) => n.regions === p.regions && n.iw === p.iw && n.ih === p.ih\n)\n\nexport const RegionShapes = ({\n  mat,\n  imagePosition,\n  regions = [],\n}) => {\n  const iw = imagePosition.bottomRight.x - imagePosition.topLeft.x\n  const ih = imagePosition.bottomRight.y - imagePosition.topLeft.y\n  if (isNaN(iw) || isNaN(ih)) return null\n  return (\n    <svg\n      width={iw}\n      height={ih}\n      style={{\n        position: \"absolute\",\n        zIndex: 2,\n        left: imagePosition.topLeft.x,\n        top: imagePosition.topLeft.y,\n        pointerEvents: \"none\",\n        width: iw,\n        height: ih,\n      }}\n    >\n      <WrappedRegionList\n        key=\"wrapped-region-list\"\n        regions={regions}\n        iw={iw}\n        ih={ih}\n      />\n    </svg>\n  )\n}\n\nexport default RegionShapes\n","import React, {\n  useRef,\n  useState,\n  useLayoutEffect,\n  useEffect,\n  useMemo,\n} from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\nimport type {\n  Region,\n  Point,\n  Polygon,\n  Polygon1,\n  Rectangle,\n  Circle\n} from \"./regionTools.js\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles_ImageCanvas\"\nimport useMouse from \"./useMouse\"\nimport useProjectRegionBox from \"./useProjectBox\"\nimport { useRafState } from \"react-use\"\nimport RegionTags from \"../RegionTags/main_RegionTags\"\nimport RegionSelectAndTransformBoxes from \"../TransformBoxes/main_TransformBoxes\"\nimport ImageCanvasBackground from \"./background\"\nimport useEventCallback from \"use-event-callback\"\nimport RegionShapes from \"../RegionShapes/main_RegionShapes\"\n\n// get style from style.js\nconst myStyle = makeStyles(styles)\n\ntype Props = {\n  regions: Array<Region>,\n  imageSrc?: string,\n  onMouseMove?: ({ x: number, y: number }) => any,\n  onMouseDown?: ({ x: number, y: number }) => any,\n  onMouseUp?: ({ x: number, y: number }) => any,\n  dragWithPrimary?: boolean,\n  zoomWithPrimary?: boolean,\n  createWithPrimary?: boolean,\n  realSize?: { width: number, height: number, unitName: string },\n  regionTagList?: Array<string>,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  allowComments?: Boolean,\n  onChangeRegion: (Region) => any,\n  onBeginRegionEdit: (Region) => any,\n  onCloseRegionEdit: (Region) => any,\n  onDeleteRegion: (Region) => any,\n  onBeginBoxTransform: (Rectangle, [number, number]) => any,\n  onBeginMovePolygonPoint: (Polygon, index: number) => any,\n  onAddPolygonPoint: (Polygon, point: [number, number], index: number) => any,\n  onBeginMovePolygon1Point: (Polygon1, index1: number) => any,\n  onAddPolygon1Point: (Polygon1, Polygon1Index:number, point1: [number, number], index1: number) => any,\n  onBeginCircleTransform: (Circle, directions: string) => any,\n  onSelectRegion: (Region) => any,\n  onBeginMovePoint: (Point) => any,\n  onLoaded: ({\n    naturalWidth: number,\n    naturalHeight: number,\n  }) => any,\n  onRegionClassAdded: () => {},\n}\nconst getCanvasDimension = (allowedArea = null, { iw, ih } = {}) => {\n  let dimension = Matrix.from(1, 0, 0, 1, -10, -10)\n  if (allowedArea && iw) {\n    dimension = dimension\n      .translate(allowedArea.x * iw, allowedArea.y * ih)\n      .scaleU(allowedArea.w + 0.05)\n  }\n  return dimension\n}\n\nexport const ImageCanvas = ({\n  regions,\n  imageSrc,\n  onMouseMove = (p) => null,\n  onMouseDown = (p) => null,\n  onMouseUp = (p) => null,\n  dragWithPrimary = false,\n  zoomWithPrimary = false,\n  createWithPrimary = false,\n  regionTagList,\n  allowedArea,\n  onLoaded,\n  onChangeRegion,\n  onBeginRegionEdit,\n  onCloseRegionEdit,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint,\n  onBeginMovePolygon1Point,\n  onAddPolygon1Point,\n  onBeginMoveKeypoint,\n  onSelectRegion,\n  onBeginMovePoint,\n  onDeleteRegion,\n  onRegionClassAdded,\n  zoomOnAllowedArea = true,\n  allowComments,\nnBeginCircleTransform,\n}: Props) => {\n  const classes = myStyle()\n\n  const canvasEl = useRef(null)\n  const layoutParams = useRef({})\n  const [dragging, changeDragging] = useRafState(false)\n  const [zoomStart, changeZoomStart] = useRafState(null)\n  const [zoomEnd, changeZoomEnd] = useRafState(null)\n  const [mat, changeMat] = useRafState(getCanvasDimension())\n\n  const { mouseEvents, mousePosition } = useMouse({\n    canvasEl,\n    dragging,\n    mat,\n    layoutParams,\n    changeMat,\n    zoomStart,\n    zoomEnd,\n    changeZoomStart,\n    changeZoomEnd,\n    changeDragging,\n    zoomWithPrimary,\n    dragWithPrimary,\n    onMouseMove,\n    onMouseDown,\n    onMouseUp,\n  })\n\n\n\n  const projectRegionBox = useProjectRegionBox({ layoutParams, mat })\n\n  const [imageDimensions, changeImageDimensions] = useState()\n  const imageLoaded = Boolean(imageDimensions && imageDimensions.naturalWidth)\n\n  const ImageLoaded = useEventCallback(\n    ({ naturalWidth, naturalHeight}) => {\n      const dims = { naturalWidth, naturalHeight}\n      if (onLoaded) onLoaded(dims)\n      changeImageDimensions(dims)\n\n    }\n  )\n  const canvas = canvasEl.current\n  if (canvas && imageLoaded) {\n    const { clientWidth, clientHeight } = canvas\n\n    const fitScale = Math.max(\n      imageDimensions.naturalWidth / (clientWidth - 20),\n      imageDimensions.naturalHeight / (clientHeight - 20)\n    )\n\n    const [iw, ih] = [\n      imageDimensions.naturalWidth / fitScale,\n      imageDimensions.naturalHeight / fitScale,\n    ]\n\n    layoutParams.current = {\n      iw,\n      ih,\n      fitScale,\n      canvasWidth: clientWidth,\n      canvasHeight: clientHeight,\n    }\n  }\n\n  useEffect(() => {\n    if (!imageLoaded) return\n    changeMat(\n        getCanvasDimension(\n        zoomOnAllowedArea ? allowedArea : null,\n        layoutParams.current\n      )\n    )\n  }, [imageLoaded])\n\n  useLayoutEffect(() => {\n    if (!imageDimensions) return\n    const { clientWidth, clientHeight } = canvas\n    canvas.width = clientWidth\n    canvas.height = clientHeight\n    const context = canvas.getContext(\"2d\")\n\n    context.save()\n    context.transform(...mat.clone().inverse().toArray())\n\n    const { iw, ih } = layoutParams.current\n\n    if (allowedArea) {\n      // Pattern to indicate the NOT allowed areas\n      const { x, y, w, h } = allowedArea\n      context.save()\n      context.globalAlpha = 1\n      const outer = [\n        [0, 0],\n        [iw, 0],\n        [iw, ih],\n        [0, ih],\n      ]\n      const inner = [\n        [x * iw, y * ih],\n        [x * iw + w * iw, y * ih],\n        [x * iw + w * iw, y * ih + h * ih],\n        [x * iw, y * ih + h * ih],\n      ]\n      context.moveTo(...outer[0])\n      outer.forEach((p) => context.lineTo(...p))\n      context.lineTo(...outer[0])\n      context.closePath()\n\n      inner.reverse()\n      context.moveTo(...inner[0])\n      inner.forEach((p) => context.lineTo(...p))\n      context.lineTo(...inner[0])\n\n      context.fill()\n\n      context.restore()\n    }\n\n    context.restore()\n  })\n\n  const { iw, ih } = layoutParams.current\n\n  let zoomBox =\n    !zoomStart || !zoomEnd\n      ? null\n      : {\n          ...mat.clone().inverse().applyToPoint(zoomStart.x, zoomStart.y),\n          w: (zoomEnd.x - zoomStart.x) / mat.a,\n          h: (zoomEnd.y - zoomStart.y) / mat.d,\n        }\n  if (zoomBox) {\n    if (zoomBox.w < 0) {\n      zoomBox.x += zoomBox.w\n      zoomBox.w *= -1\n    }\n    if (zoomBox.h < 0) {\n      zoomBox.y += zoomBox.h\n      zoomBox.h *= -1\n    }\n  }\n\n  const imagePosition = {\n    topLeft: mat.clone().inverse().applyToPoint(0, 0),\n    bottomRight: mat.clone().inverse().applyToPoint(iw, ih),\n  }\n\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"calc(100vh - 68px)\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: createWithPrimary\n          ? \"crosshair\"\n          : dragging\n          ? \"grabbing\"\n          : dragWithPrimary\n          ? \"grab\"\n          : zoomWithPrimary\n          ? mat.a < 1\n            ? \"zoom-out\"\n            : \"zoom-in\"\n          : undefined,\n      }}\n    >\n      {imageLoaded && !dragging && (\n        <RegionSelectAndTransformBoxes\n          key=\"regionSelectAndTransformBoxes\"\n          regions={\n             !allowedArea\n              ? regions\n              : [\n                  {\n                    type: \"rectangle\",\n                    id: \"$$allowed_area\",\n                    cls: \"allowed_area\",\n                    highlighted: true,\n                    x: allowedArea.x,\n                    y: allowedArea.y,\n                    w: allowedArea.w,\n                    h: allowedArea.h,\n                    visible: true,\n                    color: \"#ff0\",\n                  },\n                ]\n          }\n          mouseEvents={mouseEvents}\n          projectRegionBox={projectRegionBox}\n          dragWithPrimary={dragWithPrimary}\n          createWithPrimary={createWithPrimary}\n          zoomWithPrimary={zoomWithPrimary}\n          onBeginMovePoint={onBeginMovePoint}\n          onSelectRegion={onSelectRegion}\n          layoutParams={layoutParams}\n          mat={mat}\n          onBeginBoxTransform={onBeginBoxTransform}\n          onBeginMovePolygonPoint={onBeginMovePolygonPoint}\n          onBeginMoveKeypoint={onBeginMoveKeypoint}\n          onAddPolygonPoint={onAddPolygonPoint}\n          onAddPolygon1Point={onAddPolygon1Point}\n          onBeginMovePolygon1Point={onBeginMovePolygon1Point}\n        />\n      )}\n      {imageLoaded  && !dragging && (\n        <div key=\"regionTags\">\n          <RegionTags\n            regions={regions}\n            projectRegionBox={projectRegionBox}\n            mouseEvents={mouseEvents}\n            regionTagList={regionTagList}\n            onBeginRegionEdit={onBeginRegionEdit}\n            onChangeRegion={onChangeRegion}\n            onCloseRegionEdit={onCloseRegionEdit}\n            onDeleteRegion={onDeleteRegion}\n            layoutParams={layoutParams}\n            imageSrc={imageSrc}\n            onRegionClassAdded={onRegionClassAdded}\n            allowComments={allowComments}\n          />\n       </div>\n      )}\n\n      {zoomWithPrimary && zoomBox !== null && (\n        <div\n          key=\"zoomBox\"\n          style={{\n            position: \"absolute\",\n            zIndex: 1,\n            border: \"1px solid #fff\",\n            pointerEvents: \"none\",\n            left: zoomBox.x,\n            top: zoomBox.y,\n            width: zoomBox.w,\n            height: zoomBox.h,\n          }}\n        />\n      )}\n\n      <div\n        style={{ width: \"100%\", height: \"100%\" }}\n        {...mouseEvents}\n      >\n\n        <>\n          <canvas\n            style={{ opacity: 0.25 }}\n            className={classes.canvas}\n            ref={canvasEl}\n          />\n          <RegionShapes\n            imagePosition={imagePosition}\n            regions={regions}\n          />\n          <ImageCanvasBackground\n            imagePosition={imagePosition}\n            mouseEvents={mouseEvents}\n            onLoad={ImageLoaded}\n            imageSrc={imageSrc}\n          />\n        </>\n      </div>\n      <div className={classes.zoomIndicator}>\n        {((1 / mat.a) * 100).toFixed(0)}%\n      </div>\n    </div>\n  )\n}\n\nexport default ImageCanvas\n","\nexport default {\n  canvas: { width: \"100%\", height: \"100%\", position: \"relative\", zIndex: 1 },\n  zoomIndicator: {\n    position: \"absolute\",\n    bottom: 16,\n    right: 0,\n    backgroundColor: \"rgba(0,0,0,0.4)\",\n    color: \"#fff\",\n    opacity: 0.5,\n    fontWeight: \"bolder\",\n    fontSize: 14,\n    padding: 4,\n  },\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    display: \"flex\",\n    flexGrow: 1,\n    flexDirection: \"column\",\n    height: \"100%\",\n    maxHeight: \"100vh\",\n    backgroundColor: \"#fff\",\n    overflow: \"hidden\",\n    \"&.fullscreen\": {\n      position: \"absolute\",\n      zIndex: 99999,\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n    },\n  },\n  headerTitle: {\n    fontWeight: \"bold\",\n    color: grey[700],\n    paddingLeft: 16,\n  },\n}\n","import { getIn } from \"seamless-immutable\"\n\nexport default (state) => {\n  let currentImageIndex = null,\n    pathToActiveImage,\n    activeImage\n  if (state.annotationType === \"image\") {\n    currentImageIndex = state.selectedImage\n    if (currentImageIndex === -1) {\n      currentImageIndex = null\n      activeImage = null\n    } else {\n      pathToActiveImage = [\"images\", currentImageIndex]\n      activeImage = getIn(state, pathToActiveImage)\n    }\n  }\n  return { currentImageIndex, pathToActiveImage, activeImage }\n}\n","// @flow\n\nimport React from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faCrosshairs,\n  faDrawPolygon,\n  faVectorSquare,\n  faHandPaper,\n  faSearch,\n    faMinusSquare,\n} from \"@fortawesome/free-solid-svg-icons\"\nimport { faCircle } from \"@fortawesome/free-regular-svg-icons\"\n\nconst faStyle = { marginTop: 4, width: 16, height: 16, marginBottom: 4 }\n\nexport const iconDictionary = {\n  pan: () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faHandPaper} />\n  ),\n  zoom: () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faSearch} />\n  ),\n  \"create-point\": () => (\n    <FontAwesomeIcon style={faStyle} size=\"xs\" fixedWidth icon={faCrosshairs} />\n  ),\n  \"create-rectangle\": () => (\n    <FontAwesomeIcon\n      style={faStyle}\n      size=\"xs\"\n      fixedWidth\n      icon={faVectorSquare}\n    />\n  ),\n  \"create-polygon\": () => (\n    <FontAwesomeIcon\n      style={faStyle}\n      size=\"xs\"\n      fixedWidth\n      icon={faDrawPolygon}\n    />\n  ),\n  \"create-polygon1\": () => (\n      <FontAwesomeIcon\n          style={faStyle}\n          size=\"xs\"\n          fixedWidth\n          icon={faMinusSquare}\n      />\n  ),\n  \"create-circle\": () => (\n      <FontAwesomeIcon\n          style={faStyle}\n          size=\"xs\"\n          fixedWidth\n          icon={faCircle}\n      />\n  ),\n\n\n}\n\nexport default iconDictionary\n","\nimport React, { useRef, useCallback } from \"react\"\nimport { makeStyles, styled } from \"@material-ui/core/styles\"\nimport ImageCanvas from \"../ImageCanvas/main_ImageCanvas\"\nimport styles from \"./styles_MainLayout\"\nimport type, { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport getActiveImage from \"../reducers/getActiveImage\"\nimport { useDispatchHotkeyHandlers } from \"../ShortcutsManager/main_ShortcutsManager\"\nimport { withHotKeys } from \"react-hotkeys\"\nimport iconDictionary from \"./iconDictionary\"\nimport Workspace from \"react-material-workspace-layout/Workspace\"\nimport useEventCallback from \"use-event-callback\"\n// get style from style.js\n\nconst myStyle = makeStyles(styles)\n\nconst HotkeyDiv = withHotKeys(({ hotKeys, children, divRef, ...props }) => (\n  <div {...{ ...hotKeys, ...props }} ref={divRef}>\n    {children}\n  </div>\n))\n\ntype Props = {\n  state: MainLayoutState,\n  dispatchAction: (Action) => any,\n  onRegionClassAdded: () => {},\n}\n\nexport const MainLayout = ({\n  state,\n  dispatchAction,\n}: Props) => {\n  const classes = myStyle()\n\n  const memoizedActionFns = useRef({})\n  const action = (type: string, ...params: Array<string>) => {\n    const fnKey = `${type}(${params.join(\",\")})`\n    if (memoizedActionFns.current[fnKey])\n      return memoizedActionFns.current[fnKey]\n\n    const fn = (...args: any) =>\n      params.length > 0\n        ? dispatchAction(\n            ({\n              type,\n              ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {}),\n            }: any)\n          )\n        : dispatchAction({ type, ...args[0] })\n    memoizedActionFns.current[fnKey] = fn\n    return fn\n  }\n\n  const { currentImageIndex, activeImage } = getActiveImage(state)\n  let nextImage\n  if (currentImageIndex !== null) {\n    nextImage = state.images[currentImageIndex + 1]\n  }\n\n  useKey(() => dispatchAction({ type: \"CANCEL\" }), {\n    detectKeys: [27],\n  })\n\n  const innerContainerRef = useRef()\n  const hotkeyHandlers = useDispatchHotkeyHandlers({ dispatchAction })\n  const refocusOnMouseEvent = useCallback((e) => {\n    if (!innerContainerRef.current) return\n    if (innerContainerRef.current.contains(document.activeElement)) return\n    if (innerContainerRef.current.contains(e.target)) {\n      innerContainerRef.current.focus()\n      e.target.focus()\n    }\n  }, [])\n\n  const canvas = (\n    <ImageCanvas\n      key={state.selectedImage}\n      showTags={state.showTags}\n      regionTagList={state.regionTagList}\n      regions={\n        activeImage.regions || []\n      }\n      realSize={activeImage ? activeImage.realSize : undefined}\n      imageSrc={state.annotationType === \"image\" ? activeImage.src : null}\n      pointDistancePrecision={state.pointDistancePrecision}\n      createWithPrimary={state.selectedTool.includes(\"create\")}\n      dragWithPrimary={state.selectedTool === \"pan\"}\n      zoomWithPrimary={state.selectedTool === \"zoom\"}\n      onMouseMove={action(\"MOUSE_MOVE\")}\n      onMouseDown={action(\"MOUSE_DOWN\")}\n      onMouseUp={action(\"MOUSE_UP\")}\n      onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n      onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n      onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n      onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n      onBeginBoxTransform={action(\"BEGIN_BOX_TRANSFORM\", \"rectangle\", \"directions\")}\n      onBeginMovePolygonPoint={action(\n        \"BEGIN_MOVE_POLYGON_POINT\",\n        \"polygon\",\n        \"pointIndex\"\n      )}\n      onAddPolygonPoint={action(\n        \"ADD_POLYGON_POINT\",\n        \"polygon\",\n        \"point\",\n        \"pointIndex\"\n      )}\n      onBeginMovePolygon1Point={action(\n          \"BEGIN_MOVE_POLYGON1_POINT\",\n          \"polygon1\",\n          \"point1Index\"\n      )}\n      onAddPolygon1Point={action(\n          \"ADD_POLYGON1_POINT\",\n          \"polygon1\",\n          \"point1\",\n          \"point1Index\"\n      )}\n      onBeginCircleTransform={action(\n          \"BEGIN_CIRCLE_TRANSFORM\",\n          \"circle\",\n          \"directions\"\n      )}\n      onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n      onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n      onImageLoaded={action(\"IMAGE_LOADED\", \"image\")}\n      allowComments={state.allowComments}\n    />\n  )\n\n  const onClickIconSidebarItem = useEventCallback((item) => {\n    dispatchAction({ type: \"SELECT_TOOL\", selectedTool: item.name })\n  })\n\n  const onClickHeaderItem = useEventCallback((item) => {\n    dispatchAction({ type: \"HEADER_BUTTON_CLICKED\", buttonName: item.name })\n  })\n  return (\n        <HotkeyDiv\n          tabIndex={-1}\n          divRef={innerContainerRef}\n          onMouseDown={refocusOnMouseEvent}\n          onMouseOver={refocusOnMouseEvent}\n          allowChanges\n          handlers={hotkeyHandlers}\n          className={classnames(\n            classes.container,\n\n          )}\n        >\n          <Workspace\n            iconDictionary={iconDictionary}\n            headerLeftSide={[\n               activeImage ? (\n                <div className={classes.headerTitle}>{activeImage.name}</div>\n              ) : null,\n            ].filter(Boolean)}\n            headerItems={[\n              { name: \"Prev\" },\n              { name: \"Next\" },\n              { name: \"Save\" },\n            ].filter(Boolean)}\n            onClickHeaderItem={onClickHeaderItem}\n            onClickIconSidebarItem={onClickIconSidebarItem}\n            selectedTools={[\n              state.selectedTool,\n            ].filter(Boolean)}\n            iconSidebarItems={[\n              {\n                name: \"pan\",\n                helperText:\n                  \"Drag/Pan (right or middle click)\",\n                alwaysShowing: true,\n              },\n              {\n                name: \"zoom\",\n                helperText:\n                  \"Zoom In/Out\",\n                alwaysShowing: true,\n              },\n              {\n                name: \"create-point\",\n                helperText: \"Add Point\" ,\n              },\n              {\n                name: \"create-rectangle\",\n                helperText:\n                  \"Add Rectangle\" ,\n              },\n              {\n                name: \"create-polygon\",\n                helperText: \"Add Polygon\",\n              },\n              {\n                name: \"create-polygon1\",\n                helperText: \"Add Polygon with Holes\",\n              },\n              {\n                name: \"create-circle\",\n                helperText: \"Add Ellipse\",\n              },\n\n            ]\n              .filter(Boolean)\n              .filter(\n                (a) => a.alwaysShowing || state.enabledTools.includes(a.name)\n              )}\n\n          >\n            {canvas}\n          </Workspace>\n        </HotkeyDiv>\n  )\n}\n\nexport default MainLayout\n","\nimport type { MainLayoutState, Action } from \"../MainLayout/types\"\nimport { setIn, updateIn, asMutable, without } from \"seamless-immutable\"\nimport moment from \"moment\"\n\nconst typesToSaveWithHistory = {\n  BEGIN_BOX_TRANSFORM: \"Transform/Move Box\",\n  BEGIN_MOVE_POINT: \"Move Point\",\n  DELETE_REGION: \"Delete Region\",\n  BEGIN_CIRCLE_TRANSFORM: \"Transform/Move Circle\",\n}\n\nexport const saveToHistory = (state: MainLayoutState, name: string) =>\n  updateIn(state, [\"history\"], (h) =>\n    [\n      {\n        time: moment().toDate(),\n        state: without(state, \"history\"),\n        name,\n      },\n    ].concat((h || []).slice(0, 9))\n  )\n\nexport default (reducer) => {\n  return (state: MainLayoutState, action: Action) => {\n    const prevState = state\n    const nextState = reducer(state, action)\n\n    if (action.type === \"RESTORE_HISTORY\") {\n      if (state.history.length > 0) {\n        return setIn(\n          nextState.history[0].state,\n          [\"history\"],\n          nextState.history.slice(1)\n        )\n      }\n    } else {\n      if (\n        prevState !== nextState &&\n        Object.keys(typesToSaveWithHistory).includes(action.type)\n      ) {\n        return setIn(\n          nextState,\n          [\"history\"],\n          [\n            {\n              time: moment().toDate(),\n              state: without(prevState, \"history\"),\n              name: typesToSaveWithHistory[action.type] || action.type,\n            },\n          ]\n            .concat(nextState.history || [])\n            .slice(0, 9)\n        )\n      }\n    }\n\n    return nextState\n  }\n}\n","\n\nimport * as muiColors from \"@material-ui/core/colors\"\n\nexport const colors = [\n  muiColors.red[500],\n  muiColors.blue[500],\n  muiColors.green[500],\n  muiColors.orange[800],\n  muiColors.brown[500],\n  muiColors.lightGreen[700],\n  muiColors.pink[500],\n  muiColors.purple[500],\n  muiColors.indigo[500],\n  muiColors.teal[500],\n  muiColors.lime[500],\n  muiColors.blueGrey[500],\n]\n\nconst transparency = 0x88000000\n\nfunction reverseParseColor(rrggbb) {\n  rrggbb = rrggbb.replace(\"#\", \"\")\n  const bbggrr = rrggbb.substr(4, 2) + rrggbb.substr(2, 2) + rrggbb.substr(0, 2)\n  return parseInt(bbggrr, 16)\n}\n\nexport const colorInts: Array<number> = colors.map(\n  (c) => (reverseParseColor(c) | transparency) >>> 0\n)\n\nexport default colors\n","import type { MainLayoutState, Action } from \"../MainLayout/types\"\nimport { moveRegion } from \"../ImageCanvas/regionTools.js\"\nimport { getIn, setIn, updateIn } from \"seamless-immutable\"\nimport isEqual from \"lodash/isEqual\"\nimport getActiveImage from \"./getActiveImage\"\nimport { saveToHistory } from \"./historyHandler.js\"\nimport colors from \"../ImageCanvas/colors\"\n\nconst getRandomId = () => Math.random().toString().split(\".\")[1]\n\nexport default (state: MainLayoutState, action: Action) => {\n  // Throttle certain actions\n  if (action.type === \"MOUSE_MOVE\") {\n    if (Date.now() - ((state: any).lastMouseMoveCall || 0) < 16) return state\n    state = setIn(state, [\"lastMouseMoveCall\"], Date.now())\n  }\n  if (!action.type.includes(\"MOUSE\")) {\n    state = setIn(state, [\"lastAction\"], action)\n  }\n\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  const getRegionIndex = (region) => {\n    const regionId =\n      typeof region === \"string\" || typeof region === \"number\"\n        ? region\n        : region.id\n    if (!activeImage) return null\n    const regionIndex = (activeImage.regions || []).findIndex(\n      (r) => r.id === regionId\n    )\n    return regionIndex === -1 ? null : regionIndex\n  }\n  const getRegion = (regionId) => {\n    if (!activeImage) return null\n    const regionIndex = getRegionIndex(regionId)\n    if (regionIndex === null) return [null, null]\n    const region = activeImage.regions[regionIndex]\n    return [region, regionIndex]\n  }\n  const modifyRegion = (regionId, obj) => {\n    const [region, regionIndex] = getRegion(regionId)\n    if (!region) return state\n    if (obj !== null) {\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...region,\n        ...obj,\n      })\n    } else {\n      // delete region\n      const regions = activeImage.regions\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (regions || []).filter((r) => r.id !== region.id)\n      )\n    }\n  }\n\n  const closeEditors = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map((r) => ({\n        ...r,\n        editingLabels: false,\n      }))\n    )\n  }\n\n  const setNewImage = (img: string | Object, index: number) => {\n    let { src } = typeof img === \"object\" ? img : { src: img }\n    return setIn(\n      setIn(state, [\"selectedImage\"], index),\n      [\"selectedImageFrameTime\"]\n    )\n  }\n\n  switch (action.type) {\n    case \"@@INIT\": {\n      return state\n    }\n    case \"SELECT_IMAGE\": {\n      return setNewImage(action.image, action.imageIndex)\n    }\n    case \"CHANGE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const oldRegion = activeImage.regions[regionIndex]\n      if (oldRegion.cls !== action.region.cls) {\n        state = saveToHistory(state, \"Change Region Classification\")\n        const clsIndex = state.regionClsList.indexOf(action.region.cls)\n        if (clsIndex !== -1) {\n          action.region.color = colors[clsIndex % colors.length]\n        }\n      }\n      if (!isEqual(oldRegion.tags, action.region.tags)) {\n        state = saveToHistory(state, \"Change Region Tags\")\n      }\n      if (!isEqual(oldRegion.comment, action.region.comment)) {\n        state = saveToHistory(state, \"Change Region Comment\")\n      }\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\", regionIndex],\n        action.region\n      )\n    }\n    case \"CHANGE_IMAGE\": {\n      if (!activeImage) return state\n      const { delta } = action\n      for (const key of Object.keys(delta)) {\n        if (key === \"cls\") saveToHistory(state, \"Change Image Class\")\n        if (key === \"tags\") saveToHistory(state, \"Change Image Tags\")\n        state = setIn(state, [...pathToActiveImage, key], delta[key])\n      }\n      return state\n    }\n    case \"SELECT_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const regions = [...(activeImage.regions || [])].map((r) => ({\n        ...r,\n        highlighted: r.id === region.id,\n        editingLabels: r.id === region.id,\n      }))\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"BEGIN_MOVE_POINT\": {\n      state = closeEditors(state)\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_REGION\",\n        regionId: action.point.id,\n      })\n    }\n    case \"BEGIN_BOX_TRANSFORM\": {\n      const { rectangle, directions } = action\n      state = closeEditors(state)\n      if (directions[0] === 0 && directions[1] === 0) {\n        return setIn(state, [\"mode\"], { mode: \"MOVE_REGION\", regionId: rectangle.id })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_BOX\",\n          regionId: rectangle.id,\n          freedom: directions,\n          original: { x: rectangle.x, y: rectangle.y, w: rectangle.w, h: rectangle.h },\n        })\n      }\n    }\n    case \"BEGIN_MOVE_POLYGON_POINT\": {\n      const { polygon, pointIndex } = action\n      state = closeEditors(state)\n      if (\n        state.mode &&\n        state.mode.mode === \"DRAW_POLYGON\" &&\n        pointIndex === 0\n      ) {\n        return setIn(\n          modifyRegion(polygon, {\n            points: polygon.points.slice(0, -1),\n            open: false,\n          }),\n          [\"mode\"],\n          null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon.id,\n        pointIndex,\n      })\n    }\n    case \"ADD_POLYGON_POINT\": {\n      const { polygon, point, pointIndex } = action\n      const regionIndex = getRegionIndex(polygon)\n      if (regionIndex === null) return state\n      const points = [...polygon.points]\n      points.splice(pointIndex, 0, point)\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...polygon,\n        points,\n      })\n    }\n    case \"BEGIN_MOVE_POLYGON1_POINT\": {\n      const { polygon1, point1Index } = action\n      state = closeEditors(state)\n      if (\n          state.mode &&\n          state.mode.mode === \"DRAW_POLYGON1\" &&\n          point1Index === 0\n      ) {\n        return setIn(\n            modifyRegion(polygon1, {\n              points: polygon1.points.slice(0, -1),\n              open: false,\n            }),\n            [\"mode\"],\n            null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon1.id,\n        point1Index,\n      })\n    }\n    case \"ADD_POLYGON1_POINT\": {\n      const { polygon1, point1, point1Index} = action\n      const regionIndex = getRegionIndex(polygon1)\n      if (regionIndex === null) return state\n      const points = [...polygon1.points]\n      const holes = [...polygon1.holes]\n      const open=[...polygon1.open]\n      let creatingHole=[...polygon1.creatingHole]\n\n      points.splice(point1Index, 0, point1)\n      if(!open){\n        creatingHole=true\n        holes.splice(point1Index-points.length, 0, point1);\n      }\n\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...polygon1,\n        points,\n        holes,\n        creatingHole,\n      })\n    }\n    case \"MOUSE_MOVE\": {\n      const { x, y } = action\n\n      if (!state.mode) return state\n      if (!activeImage) return state\n      const { mouseDownAt } = state\n      switch (state.mode.mode) {\n        case \"MOVE_POLYGON_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              pointIndex,\n            ],\n            [x, y]\n          )\n        }\n        case \"MOVE_POLYGON1_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n              state,\n              [\n                ...pathToActiveImage,\n                \"regions\",\n                regionIndex,\n                \"points\",\n                \"holes\",\n                pointIndex,\n              ],\n              [x, y]\n          )\n        }\n        case \"MOVE_REGION\": {\n          const { regionId } = state.mode\n          if (regionId === \"$$allowed_area\") {\n            const {\n              allowedArea: { w, h },\n            } = state\n            return setIn(state, [\"allowedArea\"], {\n              x: x - w / 2,\n              y: y - h / 2,\n              w,\n              h,\n            })\n          }\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex],\n            moveRegion(activeImage.regions[regionIndex], x, y)\n          )\n        }\n        case \"RESIZE_BOX\": {\n          const {\n            regionId,\n            freedom: [xFree, yFree],\n            original: { x: ox, y: oy, w: ow, h: oh },\n          } = state.mode\n\n          const dx = xFree === 0 ? ox : xFree === -1 ? Math.min(ox + ow, x) : ox\n          const dw =\n            xFree === 0\n              ? ow\n              : xFree === -1\n              ? ow + (ox - dx)\n              : Math.max(0, ow + (x - ox - ow))\n          const dy = yFree === 0 ? oy : yFree === -1 ? Math.min(oy + oh, y) : oy\n          const dh =\n            yFree === 0\n              ? oh\n              : yFree === -1\n              ? oh + (oy - dy)\n              : Math.max(0, oh + (y - oy - oh))\n\n          // determine if we should switch the freedom\n          if (dw <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree * -1, yFree])\n          }\n          if (dh <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree, yFree * -1])\n          }\n\n          if (regionId === \"$$allowed_area\") {\n            return setIn(state, [\"allowedArea\"], {\n              x: dx,\n              w: dw,\n              y: dy,\n              h: dh,\n            })\n          }\n\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          const rectangle= activeImage.regions[regionIndex]\n\n          return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n            ...rectangle,\n            x: dx,\n            w: dw,\n            y: dy,\n            h: dh,\n          })\n        }\n        case \"DRAW_POLYGON\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              (region: any).points.length - 1,\n            ],\n            [x, y]\n          )\n        }\n        case \"DRAW_POLYGON1\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n              state,\n              [\n                ...pathToActiveImage,\n                \"regions\",\n                regionIndex,\n                \"points\",\n                \"holes\",\n                \"createHole\",\n                (region: any).points.length+(region: any).holes.length - 1,\n              ],\n              [x, y]\n          )\n        }\n        case \"RESIZE_CIRCLE\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n              state,\n              [\"images\", currentImageIndex, \"regions\", regionIndex],\n              {\n                ...region,\n                xr: Math.abs(region.x - x),\n                yr: Math.abs(region.y - y)\n              }\n          )\n        }\n        default:\n          return state\n      }\n    }\n    case \"MOUSE_DOWN\": {\n      if (!activeImage) return state\n      const { x, y } = action\n\n      state = setIn(state, [\"mouseDownAt\"], { x, y })\n\n      if (state.mode) {\n        switch (state.mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const [polygon, regionIndex] = getRegion(state.mode.regionId)\n            if (!polygon) break\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex],\n              { ...polygon, points: polygon.points.concat([[x, y]]) }\n            )\n          }\n          case \"DRAW_POLYGON1\": {\n            const [polygon1, region1Index] = getRegion(state.mode.regionId)\n            if (!polygon1) break\n            return setIn(\n                state,\n                [...pathToActiveImage, \"regions\", region1Index],\n                { ...polygon1, points: polygon1.points.concat([[x, y]]),holes:polygon1.holes.concat([[x, y]]) }\n            )\n          }\n          case \"DRAW_CIRCLE\": {\n            const [circle, regionIndex] = getRegion(state.mode.regionId)\n            if (!circle) break\n            return setIn(\n                state,\n                [...pathToActiveImage, \"regions\", regionIndex],\n                { ...circle}\n            )\n          }\n          default:\n            break\n        }\n      }\n\n      let newRegion\n      let defaultRegionCls = undefined,\n        defaultRegionColor = \"#ff0000\"\n      if (activeImage && (activeImage.regions || []).length > 0) {\n        defaultRegionCls = activeImage.regions.slice(-1)[0].cls\n        const clsIndex = (state.regionClsList || []).indexOf(defaultRegionCls)\n        if (clsIndex !== -1) {\n          defaultRegionColor = colors[clsIndex % colors.length]\n        }\n      }\n\n      switch (state.selectedTool) {\n        case \"create-point\": {\n          state = saveToHistory(state, \"Create Point\")\n          newRegion = {\n            type: \"point\",\n            x,\n            y,\n            highlighted: true,\n            editingLabels: true,\n            color: defaultRegionColor,\n            id: getRandomId(),\n            cls: defaultRegionCls,\n          }\n          break\n        }\n        case \"create-rectangle\": {\n          state = saveToHistory(state, \"Create Rectangle\")\n          newRegion = {\n            type: \"rectangle\",\n            x: x,\n            y: y,\n            w: 0,\n            h: 0,\n            highlighted: true,\n            editingLabels: false,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"RESIZE_BOX\",\n            editLabelEditorAfter: true,\n            regionId: newRegion.id,\n            freedom: [1, 1],\n            original: { x, y, w: newRegion.w, h: newRegion.h },\n            isNew: true,\n          })\n          break\n        }\n        case \"create-polygon\": {\n          if (state.mode && state.mode.mode === \"DRAW_POLYGON\") break\n          state = saveToHistory(state, \"Create Polygon\")\n          newRegion = {\n            type: \"polygon\",\n            points: [\n              [x, y],\n              [x, y],\n            ],\n            open: true,\n            highlighted: true,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_POLYGON\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        case \"create-polygon1\": {\n          if (state.mode && state.mode.mode === \"DRAW_POLYGON1\") break\n          state = saveToHistory(state, \"Create Polygon1\")\n          newRegion = {\n            type: \"polygon1\",\n            points: [\n              [x, y],\n              [x, y],\n            ],\n            holes:[[x, y],\n              [x, y],],\n            open: true,\n            creatingHole:false,\n            highlighted: true,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_POLYGON1\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        case \"create-circle\": {\n          state = saveToHistory(state, \"Create Circle\")\n          newRegion = {\n            type: \"circle\",\n            x: x,\n            y: y,\n            xr: 0.1,\n            yr: 0.1,\n            highlighted: true,\n            editingLabels: false,\n            color: defaultRegionColor,\n            id: getRandomId()\n          }\n          // state = unselectRegions(state)\n          state = setIn(state, [\"mode\"], {\n            mode: \"RESIZE_CIRCLE\",\n            editLabelEditorAfter: true,\n            regionId: newRegion.id,\n            original: { x: x, y: y, xr: newRegion.xr, yr: newRegion.yr }\n          })\n          break\n        }\n        default:\n          break\n      }\n\n      const regions = [...(getIn(state, pathToActiveImage).regions || [])]\n        .map((r) =>\n          setIn(r, [\"editingLabels\"], false).setIn([\"highlighted\"], false)\n        )\n        .concat(newRegion ? [newRegion] : [])\n\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"MOUSE_UP\": {\n      const { x, y } = action\n\n      const { mouseDownAt = { x, y } } = state\n      if (!state.mode) return state\n      state = setIn(state, [\"mouseDownAt\"], null)\n      switch (state.mode.mode) {\n        case \"RESIZE_BOX\": {\n          if (state.mode.isNew) {\n            if (\n              Math.abs(state.mode.original.x - x) < 0.002 ||\n              Math.abs(state.mode.original.y - y) < 0.002\n            ) {\n              return setIn(\n                modifyRegion(state.mode.regionId, null),\n                [\"mode\"],\n                null\n              )\n            }\n          }\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null,\n            }\n          }\n        }\n        case \"MOVE_REGION\":\n        case \"RESIZE_CIRCLE\": {\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null\n            }\n          }\n        }\n        case \"MOVE_POLYGON_POINT\": {\n          return { ...state, mode: null }\n        }\n        case \"MOVE_POLYGON1_POINT\": {\n          return { ...state, mode: null }\n        }\n        default:\n          return state\n      }\n    }\n    case \"OPEN_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const newRegions = setIn(\n        activeImage.regions.map((r) => ({\n          ...r,\n          highlighted: false,\n          editingLabels: false,\n        })),\n        [regionIndex],\n        {\n          ...(activeImage.regions || [])[regionIndex],\n          highlighted: true,\n          editingLabels: true,\n        }\n      )\n      return setIn(state, [...pathToActiveImage, \"regions\"], newRegions)\n    }\n    case \"CLOSE_REGION_EDITOR\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...(activeImage.regions || [])[regionIndex],\n        editingLabels: false,\n      })\n    }\n    case \"DELETE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (activeImage.regions || []).filter((r) => r.id !== action.region.id)\n      )\n    }\n    case \"DELETE_SELECTED_REGION\": {\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (activeImage.regions || []).filter((r) => !r.highlighted)\n      )\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      const buttonName = action.buttonName.toLowerCase()\n      switch (buttonName) {\n        case \"prev\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === 0) return state\n          return setNewImage(\n            state.images[currentImageIndex - 1],\n            currentImageIndex - 1\n          )\n        }\n        case \"next\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setNewImage(\n            state.images[currentImageIndex + 1],\n            currentImageIndex + 1\n          )\n        }\n        case \"clone\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setIn(\n            setNewImage(\n              state.images[currentImageIndex + 1],\n              currentImageIndex + 1\n            ),\n            [\"images\", currentImageIndex + 1, \"regions\"],\n            activeImage.regions\n          )\n        }\n        case \"hotkeys\": {\n          return state\n        }\n        case \"exit\":\n        case \"done\": {\n          return state\n        }\n        default:\n          return state\n      }\n    }\n    case \"SELECT_TOOL\": {\n\n      state = setIn(state, [\"mode\"], null)\n      return setIn(state, [\"selectedTool\"], action.selectedTool)\n    }\n    case \"BEGIN_CIRCLE_TRANSFORM\": {\n      const { circle, directions } = action\n      state = closeEditors(state)\n      if (directions === \"MOVE_REGION\") {\n        return setIn(state, [\"mode\"], {\n          mode: \"MOVE_REGION\",\n          regionId: circle.id\n        })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_CIRCLE\",\n          regionId: circle.id,\n          original: { x: circle.x, y: circle.y, rx: circle.rx, ry: circle.ry }\n        })\n      }\n    }\n    case \"CANCEL\": {\n      const { mode } = state\n      if (mode) {\n        switch (mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"DRAW_POLYGON1\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"MOVE_POLYGON_POINT\":\n          case \"MOVE_POLYGON1_POINT\":\n          case \"RESIZE_BOX\":\n          case \"RESIZE_CIRCLE\":\n          case \"MOVE_REGION\": {\n            return setIn(state, [\"mode\"], null)\n          }\n          default:\n            return state\n        }\n      }\n      // Close any open boxes\n      const regions: any = activeImage.regions\n      if (regions && regions.some((r) => r.editingLabels)) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map((r) => ({\n            ...r,\n            editingLabels: false,\n          }))\n        )\n      } else if (regions) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map((r) => ({\n            ...r,\n            highlighted: false,\n          }))\n        )\n      }\n      break\n    }\n\n\n    default:\n      break\n  }\n  return state\n}\n","\nimport type {\n  MainLayoutImageAnnotationState,\n  Action,\n} from \"../MainLayout/types\"\nimport { setIn } from \"seamless-immutable\"\nimport getActiveImage from \"./getActiveImage\"\n\nexport default (state: MainLayoutImageAnnotationState, action: Action) => {\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  switch (action.type) {\n    case \"IMAGE_LOADED\": {\n      return setIn(state, [\"images\", currentImageIndex, \"pixelSize\"], {\n        w: action.metadata.naturalWidth,\n        h: action.metadata.naturalHeight,\n      })\n    }\n  }\n  return state\n}\n","\nimport React, { useReducer, useEffect } from \"react\"\nimport MainLayout from \"./MainLayout/main_MainLayout\"\nimport type {\n  Image,\n  MainLayoutState,\n  Action,\n} from \"./MainLayout/types\"\n\nimport combineReducers from \"./reducers/combineReducers.js\"\nimport generalReducer from \"./reducers/generalReducer.js\"\nimport imageReducer from \"./reducers/imageReducer.js\"\nimport historyHandler from \"./reducers/historyHandler.js\"\nimport useEventCallback from \"use-event-callback\"\nimport makeImmutable, { without } from \"seamless-immutable\"\n\ntype Props = {\n  regionTagList?: Array<string>,\n  enabledTools?: Array<string>,\n  selectedTool?: String,\n  selectedImage?: string | number,\n  images?: Array<Image>,\n  onExit: (MainLayoutState) => any,\n}\n\nexport const Annotator = ({\n  images,\n  selectedImage = images && images.length > 0 ? 0 : undefined,\n  enabledTools = [\n    \"select\",\n    \"create-point\",\n    \"create-rectangle\",\n    \"create-polygon\",\n    \"create-polygon1\",\n    \"create-circle\"\n  ],\n  selectedTool = \"select\",\n  regionTagList = [],\n  onExit,\n  onNextImage,\n  onPrevImage,\n  allowComments,\n}: Props) => {\n  if (typeof selectedImage === \"string\") {\n    selectedImage = (images || []).findIndex((img) => img.src === selectedImage)\n    if (selectedImage === -1) selectedImage = undefined\n  }\n  const annotationType = \"image\"\n  const [state, dispatchToReducer] = useReducer(\n    historyHandler(\n      combineReducers(\n        imageReducer ,\n        generalReducer\n      )\n    ),\n    makeImmutable({\n      annotationType,\n      selectedTool,\n      mode: null,\n      regionTagList,\n      enabledTools,\n      history: [],\n      allowComments,\n      ...({\n            selectedImage,\n            images,\n          }),\n    })\n  )\n\n  const dispatchAction = useEventCallback((action: Action) => {\n    if (action.type === \"HEADER_BUTTON_CLICKED\") {\n      if ([\"Exit\", \"Done\", \"Save\", \"Complete\"].includes(action.buttonName)) {\n        return onExit(without(state, \"history\"))\n      } else if (action.buttonName === \"Next\" && onNextImage) {\n        return onNextImage(without(state, \"history\"))\n      } else if (action.buttonName === \"Prev\" && onPrevImage) {\n        return onPrevImage(without(state, \"history\"))\n      }\n    }\n    dispatchToReducer(action)\n  })\n\n  const onRegionClassAdded = useEventCallback((cls) => {\n    dispatchToReducer({\n      type: \"ON_CLS_ADDED\",\n      cls: cls,\n    })\n  })\n\n  useEffect(() => {\n    if (selectedImage === undefined) return\n    dispatchToReducer({\n      type: \"SELECT_IMAGE\",\n      imageIndex: selectedImage,\n      image: state.images[selectedImage],\n    })\n  }, [selectedImage])\n\n  if (!images )\n    return 'Missing required prop \"images\" '\n\n  return (\n\n      <MainLayout\n        alwaysShowNextButton={Boolean(onNextImage)}\n        alwaysShowPrevButton={Boolean(onPrevImage)}\n        state={state}\n        dispatchAction={dispatchAction}\n        onRegionClassAdded={onRegionClassAdded}\n      />\n\n  )\n}\nexport default Annotator\n","export default (...reducers) => (state, action) => {\n  for (const reducer of reducers) {\n    state = reducer(state, action)\n  }\n  return state\n}\n","import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport AnnotationTool from \"../annotateComponents/main_Annotate\";\nimport Button from 'react-bootstrap/Button';\n\nvar env = process.env.NODE_ENV;\nvar config = require(\"../../../config.json\");\n\n\nexport default class SubmitHIT extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            error: null,\n            isLoaded: false,\n            EnabledTools:null,\n            AllowComments:null,\n            Tags:null,\n            imgData: [\n                {\n                    src:\"https://geodata.lib.utexas.edu/assets/blac_featured_image_map-dca4cbca4e07010e5bd201ad8fab1cc0aa9abd24a8842f90e3c1eef1834e8498.jpg\",\n                    name: \"Image 1\",\n                    regions: []\n                },\n                {\n                    src:\"https://geodata.lib.utexas.edu/assets/utlmaps_featured_image_map-c07ae2551145ff2e5f5fa3c71baa345d9d674a33b08f422449203cf9ed47e0d1.jpg\",\n                    name: \"Image 2\",\n                    regions: []\n                },\n                {\n                    src:\"https://1igc0ojossa412h1e3ek8d1w-wpengine.netdna-ssl.com/wp-content/uploads/2018/03/TMSELEMWORLD.M.jpg\",\n                    name: \"Image 3\",\n                    regions: []\n                }\n            ],\n        }\n        this.props = props;\n        this.submitTask = this.submitTask.bind(this);\n        this.getSubmissionUrl = this.getSubmissionUrl.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.componentDidMount=this.componentDidMount(this);\n\n    }\n    getTools(res){\n        console.log(\"get tool:\",res.Tools['enenabledTools'])\n\n    }\n//get data from api\n    componentDidMount() {\n        function getEnabledTools(data) {\n            const enabledTools =data[\"enabledTools\"]\n            var res=[]\n            for (var i = 0; i < enabledTools.length; i++) {\n                if (enabledTools[i][\"create point\"]==true){\n                    res.push(\"create-point\")\n                }\n                else if (enabledTools[i][\"create rectangle\"]==true){\n                    res.push(\"create-rectangle\")\n                }\n                else if(enabledTools[i][\"create polygon\"]==true){\n                    res.push(\"create-polygon\")\n                }\n                else if(enabledTools[i][\"create polygon1\"]==true){\n                    res.push(\"create-polygon1\")\n                }\n                else if(enabledTools[i][\"create ellipse\"]==true){\n                    res.push(\"create-circle\")\n                }\n            }\n            return res\n\n        }\n\n        fetch(\"./backendConfig.json\")\n            .then(res => res.json())\n            .then(\n                (result) => {\n                    const enabledTools=getEnabledTools(result[\"setup\"])\n                    this.setState({\n                        isLoaded: true,\n                        EnabledTools:enabledTools,\n                        AllowComments:result[\"setup\"][\"allow-comments\"],\n                        Tags:result[\"setup\"][\"tags\"]\n                    });\n                    console.log(\"res is: \", result)\n                },\n                // Note: it's important to handle errors here\n                // instead of a catch() block so that we don't swallow\n                // exceptions from actual bugs in components.\n                (error) => {\n                    this.setState({\n                        isLoaded: true,\n                        error\n                    });\n                }\n            )\n    }\n\n    parseParameters(url){\n        var params = {\n            'assignmentId' : null,\n            'hitId' : null,\n            'workerId' : null,\n            'turkSubmitTo' : null\n        };\n\n        var queryString = url.split('?')[1];\n\n        if (queryString){\n            var queryPieces = queryString.split('&');\n            for (var i = 0; i < queryPieces.length; ++i){\n                var pieces = queryPieces[i].split('=');\n                var paramName = pieces[0];\n                var paramValue = pieces[1];\n                if(paramName in params){\n                    params[paramName] = paramValue;\n                }\n            }\n        }\n\n        return params;\n    }\n\n    handleSubmit(e) {\n        e.preventDefault();\n        const input = document.getElementById('submitButton');\n        input.setAttribute('value', JSON.stringify(this.state.imgData));\n        console.log(input);\n        const form = document.getElementById('submitForm');\n        HTMLFormElement.prototype.submit.call(form);\n\n    }\n\n    submitTask(e) {\n        // e.preventDefault();\n        console.log(\"POSTing data\");\n        axios\n            .post(`${this.getSubmissionUrl()}`, {})\n            .then(function(response) {\n                console.log(response);\n            })\n            .catch(function(error) {\n                console.log(error);\n            });\n    }\n\n    getSubmissionUrl() {\n        let mturkParams = this.parseParameters(window.location.href);\n        const assignmentID =  mturkParams['assignmentId'];\n        const url = config[\"submit\"][env] + \"/?assignmentId=\" + assignmentID;\n        console.log(url);\n        return url;\n    }\n\n    render() {\n        const { error, isLoaded, EnabledTools, AllowComments, Tags, imgData} = this.state;\n        console.log(\"data is:\", this.state)\n        if (error) {\n            return <div>Error: {error.message}</div>;\n        } else if (!isLoaded) {\n            return <div>Loading...</div>;\n        } else {\n            return (\n                <div id=\"Submit\">\n\n                    <form\n                        id=\"submitForm\"\n                        type=\"submit\"\n                        method=\"POST\"\n                        action={this.getSubmissionUrl()}\n                    >\n                        <AnnotationTool\n                            name=\"AnnotationTool\"\n                            type=\"submit\"\n                            ref={value => {\n                                this.value = value;\n                            }}\n                            images={imgData}\n                            enabledTools={EnabledTools}\n                            regionTagList={Tags}\n                            allowComments={AllowComments}\n                            onExit={output => {\n                                this.setState({imgData: output.images});\n                                console.log(JSON.stringify(output.images))\n                            }}\n\n                        />\n                        <div>\n                            <Button variant=\"outline-dark\" size=\"lg\" block\n                                    name=\"Annotation\"\n                                    type=\"submit\"\n                                    id=\"submitButton\"\n                                    value={JSON.stringify(this.state.imgData)}\n                                    ref={value => {\n                                        this.value = value;\n                                    }}\n                            >Complete the HIT</Button>\n                        </div>\n                    </form>\n                </div>\n            );\n        }\n    }\n}\n","import React, {Component, useEffect, useState} from \"react\";\nimport Intro from \"./Introduction/main_Introduction\";\nimport Tutorial from \"./Tutorial/main_Tutorial\";\nimport SubmitHIT from \"./SubmitHIT/main_SubmitHIT\"\nimport styles from './styles_Home'\nimport {makeStyles} from \"@material-ui/core/styles\";\n// get style from style.js\nconst myStyle = makeStyles(styles)\n\nexport default function Home() {\n\n    const classes = myStyle();\n    const [tutorial, setTutorial] = useState({\n        steps:null,\n        imgUrl:null,\n    })\n    const [intro, setIntro]=useState({\n        intro:null,})\n    const [hasError, setHasError] = useState(false)\n    const [loading, setLoading]= useState(false)\n    useEffect(() => {\n        setLoading(true);\n        fetch(\"./backendConfig.json\").then(res=>res.json()).then(\n            (result) => {\n                console.log(\"start setState\");\n                setTutorial({\n                    steps:result[\"setup\"][\"tutorial\"][\"steps\"],\n                    imgUrl:result[\"setup\"][\"tutorial\"][\"imgUrl\"]\n                });\n                setIntro({\n                    intro:result[\"setup\"][\"introduction\"],\n                });\n                setLoading(false);\n            }\n        ).catch(err => {\n            setHasError(err)\n            setLoading(false)})\n    },[]);\n\n    if (hasError!=false) {\n        return <div>Error: {hasError.message}</div>;\n    } else if (loading) {\n        return <div>Loading...</div>;\n    } else {\n        return (\n            <div className={classes.homeContainer}>\n                <div className={classes.introTutorial}>\n                    <Intro title=\"Show tutorial\"\n                           intro={intro}>\n                        <Tutorial tutorial={tutorial} />\n                    </Intro >\n                </div>\n                <div className={classes.annotateContainer}>\n                    <SubmitHIT />\n                </div>\n            </div>\n\n        );\n    }\n\n}\n\n\n","import React, { Component } from \"react\";\nimport AnnotationTool from \"../Home/annotateComponents/main_Annotate\";\nimport results from \"../../train_results.json\";\n\nexport default class main_ShowResult extends Component {\n  render() {\n    //transfer object to arr\n    const resultsArr = []\n    Object.keys(results).forEach(\n        key => resultsArr.push(\n             results[key]))\n    console.log( resultsArr)\n    return (\n        <div>\n          {\n            //loop through arr\n            resultsArr.map((result, index) => {\n              if (result.Submit===\"Yes\")\n              return (\n                  <div key={index} >\n                    <AnnotationTool\n                      images={result.Annotation}\n                      enabledTools={[\"create-point\", \"create-rectangle\", \"create-polygon\"]}\n                      regionTagList={[\"tag1\", \"tag2\", \"tag3\"]}\n                      // comments\n                      allowComments={true}\n                      onExit={output => console.log(output.images)}\n                    />\n                  </div>\n              )\n            })\n          }\n        </div>\n    )\n  }\n}\n","import React from 'react';\nimport {\n    HashRouter as Router,\n    Switch,\n    Link,\n    Route\n} from 'react-router-dom';\nimport { createBrowserHistory } from \"history\";\n\nimport Home from './pages/Home/main_Home';\nimport preview from './pages/ShowResult/main_ShowResult';\n\nconst customHistory = createBrowserHistory();\n\nexport default (\n    <Router history={customHistory}>\n        <Switch>\n        <Route exact path=\"/\" component={Home} />\n            <Route exact path=\"/result\" component={preview} />\n\n        </Switch>\n    </Router>\n);","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\nimport React from \"react\"\nimport \"./site.css\"\nimport ReactDOM from 'react-dom';\nimport route from \"./route\";\nimport * as serviceWorker from './pages/Home/SubmitHIT/serviceWorker';\nimport 'bootstrap/dist/css/bootstrap.css';\n\n\nReactDOM.render(\n    <div>{route}\n    </div>,\n    document.getElementById('root')\n);\nserviceWorker.unregister();\n\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\n"],"sourceRoot":""}