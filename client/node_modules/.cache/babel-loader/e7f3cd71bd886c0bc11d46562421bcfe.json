{"ast":null,"code":"import matches from 'dom-helpers/matches';\nimport qsa from 'dom-helpers/querySelectorAll';\nimport React, { useCallback, useRef, useEffect, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { useUncontrolledProp } from 'uncontrollable';\nimport usePrevious from '@restart/hooks/usePrevious';\nimport useForceUpdate from '@restart/hooks/useForceUpdate';\nimport useGlobalListener from '@restart/hooks/useGlobalListener';\nimport useEventCallback from '@restart/hooks/useEventCallback';\nimport DropdownContext from './DropdownContext';\nimport DropdownMenu from './DropdownMenu';\nimport DropdownToggle from './DropdownToggle';\nvar propTypes = {\n  /**\r\n   * A render prop that returns the root dropdown element. The `props`\r\n   * argument should spread through to an element containing _both_ the\r\n   * menu and toggle in order to handle keyboard events for focus management.\r\n   *\r\n   * @type {Function ({\r\n   *   props: {\r\n   *     onKeyDown: (SyntheticEvent) => void,\r\n   *   },\r\n   * }) => React.Element}\r\n   */\n  children: PropTypes.node,\n\n  /**\r\n   * Determines the direction and location of the Menu in relation to it's Toggle.\r\n   */\n  drop: PropTypes.oneOf(['up', 'left', 'right', 'down']),\n\n  /**\r\n   * Controls the focus behavior for when the Dropdown is opened. Set to\r\n   * `true` to always focus the first menu item, `keyboard` to focus only when\r\n   * navigating via the keyboard, or `false` to disable completely\r\n   *\r\n   * The Default behavior is `false` **unless** the Menu has a `role=\"menu\"`\r\n   * where it will default to `keyboard` to match the recommended [ARIA Authoring practices](https://www.w3.org/TR/wai-aria-practices-1.1/#menubutton).\r\n   */\n  focusFirstItemOnShow: PropTypes.oneOf([false, true, 'keyboard']),\n\n  /**\r\n   * A css slector string that will return __focusable__ menu items.\r\n   * Selectors should be relative to the menu component:\r\n   * e.g. ` > li:not('.disabled')`\r\n   */\n  itemSelector: PropTypes.string,\n\n  /**\r\n   * Align the menu to the 'end' side of the placement side of the Dropdown toggle. The default placement is `top-start` or `bottom-start`.\r\n   */\n  alignEnd: PropTypes.bool,\n\n  /**\r\n   * Whether or not the Dropdown is visible.\r\n   *\r\n   * @controllable onToggle\r\n   */\n  show: PropTypes.bool,\n\n  /**\r\n   * Sets the initial show position of the Dropdown.\r\n   */\n  defaultShow: PropTypes.bool,\n\n  /**\r\n   * A callback fired when the Dropdown wishes to change visibility. Called with the requested\r\n   * `show` value, the DOM event, and the source that fired it: `'click'`,`'keydown'`,`'rootClose'`, or `'select'`.\r\n   *\r\n   * ```ts static\r\n   * function(\r\n   *   isOpen: boolean,\r\n   *   event: SyntheticEvent,\r\n   * ): void\r\n   * ```\r\n   *\r\n   * @controllable show\r\n   */\n  onToggle: PropTypes.func\n};\n\nfunction useRefWithUpdate() {\n  var forceUpdate = useForceUpdate();\n  var ref = useRef(null);\n  var attachRef = useCallback(function (element) {\n    ref.current = element; // ensure that a menu set triggers an update for consumers\n\n    forceUpdate();\n  }, [forceUpdate]);\n  return [ref, attachRef];\n}\n/**\r\n * @displayName Dropdown\r\n */\n\n\nfunction Dropdown(_ref) {\n  var drop = _ref.drop,\n      alignEnd = _ref.alignEnd,\n      defaultShow = _ref.defaultShow,\n      rawShow = _ref.show,\n      rawOnToggle = _ref.onToggle,\n      _ref$itemSelector = _ref.itemSelector,\n      itemSelector = _ref$itemSelector === void 0 ? '* > *' : _ref$itemSelector,\n      focusFirstItemOnShow = _ref.focusFirstItemOnShow,\n      children = _ref.children;\n\n  var _useUncontrolledProp = useUncontrolledProp(rawShow, defaultShow, rawOnToggle),\n      show = _useUncontrolledProp[0],\n      onToggle = _useUncontrolledProp[1]; // We use normal refs instead of useCallbackRef in order to populate the\n  // the value as quickly as possible, otherwise the effect to focus the element\n  // may run before the state value is set\n\n\n  var _useRefWithUpdate = useRefWithUpdate(),\n      menuRef = _useRefWithUpdate[0],\n      setMenu = _useRefWithUpdate[1];\n\n  var menuElement = menuRef.current;\n\n  var _useRefWithUpdate2 = useRefWithUpdate(),\n      toggleRef = _useRefWithUpdate2[0],\n      setToggle = _useRefWithUpdate2[1];\n\n  var toggleElement = toggleRef.current;\n  var lastShow = usePrevious(show);\n  var lastSourceEvent = useRef(null);\n  var focusInDropdown = useRef(false);\n  var toggle = useCallback(function (nextShow, event) {\n    onToggle(nextShow, event);\n  }, [onToggle]);\n  var context = useMemo(function () {\n    return {\n      toggle: toggle,\n      drop: drop,\n      show: show,\n      alignEnd: alignEnd,\n      menuElement: menuElement,\n      toggleElement: toggleElement,\n      setMenu: setMenu,\n      setToggle: setToggle\n    };\n  }, [toggle, drop, show, alignEnd, menuElement, toggleElement, setMenu, setToggle]);\n\n  if (menuElement && lastShow && !show) {\n    focusInDropdown.current = menuElement.contains(document.activeElement);\n  }\n\n  var focusToggle = useEventCallback(function () {\n    if (toggleElement && toggleElement.focus) {\n      toggleElement.focus();\n    }\n  });\n  var maybeFocusFirst = useEventCallback(function () {\n    var type = lastSourceEvent.current;\n    var focusType = focusFirstItemOnShow;\n\n    if (focusType == null) {\n      focusType = menuRef.current && matches(menuRef.current, '[role=menu]') ? 'keyboard' : false;\n    }\n\n    if (focusType === false || focusType === 'keyboard' && !/^key.+$/.test(type)) {\n      return;\n    }\n\n    var first = qsa(menuRef.current, itemSelector)[0];\n    if (first && first.focus) first.focus();\n  });\n  useEffect(function () {\n    if (show) maybeFocusFirst();else if (focusInDropdown.current) {\n      focusInDropdown.current = false;\n      focusToggle();\n    } // only `show` should be changing\n  }, [show, focusInDropdown, focusToggle, maybeFocusFirst]);\n  useEffect(function () {\n    lastSourceEvent.current = null;\n  });\n\n  var getNextFocusedChild = function getNextFocusedChild(current, offset) {\n    if (!menuRef.current) return null;\n    var items = qsa(menuRef.current, itemSelector);\n    var index = items.indexOf(current) + offset;\n    index = Math.max(0, Math.min(index, items.length));\n    return items[index];\n  };\n\n  useGlobalListener('keydown', function (event) {\n    var _menuRef$current, _toggleRef$current;\n\n    var key = event.key;\n    var target = event.target;\n    var fromMenu = (_menuRef$current = menuRef.current) == null ? void 0 : _menuRef$current.contains(target);\n    var fromToggle = (_toggleRef$current = toggleRef.current) == null ? void 0 : _toggleRef$current.contains(target); // Second only to https://github.com/twbs/bootstrap/blob/8cfbf6933b8a0146ac3fbc369f19e520bd1ebdac/js/src/dropdown.js#L400\n    // in inscrutability\n\n    var isInput = /input|textarea/i.test(target.tagName);\n\n    if (isInput && (key === ' ' || key !== 'Escape' && fromMenu)) {\n      return;\n    }\n\n    if (!fromMenu && !fromToggle) {\n      return;\n    }\n\n    lastSourceEvent.current = event.type;\n\n    switch (key) {\n      case 'ArrowUp':\n        {\n          var next = getNextFocusedChild(target, -1);\n          if (next && next.focus) next.focus();\n          event.preventDefault();\n          return;\n        }\n\n      case 'ArrowDown':\n        event.preventDefault();\n\n        if (!show) {\n          onToggle(true, event);\n        } else {\n          var _next = getNextFocusedChild(target, 1);\n\n          if (_next && _next.focus) _next.focus();\n        }\n\n        return;\n\n      case 'Escape':\n      case 'Tab':\n        if (key === 'Escape') {\n          event.preventDefault();\n          event.stopPropagation();\n        }\n\n        onToggle(false, event);\n        break;\n\n      default:\n    }\n  });\n  return /*#__PURE__*/React.createElement(DropdownContext.Provider, {\n    value: context\n  }, children);\n}\n\nDropdown.displayName = 'ReactOverlaysDropdown';\nDropdown.propTypes = propTypes;\nDropdown.Menu = DropdownMenu;\nDropdown.Toggle = DropdownToggle;\nexport default Dropdown;","map":{"version":3,"sources":["D:/GitHub/ML4GIS/client/node_modules/react-overlays/esm/Dropdown.js"],"names":["matches","qsa","React","useCallback","useRef","useEffect","useMemo","PropTypes","useUncontrolledProp","usePrevious","useForceUpdate","useGlobalListener","useEventCallback","DropdownContext","DropdownMenu","DropdownToggle","propTypes","children","node","drop","oneOf","focusFirstItemOnShow","itemSelector","string","alignEnd","bool","show","defaultShow","onToggle","func","useRefWithUpdate","forceUpdate","ref","attachRef","element","current","Dropdown","_ref","rawShow","rawOnToggle","_ref$itemSelector","_useUncontrolledProp","_useRefWithUpdate","menuRef","setMenu","menuElement","_useRefWithUpdate2","toggleRef","setToggle","toggleElement","lastShow","lastSourceEvent","focusInDropdown","toggle","nextShow","event","context","contains","document","activeElement","focusToggle","focus","maybeFocusFirst","type","focusType","test","first","getNextFocusedChild","offset","items","index","indexOf","Math","max","min","length","_menuRef$current","_toggleRef$current","key","target","fromMenu","fromToggle","isInput","tagName","next","preventDefault","_next","stopPropagation","createElement","Provider","value","displayName","Menu","Toggle"],"mappings":"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","sourcesContent":["import matches from 'dom-helpers/matches';\r\nimport qsa from 'dom-helpers/querySelectorAll';\r\nimport React, { useCallback, useRef, useEffect, useMemo } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useUncontrolledProp } from 'uncontrollable';\r\nimport usePrevious from '@restart/hooks/usePrevious';\r\nimport useForceUpdate from '@restart/hooks/useForceUpdate';\r\nimport useGlobalListener from '@restart/hooks/useGlobalListener';\r\nimport useEventCallback from '@restart/hooks/useEventCallback';\r\nimport DropdownContext from './DropdownContext';\r\nimport DropdownMenu from './DropdownMenu';\r\nimport DropdownToggle from './DropdownToggle';\r\nvar propTypes = {\r\n  /**\r\n   * A render prop that returns the root dropdown element. The `props`\r\n   * argument should spread through to an element containing _both_ the\r\n   * menu and toggle in order to handle keyboard events for focus management.\r\n   *\r\n   * @type {Function ({\r\n   *   props: {\r\n   *     onKeyDown: (SyntheticEvent) => void,\r\n   *   },\r\n   * }) => React.Element}\r\n   */\r\n  children: PropTypes.node,\r\n\r\n  /**\r\n   * Determines the direction and location of the Menu in relation to it's Toggle.\r\n   */\r\n  drop: PropTypes.oneOf(['up', 'left', 'right', 'down']),\r\n\r\n  /**\r\n   * Controls the focus behavior for when the Dropdown is opened. Set to\r\n   * `true` to always focus the first menu item, `keyboard` to focus only when\r\n   * navigating via the keyboard, or `false` to disable completely\r\n   *\r\n   * The Default behavior is `false` **unless** the Menu has a `role=\"menu\"`\r\n   * where it will default to `keyboard` to match the recommended [ARIA Authoring practices](https://www.w3.org/TR/wai-aria-practices-1.1/#menubutton).\r\n   */\r\n  focusFirstItemOnShow: PropTypes.oneOf([false, true, 'keyboard']),\r\n\r\n  /**\r\n   * A css slector string that will return __focusable__ menu items.\r\n   * Selectors should be relative to the menu component:\r\n   * e.g. ` > li:not('.disabled')`\r\n   */\r\n  itemSelector: PropTypes.string,\r\n\r\n  /**\r\n   * Align the menu to the 'end' side of the placement side of the Dropdown toggle. The default placement is `top-start` or `bottom-start`.\r\n   */\r\n  alignEnd: PropTypes.bool,\r\n\r\n  /**\r\n   * Whether or not the Dropdown is visible.\r\n   *\r\n   * @controllable onToggle\r\n   */\r\n  show: PropTypes.bool,\r\n\r\n  /**\r\n   * Sets the initial show position of the Dropdown.\r\n   */\r\n  defaultShow: PropTypes.bool,\r\n\r\n  /**\r\n   * A callback fired when the Dropdown wishes to change visibility. Called with the requested\r\n   * `show` value, the DOM event, and the source that fired it: `'click'`,`'keydown'`,`'rootClose'`, or `'select'`.\r\n   *\r\n   * ```ts static\r\n   * function(\r\n   *   isOpen: boolean,\r\n   *   event: SyntheticEvent,\r\n   * ): void\r\n   * ```\r\n   *\r\n   * @controllable show\r\n   */\r\n  onToggle: PropTypes.func\r\n};\r\n\r\nfunction useRefWithUpdate() {\r\n  var forceUpdate = useForceUpdate();\r\n  var ref = useRef(null);\r\n  var attachRef = useCallback(function (element) {\r\n    ref.current = element; // ensure that a menu set triggers an update for consumers\r\n\r\n    forceUpdate();\r\n  }, [forceUpdate]);\r\n  return [ref, attachRef];\r\n}\r\n/**\r\n * @displayName Dropdown\r\n */\r\n\r\n\r\nfunction Dropdown(_ref) {\r\n  var drop = _ref.drop,\r\n      alignEnd = _ref.alignEnd,\r\n      defaultShow = _ref.defaultShow,\r\n      rawShow = _ref.show,\r\n      rawOnToggle = _ref.onToggle,\r\n      _ref$itemSelector = _ref.itemSelector,\r\n      itemSelector = _ref$itemSelector === void 0 ? '* > *' : _ref$itemSelector,\r\n      focusFirstItemOnShow = _ref.focusFirstItemOnShow,\r\n      children = _ref.children;\r\n\r\n  var _useUncontrolledProp = useUncontrolledProp(rawShow, defaultShow, rawOnToggle),\r\n      show = _useUncontrolledProp[0],\r\n      onToggle = _useUncontrolledProp[1]; // We use normal refs instead of useCallbackRef in order to populate the\r\n  // the value as quickly as possible, otherwise the effect to focus the element\r\n  // may run before the state value is set\r\n\r\n\r\n  var _useRefWithUpdate = useRefWithUpdate(),\r\n      menuRef = _useRefWithUpdate[0],\r\n      setMenu = _useRefWithUpdate[1];\r\n\r\n  var menuElement = menuRef.current;\r\n\r\n  var _useRefWithUpdate2 = useRefWithUpdate(),\r\n      toggleRef = _useRefWithUpdate2[0],\r\n      setToggle = _useRefWithUpdate2[1];\r\n\r\n  var toggleElement = toggleRef.current;\r\n  var lastShow = usePrevious(show);\r\n  var lastSourceEvent = useRef(null);\r\n  var focusInDropdown = useRef(false);\r\n  var toggle = useCallback(function (nextShow, event) {\r\n    onToggle(nextShow, event);\r\n  }, [onToggle]);\r\n  var context = useMemo(function () {\r\n    return {\r\n      toggle: toggle,\r\n      drop: drop,\r\n      show: show,\r\n      alignEnd: alignEnd,\r\n      menuElement: menuElement,\r\n      toggleElement: toggleElement,\r\n      setMenu: setMenu,\r\n      setToggle: setToggle\r\n    };\r\n  }, [toggle, drop, show, alignEnd, menuElement, toggleElement, setMenu, setToggle]);\r\n\r\n  if (menuElement && lastShow && !show) {\r\n    focusInDropdown.current = menuElement.contains(document.activeElement);\r\n  }\r\n\r\n  var focusToggle = useEventCallback(function () {\r\n    if (toggleElement && toggleElement.focus) {\r\n      toggleElement.focus();\r\n    }\r\n  });\r\n  var maybeFocusFirst = useEventCallback(function () {\r\n    var type = lastSourceEvent.current;\r\n    var focusType = focusFirstItemOnShow;\r\n\r\n    if (focusType == null) {\r\n      focusType = menuRef.current && matches(menuRef.current, '[role=menu]') ? 'keyboard' : false;\r\n    }\r\n\r\n    if (focusType === false || focusType === 'keyboard' && !/^key.+$/.test(type)) {\r\n      return;\r\n    }\r\n\r\n    var first = qsa(menuRef.current, itemSelector)[0];\r\n    if (first && first.focus) first.focus();\r\n  });\r\n  useEffect(function () {\r\n    if (show) maybeFocusFirst();else if (focusInDropdown.current) {\r\n      focusInDropdown.current = false;\r\n      focusToggle();\r\n    } // only `show` should be changing\r\n  }, [show, focusInDropdown, focusToggle, maybeFocusFirst]);\r\n  useEffect(function () {\r\n    lastSourceEvent.current = null;\r\n  });\r\n\r\n  var getNextFocusedChild = function getNextFocusedChild(current, offset) {\r\n    if (!menuRef.current) return null;\r\n    var items = qsa(menuRef.current, itemSelector);\r\n    var index = items.indexOf(current) + offset;\r\n    index = Math.max(0, Math.min(index, items.length));\r\n    return items[index];\r\n  };\r\n\r\n  useGlobalListener('keydown', function (event) {\r\n    var _menuRef$current, _toggleRef$current;\r\n\r\n    var key = event.key;\r\n    var target = event.target;\r\n    var fromMenu = (_menuRef$current = menuRef.current) == null ? void 0 : _menuRef$current.contains(target);\r\n    var fromToggle = (_toggleRef$current = toggleRef.current) == null ? void 0 : _toggleRef$current.contains(target); // Second only to https://github.com/twbs/bootstrap/blob/8cfbf6933b8a0146ac3fbc369f19e520bd1ebdac/js/src/dropdown.js#L400\r\n    // in inscrutability\r\n\r\n    var isInput = /input|textarea/i.test(target.tagName);\r\n\r\n    if (isInput && (key === ' ' || key !== 'Escape' && fromMenu)) {\r\n      return;\r\n    }\r\n\r\n    if (!fromMenu && !fromToggle) {\r\n      return;\r\n    }\r\n\r\n    lastSourceEvent.current = event.type;\r\n\r\n    switch (key) {\r\n      case 'ArrowUp':\r\n        {\r\n          var next = getNextFocusedChild(target, -1);\r\n          if (next && next.focus) next.focus();\r\n          event.preventDefault();\r\n          return;\r\n        }\r\n\r\n      case 'ArrowDown':\r\n        event.preventDefault();\r\n\r\n        if (!show) {\r\n          onToggle(true, event);\r\n        } else {\r\n          var _next = getNextFocusedChild(target, 1);\r\n\r\n          if (_next && _next.focus) _next.focus();\r\n        }\r\n\r\n        return;\r\n\r\n      case 'Escape':\r\n      case 'Tab':\r\n        if (key === 'Escape') {\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n        }\r\n\r\n        onToggle(false, event);\r\n        break;\r\n\r\n      default:\r\n    }\r\n  });\r\n  return /*#__PURE__*/React.createElement(DropdownContext.Provider, {\r\n    value: context\r\n  }, children);\r\n}\r\n\r\nDropdown.displayName = 'ReactOverlaysDropdown';\r\nDropdown.propTypes = propTypes;\r\nDropdown.Menu = DropdownMenu;\r\nDropdown.Toggle = DropdownToggle;\r\nexport default Dropdown;"]},"metadata":{},"sourceType":"module"}