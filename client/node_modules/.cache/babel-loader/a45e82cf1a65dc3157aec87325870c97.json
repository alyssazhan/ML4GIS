{"ast":null,"code":"import _objectSpread from \"/Users/yan/Documents/GItHub/ML4GIS/client/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"/Users/yan/Documents/GItHub/ML4GIS/client/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/yan/Documents/GItHub/ML4GIS/client/src/pages/Home/annotateComponents/MainLayout/index.js\";\nimport React, { useRef, useCallback } from \"react\";\nimport { makeStyles, styled } from \"@material-ui/core/styles\";\nimport ImageCanvas from \"../ImageCanvas\";\nimport styles from \"./styles\";\nimport type, { MainLayoutState, Action } from \"./types\";\nimport useKey from \"use-key-hook\";\nimport classnames from \"classnames\";\nimport getActiveImage from \"../reducers/getActiveImage\";\nimport { useDispatchHotkeyHandlers } from \"../ShortcutsManager\";\nimport { withHotKeys } from \"react-hotkeys\";\nimport iconDictionary from \"./iconDictionary\";\nimport Workspace from \"react-material-workspace-layout/Workspace\";\nimport useEventCallback from \"use-event-callback\";\nconst useStyles = makeStyles(styles);\nconst HotkeyDiv = withHotKeys((_ref) => {\n  let hotKeys = _ref.hotKeys,\n      children = _ref.children,\n      divRef = _ref.divRef,\n      props = _objectWithoutProperties(_ref, [\"hotKeys\", \"children\", \"divRef\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", Object.assign({}, _objectSpread(_objectSpread({}, hotKeys), props), {\n    ref: divRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 3\n    }\n  }), children);\n});\nexport const MainLayout = ({\n  state,\n  dispatch\n}) => {\n  const classes = useStyles();\n  const memoizedActionFns = useRef({});\n\n  const action = (type, ...params) => {\n    const fnKey = \"\".concat(type, \"(\").concat(params.join(\",\"), \")\");\n    if (memoizedActionFns.current[fnKey]) return memoizedActionFns.current[fnKey];\n\n    const fn = (...args) => params.length > 0 ? dispatch(_objectSpread({\n      type\n    }, params.reduce((acc, p, i) => (acc[p] = args[i], acc), {}))) : dispatch(_objectSpread({\n      type\n    }, args[0]));\n\n    memoizedActionFns.current[fnKey] = fn;\n    return fn;\n  };\n\n  const _getActiveImage = getActiveImage(state),\n        currentImageIndex = _getActiveImage.currentImageIndex,\n        activeImage = _getActiveImage.activeImage;\n\n  let nextImage;\n\n  if (currentImageIndex !== null) {\n    nextImage = state.images[currentImageIndex + 1];\n  }\n\n  useKey(() => dispatch({\n    type: \"CANCEL\"\n  }), {\n    detectKeys: [27]\n  });\n  const innerContainerRef = useRef();\n  const hotkeyHandlers = useDispatchHotkeyHandlers({\n    dispatch\n  });\n  const refocusOnMouseEvent = useCallback(e => {\n    if (!innerContainerRef.current) return;\n    if (innerContainerRef.current.contains(document.activeElement)) return;\n\n    if (innerContainerRef.current.contains(e.target)) {\n      innerContainerRef.current.focus();\n      e.target.focus();\n    }\n  }, []);\n  const canvas = /*#__PURE__*/React.createElement(ImageCanvas, {\n    key: state.selectedImage,\n    showTags: state.showTags,\n    regionTagList: state.regionTagList,\n    regions: activeImage.regions || [],\n    realSize: activeImage ? activeImage.realSize : undefined,\n    imageSrc: state.annotationType === \"image\" ? activeImage.src : null,\n    pointDistancePrecision: state.pointDistancePrecision,\n    createWithPrimary: state.selectedTool.includes(\"create\"),\n    dragWithPrimary: state.selectedTool === \"pan\",\n    zoomWithPrimary: state.selectedTool === \"zoom\",\n    onMouseMove: action(\"MOUSE_MOVE\"),\n    onMouseDown: action(\"MOUSE_DOWN\"),\n    onMouseUp: action(\"MOUSE_UP\"),\n    onChangeRegion: action(\"CHANGE_REGION\", \"region\"),\n    onBeginRegionEdit: action(\"OPEN_REGION_EDITOR\", \"region\"),\n    onCloseRegionEdit: action(\"CLOSE_REGION_EDITOR\", \"region\"),\n    onDeleteRegion: action(\"DELETE_REGION\", \"region\"),\n    onBeginBoxTransform: action(\"BEGIN_BOX_TRANSFORM\", \"rectangle\", \"directions\"),\n    onBeginMovePolygonPoint: action(\"BEGIN_MOVE_POLYGON_POINT\", \"polygon\", \"pointIndex\"),\n    onAddPolygonPoint: action(\"ADD_POLYGON_POINT\", \"polygon\", \"point\", \"pointIndex\"),\n    onSelectRegion: action(\"SELECT_REGION\", \"region\"),\n    onBeginMovePoint: action(\"BEGIN_MOVE_POINT\", \"point\"),\n    onImageLoaded: action(\"IMAGE_LOADED\", \"image\"),\n    allowComments: state.allowComments,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }\n  });\n  const onClickIconSidebarItem = useEventCallback(item => {\n    dispatch({\n      type: \"SELECT_TOOL\",\n      selectedTool: item.name\n    });\n  });\n  const onClickHeaderItem = useEventCallback(item => {\n    dispatch({\n      type: \"HEADER_BUTTON_CLICKED\",\n      buttonName: item.name\n    });\n  });\n  return /*#__PURE__*/React.createElement(HotkeyDiv, {\n    tabIndex: -1,\n    divRef: innerContainerRef,\n    onMouseDown: refocusOnMouseEvent,\n    onMouseOver: refocusOnMouseEvent,\n    allowChanges: true,\n    handlers: hotkeyHandlers,\n    className: classnames(classes.container),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Workspace, {\n    iconDictionary: iconDictionary,\n    headerLeftSide: [activeImage ? /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.headerTitle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }, activeImage.name) : null].filter(Boolean),\n    headerItems: [{\n      name: \"Prev\"\n    }, {\n      name: \"Next\"\n    }, {\n      name: \"Save\"\n    }].filter(Boolean),\n    onClickHeaderItem: onClickHeaderItem,\n    onClickIconSidebarItem: onClickIconSidebarItem,\n    selectedTools: [state.selectedTool].filter(Boolean),\n    iconSidebarItems: [{\n      name: \"pan\",\n      helperText: \"Drag/Pan (right or middle click)\",\n      alwaysShowing: true\n    }, {\n      name: \"zoom\",\n      helperText: \"Zoom In/Out\",\n      alwaysShowing: true\n    }, {\n      name: \"create-point\",\n      helperText: \"Add Point\"\n    }, {\n      name: \"create-rectangle\",\n      helperText: \"Add Rectangle\"\n    }, {\n      name: \"create-polygon\",\n      helperText: \"Add Polygon\"\n    }].filter(Boolean).filter(a => a.alwaysShowing || state.enabledTools.includes(a.name)),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, canvas));\n};\nexport default MainLayout;","map":{"version":3,"sources":["/Users/yan/Documents/GItHub/ML4GIS/client/src/pages/Home/annotateComponents/MainLayout/index.js"],"names":["React","useRef","useCallback","makeStyles","styled","ImageCanvas","styles","type","MainLayoutState","Action","useKey","classnames","getActiveImage","useDispatchHotkeyHandlers","withHotKeys","iconDictionary","Workspace","useEventCallback","useStyles","HotkeyDiv","hotKeys","children","divRef","props","MainLayout","state","dispatch","classes","memoizedActionFns","action","params","fnKey","join","current","fn","args","length","reduce","acc","p","i","currentImageIndex","activeImage","nextImage","images","detectKeys","innerContainerRef","hotkeyHandlers","refocusOnMouseEvent","e","contains","document","activeElement","target","focus","canvas","selectedImage","showTags","regionTagList","regions","realSize","undefined","annotationType","src","pointDistancePrecision","selectedTool","includes","allowComments","onClickIconSidebarItem","item","name","onClickHeaderItem","buttonName","container","headerTitle","filter","Boolean","helperText","alwaysShowing","a","enabledTools"],"mappings":"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","sourcesContent":["\nimport React, { useRef, useCallback } from \"react\"\nimport { makeStyles, styled } from \"@material-ui/core/styles\"\nimport ImageCanvas from \"../ImageCanvas\"\nimport styles from \"./styles\"\nimport type, { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport getActiveImage from \"../reducers/getActiveImage\"\nimport { useDispatchHotkeyHandlers } from \"../ShortcutsManager\"\nimport { withHotKeys } from \"react-hotkeys\"\nimport iconDictionary from \"./iconDictionary\"\nimport Workspace from \"react-material-workspace-layout/Workspace\"\nimport useEventCallback from \"use-event-callback\"\n\nconst useStyles = makeStyles(styles)\n\nconst HotkeyDiv = withHotKeys(({ hotKeys, children, divRef, ...props }) => (\n  <div {...{ ...hotKeys, ...props }} ref={divRef}>\n    {children}\n  </div>\n))\n\ntype Props = {\n  state: MainLayoutState,\n  dispatch: (Action) => any,\n  onRegionClassAdded: () => {},\n}\n\nexport const MainLayout = ({\n  state,\n  dispatch,\n}: Props) => {\n  const classes = useStyles()\n\n  const memoizedActionFns = useRef({})\n  const action = (type: string, ...params: Array<string>) => {\n    const fnKey = `${type}(${params.join(\",\")})`\n    if (memoizedActionFns.current[fnKey])\n      return memoizedActionFns.current[fnKey]\n\n    const fn = (...args: any) =>\n      params.length > 0\n        ? dispatch(\n            ({\n              type,\n              ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {}),\n            }: any)\n          )\n        : dispatch({ type, ...args[0] })\n    memoizedActionFns.current[fnKey] = fn\n    return fn\n  }\n\n  const { currentImageIndex, activeImage } = getActiveImage(state)\n  let nextImage\n  if (currentImageIndex !== null) {\n    nextImage = state.images[currentImageIndex + 1]\n  }\n\n  useKey(() => dispatch({ type: \"CANCEL\" }), {\n    detectKeys: [27],\n  })\n\n  const innerContainerRef = useRef()\n  const hotkeyHandlers = useDispatchHotkeyHandlers({ dispatch })\n  const refocusOnMouseEvent = useCallback((e) => {\n    if (!innerContainerRef.current) return\n    if (innerContainerRef.current.contains(document.activeElement)) return\n    if (innerContainerRef.current.contains(e.target)) {\n      innerContainerRef.current.focus()\n      e.target.focus()\n    }\n  }, [])\n\n  const canvas = (\n    <ImageCanvas\n      key={state.selectedImage}\n      showTags={state.showTags}\n      regionTagList={state.regionTagList}\n      regions={\n        activeImage.regions || []\n      }\n      realSize={activeImage ? activeImage.realSize : undefined}\n      imageSrc={state.annotationType === \"image\" ? activeImage.src : null}\n      pointDistancePrecision={state.pointDistancePrecision}\n      createWithPrimary={state.selectedTool.includes(\"create\")}\n      dragWithPrimary={state.selectedTool === \"pan\"}\n      zoomWithPrimary={state.selectedTool === \"zoom\"}\n      onMouseMove={action(\"MOUSE_MOVE\")}\n      onMouseDown={action(\"MOUSE_DOWN\")}\n      onMouseUp={action(\"MOUSE_UP\")}\n      onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n      onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n      onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n      onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n      onBeginBoxTransform={action(\"BEGIN_BOX_TRANSFORM\", \"rectangle\", \"directions\")}\n      onBeginMovePolygonPoint={action(\n        \"BEGIN_MOVE_POLYGON_POINT\",\n        \"polygon\",\n        \"pointIndex\"\n      )}\n      onAddPolygonPoint={action(\n        \"ADD_POLYGON_POINT\",\n        \"polygon\",\n        \"point\",\n        \"pointIndex\"\n      )}\n      onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n      onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n      onImageLoaded={action(\"IMAGE_LOADED\", \"image\")}\n      allowComments={state.allowComments}\n    />\n  )\n\n  const onClickIconSidebarItem = useEventCallback((item) => {\n    dispatch({ type: \"SELECT_TOOL\", selectedTool: item.name })\n  })\n\n  const onClickHeaderItem = useEventCallback((item) => {\n    dispatch({ type: \"HEADER_BUTTON_CLICKED\", buttonName: item.name })\n  })\n  return (\n        <HotkeyDiv\n          tabIndex={-1}\n          divRef={innerContainerRef}\n          onMouseDown={refocusOnMouseEvent}\n          onMouseOver={refocusOnMouseEvent}\n          allowChanges\n          handlers={hotkeyHandlers}\n          className={classnames(\n            classes.container,\n\n          )}\n        >\n          <Workspace\n            iconDictionary={iconDictionary}\n            headerLeftSide={[\n               activeImage ? (\n                <div className={classes.headerTitle}>{activeImage.name}</div>\n              ) : null,\n            ].filter(Boolean)}\n            headerItems={[\n              { name: \"Prev\" },\n              { name: \"Next\" },\n              { name: \"Save\" },\n            ].filter(Boolean)}\n            onClickHeaderItem={onClickHeaderItem}\n            onClickIconSidebarItem={onClickIconSidebarItem}\n            selectedTools={[\n              state.selectedTool,\n            ].filter(Boolean)}\n            iconSidebarItems={[\n              {\n                name: \"pan\",\n                helperText:\n                  \"Drag/Pan (right or middle click)\",\n                alwaysShowing: true,\n              },\n              {\n                name: \"zoom\",\n                helperText:\n                  \"Zoom In/Out\",\n                alwaysShowing: true,\n              },\n              {\n                name: \"create-point\",\n                helperText: \"Add Point\" ,\n              },\n              {\n                name: \"create-rectangle\",\n                helperText:\n                  \"Add Rectangle\" ,\n              },\n              {\n                name: \"create-polygon\",\n                helperText: \"Add Polygon\",\n              },\n\n            ]\n              .filter(Boolean)\n              .filter(\n                (a) => a.alwaysShowing || state.enabledTools.includes(a.name)\n              )}\n\n          >\n            {canvas}\n          </Workspace>\n        </HotkeyDiv>\n  )\n}\n\nexport default MainLayout\n"]},"metadata":{},"sourceType":"module"}