{"ast":null,"code":"var _jsxFileName = \"/Users/yan/Documents/proj/ML4GIS/client/src/pages/Home/SubmitHIT/index.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport AnnotationTool from \"../annotateComponents\";\nimport Button from 'react-bootstrap/Button';\nvar env = process.env.NODE_ENV;\n\nvar config = require(\"../../../config.json\");\n\nexport default class SubmitHIT extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      EnabledTools: null,\n      AllowComments: null,\n      Tags: null,\n      imgData: [{\n        src: \"https://geodata.lib.utexas.edu/assets/blac_featured_image_map-dca4cbca4e07010e5bd201ad8fab1cc0aa9abd24a8842f90e3c1eef1834e8498.jpg\",\n        name: \"Image 1\",\n        regions: []\n      }, {\n        src: \"https://geodata.lib.utexas.edu/assets/utlmaps_featured_image_map-c07ae2551145ff2e5f5fa3c71baa345d9d674a33b08f422449203cf9ed47e0d1.jpg\",\n        name: \"Image 2\",\n        regions: []\n      }, {\n        src: \"https://1igc0ojossa412h1e3ek8d1w-wpengine.netdna-ssl.com/wp-content/uploads/2018/03/TMSELEMWORLD.M.jpg\",\n        name: \"Image 3\",\n        regions: []\n      }]\n    };\n    this.props = props;\n    this.submitTask = this.submitTask.bind(this);\n    this.getSubmissionUrl = this.getSubmissionUrl.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.componentDidMount = this.componentDidMount(this); // this.parsed = queryString.parse(this.props.location.search);\n  }\n\n  getTools(res) {\n    console.log(\"get tool:\", res.Tools['enenabledTools']);\n  } //get data from api\n\n\n  componentDidMount() {\n    function getEnabledTools(data) {\n      const enabledTools = data[\"enabledTools\"];\n      var res = [];\n\n      for (var i = 0; i < enabledTools.length; i++) {\n        if (enabledTools[i][\"create point\"] == true) {\n          res.push(\"create-point\");\n        } else if (enabledTools[i][\"create rectangle\"] == true) {\n          res.push(\"create-rectangle\");\n        } else if (enabledTools[i][\"create polygon\"] == true) {\n          res.push(\"create-polygon\");\n        }\n      }\n\n      return res;\n    }\n\n    fetch(\"/api\", {\n      mode: 'cors'\n    }).then(res => res.json()).then(result => {\n      const enabledTools = getEnabledTools(result[\"setup\"]);\n      this.setState({\n        isLoaded: true,\n        EnabledTools: enabledTools,\n        AllowComments: result[\"setup\"][\"allow-comments\"],\n        Tags: result[\"setup\"][\"tags\"]\n      });\n      console.log(\"res is: \", result);\n    }, // Note: it's important to handle errors here\n    // instead of a catch() block so that we don't swallow\n    // exceptions from actual bugs in components.\n    error => {\n      this.setState({\n        isLoaded: true,\n        error\n      });\n    });\n  }\n\n  parseParameters(url) {\n    var params = {\n      'assignmentId': null,\n      'hitId': null,\n      'workerId': null,\n      'turkSubmitTo': null\n    };\n    var queryString = url.split('?')[1];\n\n    if (queryString) {\n      var queryPieces = queryString.split('&');\n\n      for (var i = 0; i < queryPieces.length; ++i) {\n        var pieces = queryPieces[i].split('=');\n        var paramName = pieces[0];\n        var paramValue = pieces[1];\n\n        if (paramName in params) {\n          params[paramName] = paramValue;\n        }\n      }\n    }\n\n    return params;\n  }\n\n  hasAcceptedTask() {\n    let url = window.location.href;\n    let mturkParams = this.parseParameters(url);\n    const assignmentID = mturkParams['assignmentId'];\n    if (assignmentID === undefined) return false;\n    return assignmentID !== \"ASSIGNMENT_ID_NOT_AVAILABLE\";\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const input = document.getElementById('submitButton');\n    input.setAttribute('value', JSON.stringify(this.state.imgData));\n    console.log(input);\n    const form = document.getElementById('submitForm');\n    HTMLFormElement.prototype.submit.call(form);\n  }\n\n  submitTask(e) {\n    // e.preventDefault();\n    console.log(\"POSTing data\");\n    axios.post(\"\".concat(this.getSubmissionUrl()), {}).then(function (response) {\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  getSubmissionUrl() {\n    let mturkParams = this.parseParameters(window.location.href);\n    const assignmentID = mturkParams['assignmentId'];\n    const url = config[\"submit\"][env] + \"/?assignmentId=\" + assignmentID;\n    console.log(url);\n    return url;\n  }\n\n  render() {\n    const _this$state = this.state,\n          error = _this$state.error,\n          isLoaded = _this$state.isLoaded,\n          EnabledTools = _this$state.EnabledTools,\n          AllowComments = _this$state.AllowComments,\n          Tags = _this$state.Tags,\n          imgData = _this$state.imgData;\n    console.log(\"data is:\", this.state);\n\n    if (error) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 14\n        }\n      }, \"Error: \", error.message);\n    } else if (!isLoaded) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 14\n        }\n      }, \"Loading...\");\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"Submit\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"form\", {\n        id: \"submitForm\",\n        type: \"submit\",\n        method: \"POST\",\n        action: this.getSubmissionUrl(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(AnnotationTool, {\n        name: \"AnnotationTool\",\n        type: \"submit\",\n        ref: value => {\n          this.value = value;\n        },\n        images: imgData // labelImages\n        // annotationType={\"image\"}\n        // function\n        ,\n        enabledTools: EnabledTools,\n        regionTagList: Tags // comments\n        ,\n        allowComments: AllowComments,\n        onExit: output => {\n          this.setState({\n            imgData: output.images\n          });\n          console.log(JSON.stringify(output.images));\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        variant: \"outline-dark\",\n        size: \"lg\",\n        block: true,\n        name: \"Annotation\",\n        type: \"submit\",\n        id: \"submitButton\",\n        value: JSON.stringify(this.state.imgData),\n        ref: value => {\n          this.value = value;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 17\n        }\n      }, \"Complete the HIT\"))));\n    }\n  }\n\n}","map":{"version":3,"sources":["/Users/yan/Documents/proj/ML4GIS/client/src/pages/Home/SubmitHIT/index.js"],"names":["React","Component","axios","AnnotationTool","Button","env","process","NODE_ENV","config","require","SubmitHIT","constructor","props","state","error","isLoaded","EnabledTools","AllowComments","Tags","imgData","src","name","regions","submitTask","bind","getSubmissionUrl","handleSubmit","componentDidMount","getTools","res","console","log","Tools","getEnabledTools","data","enabledTools","i","length","push","fetch","mode","then","json","result","setState","parseParameters","url","params","queryString","split","queryPieces","pieces","paramName","paramValue","hasAcceptedTask","window","location","href","mturkParams","assignmentID","undefined","e","preventDefault","input","document","getElementById","setAttribute","JSON","stringify","form","HTMLFormElement","prototype","submit","call","post","response","catch","render","message","value","output","images"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport AnnotationTool from \"../annotateComponents\";\nimport Button from 'react-bootstrap/Button';\n\nvar env = process.env.NODE_ENV;\nvar config = require(\"../../../config.json\");\n\n\nexport default class SubmitHIT extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      EnabledTools:null,\n      AllowComments:null,\n      Tags:null,\n      imgData: [\n        {\n          src:\"https://geodata.lib.utexas.edu/assets/blac_featured_image_map-dca4cbca4e07010e5bd201ad8fab1cc0aa9abd24a8842f90e3c1eef1834e8498.jpg\",\n          name: \"Image 1\",\n          regions: []\n        },\n        {\n          src:\"https://geodata.lib.utexas.edu/assets/utlmaps_featured_image_map-c07ae2551145ff2e5f5fa3c71baa345d9d674a33b08f422449203cf9ed47e0d1.jpg\",\n          name: \"Image 2\",\n          regions: []\n        },\n        {\n          src:\"https://1igc0ojossa412h1e3ek8d1w-wpengine.netdna-ssl.com/wp-content/uploads/2018/03/TMSELEMWORLD.M.jpg\",\n          name: \"Image 3\",\n          regions: []\n        }\n      ],\n    }\n    this.props = props;\n    this.submitTask = this.submitTask.bind(this);\n    this.getSubmissionUrl = this.getSubmissionUrl.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.componentDidMount=this.componentDidMount(this);\n    // this.parsed = queryString.parse(this.props.location.search);\n\n  }\n  getTools(res){\n    console.log(\"get tool:\",res.Tools['enenabledTools'])\n\n  }\n//get data from api\n  componentDidMount() {\n    function getEnabledTools(data) {\n      const enabledTools =data[\"enabledTools\"]\n      var res=[]\n      for (var i = 0; i < enabledTools.length; i++) {\n        if (enabledTools[i][\"create point\"]==true){\n          res.push(\"create-point\")\n        }\n        else if (enabledTools[i][\"create rectangle\"]==true){\n          res.push(\"create-rectangle\")\n        }\n        else if(enabledTools[i][\"create polygon\"]==true){\n          res.push(\"create-polygon\")\n        }\n      }\n      return res\n\n    }\n\n    fetch(\"/api\",{ mode: 'cors'})\n        .then(res => res.json())\n        .then(\n            (result) => {\n              const enabledTools=getEnabledTools(result[\"setup\"])\n              this.setState({\n                isLoaded: true,\n                EnabledTools:enabledTools,\n                AllowComments:result[\"setup\"][\"allow-comments\"],\n                Tags:result[\"setup\"][\"tags\"]\n              });\n              console.log(\"res is: \", result)\n            },\n            // Note: it's important to handle errors here\n            // instead of a catch() block so that we don't swallow\n            // exceptions from actual bugs in components.\n            (error) => {\n              this.setState({\n                isLoaded: true,\n                error\n              });\n            }\n        )\n  }\n\n  parseParameters(url){\n    var params = {\n      'assignmentId' : null,\n      'hitId' : null,\n      'workerId' : null,\n      'turkSubmitTo' : null\n    };\n\n    var queryString = url.split('?')[1];\n\n    if (queryString){\n      var queryPieces = queryString.split('&');\n      for (var i = 0; i < queryPieces.length; ++i){\n        var pieces = queryPieces[i].split('=');\n        var paramName = pieces[0];\n        var paramValue = pieces[1];\n        if(paramName in params){\n          params[paramName] = paramValue;\n        }\n      }\n    }\n\n    return params;\n  }\n  hasAcceptedTask() {\n    let url = window.location.href;\n    let mturkParams = this.parseParameters(url);\n    const assignmentID =  mturkParams['assignmentId'];\n\n    if (assignmentID  === undefined)\n      return false;\n    return assignmentID !== \"ASSIGNMENT_ID_NOT_AVAILABLE\";\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const input = document.getElementById('submitButton');\n    input.setAttribute('value', JSON.stringify(this.state.imgData));\n    console.log(input);\n    const form = document.getElementById('submitForm');\n    HTMLFormElement.prototype.submit.call(form);\n    \n  }\n\n  submitTask(e) {\n    // e.preventDefault();\n    console.log(\"POSTing data\");\n    axios\n      .post(`${this.getSubmissionUrl()}`, {})\n      .then(function(response) {\n        console.log(response);\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n  }\n\n  getSubmissionUrl() {\n    let mturkParams = this.parseParameters(window.location.href);\n    const assignmentID =  mturkParams['assignmentId'];\n    const url = config[\"submit\"][env] + \"/?assignmentId=\" + assignmentID;\n    console.log(url);\n    return url;\n  }\n\n  render() {\n    const { error, isLoaded, EnabledTools, AllowComments, Tags, imgData} = this.state;\n    console.log(\"data is:\", this.state)\n    if (error) {\n      return <div>Error: {error.message}</div>;\n    } else if (!isLoaded) {\n      return <div>Loading...</div>;\n    } else {\n      return (\n          <div id=\"Submit\">\n\n            <form\n                id=\"submitForm\"\n                type=\"submit\"\n                method=\"POST\"\n                action={this.getSubmissionUrl()}\n            >\n              <AnnotationTool\n                  name=\"AnnotationTool\"\n                  type=\"submit\"\n                  ref={value => {\n                    this.value = value;\n                  }}\n                  images={imgData}\n                  // labelImages\n                  // annotationType={\"image\"}\n                  // function\n                  enabledTools={EnabledTools}\n                  regionTagList={Tags}\n                  // comments\n                  allowComments={AllowComments}\n                  onExit={output => {\n                    this.setState({imgData: output.images});\n                    console.log(JSON.stringify(output.images))\n                  }}\n\n              />\n              <div>\n                <Button variant=\"outline-dark\" size=\"lg\" block\n                        name=\"Annotation\"\n                        type=\"submit\"\n                        id=\"submitButton\"\n                        value={JSON.stringify(this.state.imgData)}\n                        ref={value => {\n                          this.value = value;\n                        }}\n                >Complete the HIT</Button>\n              </div>\n            </form>\n          </div>\n      );\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}