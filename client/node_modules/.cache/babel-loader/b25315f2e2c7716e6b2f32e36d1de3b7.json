{"ast":null,"code":"import _slicedToArray from \"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\src\\\\pages\\\\Home\\\\annotateComponents\\\\TransformBoxes\\\\main_TransformBoxes.js\";\n\nimport React, { Fragment, memo } from \"react\";\nimport { styled } from \"@material-ui/core/styles\";\nvar TransformMyStyles = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\"\n});\nvar boxCursorMap = [[\"nw-resize\", \"n-resize\", \"ne-resize\"], [\"w-resize\", \"grab\", \"e-resize\"], [\"sw-resize\", \"s-resize\", \"se-resize\"]];\n\nvar arePropsEqual = function arePropsEqual(prev, next) {\n  return prev.region === next.region && prev.dragWithPrimary === next.dragWithPrimary && prev.createWithPrimary === next.createWithPrimary && prev.zoomWithPrimary === next.zoomWithPrimary && prev.mat === next.mat;\n};\n\nexport var RegionSelectAndTransformBox = memo(function (_ref) {\n  var r = _ref.region,\n      mouseEvents = _ref.mouseEvents,\n      projectRegionBox = _ref.projectRegionBox,\n      dragWithPrimary = _ref.dragWithPrimary,\n      createWithPrimary = _ref.createWithPrimary,\n      zoomWithPrimary = _ref.zoomWithPrimary,\n      onBeginMovePoint = _ref.onBeginMovePoint,\n      onSelectRegion = _ref.onSelectRegion,\n      layoutParams = _ref.layoutParams,\n      mat = _ref.mat,\n      onBeginBoxTransform = _ref.onBeginBoxTransform,\n      onBeginMovePolygonPoint = _ref.onBeginMovePolygonPoint,\n      onBeginMovePolygon1Point = _ref.onBeginMovePolygon1Point,\n      onBeginMoveKeypoint = _ref.onBeginMoveKeypoint,\n      onAddPolygonPoint = _ref.onAddPolygonPoint,\n      onAddPolygon1Point = _ref.onAddPolygon1Point,\n      onBeginCircleTransform = _ref.onBeginCircleTransform;\n  var pbox = projectRegionBox(r);\n  var _layoutParams$current = layoutParams.current,\n      iw = _layoutParams$current.iw,\n      ih = _layoutParams$current.ih;\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }\n  }, r.type === \"rectangle\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && mat.a < 1.2 && [[0, 0], [0.5, 0], [1, 0], [1, 0.5], [1, 1], [0.5, 1], [0, 1], [0, 0.5], [0.5, 0.5]].map(function (_ref2, i) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        px = _ref3[0],\n        py = _ref3[1];\n\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: function onMouseDown(e) {\n        if (e.button === 0) return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1]);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        left: pbox.x - 4 - 2 + pbox.w * px,\n        top: pbox.y - 4 - 2 + pbox.h * py,\n        cursor: boxCursorMap[py * 2][px * 2],\n        borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 15\n      }\n    }));\n  }), r.type === \"circle\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && [[r.x, r.y], [(r.x * iw + Math.sqrt(Math.pow((r.xr - r.x) * iw, 2) + Math.pow((r.yr - r.y) * ih, 2))) / iw, r.y], [r.x, (r.y * ih + Math.sqrt(Math.pow((r.xr - r.x) * iw, 2) + Math.pow((r.yr - r.y) * ih, 2))) / ih], [(r.x * iw - Math.sqrt(Math.pow((r.xr - r.x) * iw, 2) + Math.pow((r.yr - r.y) * ih, 2))) / iw, r.y], [r.x, (r.y * ih - Math.sqrt(Math.pow((r.xr - r.x) * iw, 2) + Math.pow((r.yr - r.y) * ih, 2))) / ih]].map(function (_ref4, i) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        px = _ref5[0],\n        py = _ref5[1];\n\n    var proj = mat.clone().inverse().applyToPoint(px * iw, py * ih);\n    return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n      key: i // className={classes.transformGrabber}\n\n    }, mouseEvents, {\n      onMouseDown: function onMouseDown(e) {\n        if (e.button === 0 && i == 0) {\n          return onBeginCircleTransform(r, \"MOVE_REGION\");\n        } else if (e.button === 0 && i != 0) {\n          return onBeginCircleTransform(r, \"RESIZE_CIRCLE\");\n        }\n\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        left: proj.x - 4,\n        top: proj.y - 4,\n        borderRadius: px === r.x && py === r.y ? 4 : undefined\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 25\n      }\n    }));\n  }), r.type === \"polygon\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && r.points.map(function (_ref6, i) {\n    var _ref7 = _slicedToArray(_ref6, 2),\n        px = _ref7[0],\n        py = _ref7[1];\n\n    var proj = mat.clone().inverse().applyToPoint(px * iw, py * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: function onMouseDown(e) {\n        if (e.button === 0 && (!r.open || i === 0)) return onBeginMovePolygonPoint(r, i);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n        zIndex: 10,\n        pointerEvents: r.open && i === r.points.length - 1 ? \"none\" : undefined,\n        left: proj.x - 4,\n        top: proj.y - 4\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }\n    }));\n  }), r.type === \"polygon1\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && r.points.map(function (_ref8, i) {\n    var _ref9 = _slicedToArray(_ref8, 2),\n        px = _ref9[0],\n        py = _ref9[1];\n\n    var proj = mat.clone().inverse().applyToPoint(px * iw, py * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: function onMouseDown(e) {\n        if (e.button === 0 && (!r.open || i === 0)) return onBeginMovePolygon1Point(r, i);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n        zIndex: 10,\n        pointerEvents: r.open && i === r.points.length - 1 ? \"none\" : undefined,\n        left: proj.x - 4,\n        top: proj.y - 4\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 21\n      }\n    }));\n  }), r.type === \"polygon\" && r.highlighted && !dragWithPrimary && !zoomWithPrimary && !r.locked && !r.open && r.points.length > 1 && r.points.map(function (p1, i) {\n    return [p1, r.points[(i + 1) % r.points.length]];\n  }).map(function (_ref10) {\n    var _ref11 = _slicedToArray(_ref10, 2),\n        p1 = _ref11[0],\n        p2 = _ref11[1];\n\n    return [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2];\n  }).map(function (pa, i) {\n    var proj = mat.clone().inverse().applyToPoint(pa[0] * iw, pa[1] * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: function onMouseDown(e) {\n        if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: \"copy\",\n        zIndex: 10,\n        left: proj.x - 4,\n        top: proj.y - 4,\n        border: \"2px dotted #fff\",\n        opacity: 0.5\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 19\n      }\n    }));\n  }), r.type === \"polygon1\" && r.highlighted && !dragWithPrimary && !zoomWithPrimary && !r.locked && !r.open && r.points.length > 1 && r.points.map(function (p1, i) {\n    return [p1, r.points[(i + 1) % r.points.length]];\n  }).map(function (_ref12) {\n    var _ref13 = _slicedToArray(_ref12, 2),\n        p1 = _ref13[0],\n        p2 = _ref13[1];\n\n    return [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2];\n  }).map(function (pa, i) {\n    var proj = mat.clone().inverse().applyToPoint(pa[0] * iw, pa[1] * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: function onMouseDown(e) {\n        if (e.button === 0) return onAddPolygon1Point(r, pa, i + 1);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: \"copy\",\n        zIndex: 10,\n        left: proj.x - 4,\n        top: proj.y - 4,\n        border: \"2px dotted #fff\",\n        opacity: 0.5\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 25\n      }\n    }));\n  })));\n}, arePropsEqual);\nexport var RegionSelectAndTransformBoxes = memo(function (props) {\n  return props.regions.filter(function (r) {\n    return r.visible || r.visible === undefined;\n  }).filter(function (r) {\n    return !r.locked;\n  }).map(function (r, i) {\n    return /*#__PURE__*/React.createElement(RegionSelectAndTransformBox, Object.assign({\n      key: r.id\n    }, props, {\n      region: r,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 16\n      }\n    }));\n  });\n}, function (n, p) {\n  return n.regions === p.regions && n.mat === p.mat;\n});\nexport default RegionSelectAndTransformBoxes;","map":{"version":3,"sources":["D:/GitHub/ML4GIS/client/src/pages/Home/annotateComponents/TransformBoxes/main_TransformBoxes.js"],"names":["React","Fragment","memo","styled","TransformMyStyles","width","height","zIndex","border","position","boxCursorMap","arePropsEqual","prev","next","region","dragWithPrimary","createWithPrimary","zoomWithPrimary","mat","RegionSelectAndTransformBox","r","mouseEvents","projectRegionBox","onBeginMovePoint","onSelectRegion","layoutParams","onBeginBoxTransform","onBeginMovePolygonPoint","onBeginMovePolygon1Point","onBeginMoveKeypoint","onAddPolygonPoint","onAddPolygon1Point","onBeginCircleTransform","pbox","current","iw","ih","type","locked","highlighted","a","map","i","px","py","e","button","onMouseDown","left","x","w","top","y","h","cursor","borderRadius","undefined","Math","sqrt","pow","xr","yr","proj","clone","inverse","applyToPoint","points","open","pointerEvents","length","p1","p2","pa","opacity","RegionSelectAndTransformBoxes","props","regions","filter","visible","id","n","p"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,IAA1B,QAAsC,OAAtC;AACA,SAASC,MAAT,QAAuB,0BAAvB;AAEA,IAAMC,iBAAiB,GAAGD,MAAM,CAAC,KAAD,CAAN,CAAc;AACtCE,EAAAA,KAAK,EAAE,CAD+B;AAEtCC,EAAAA,MAAM,EAAE,CAF8B;AAGtCC,EAAAA,MAAM,EAAE,CAH8B;AAItCC,EAAAA,MAAM,EAAE,gBAJ8B;AAKtCC,EAAAA,QAAQ,EAAE;AAL4B,CAAd,CAA1B;AAQA,IAAMC,YAAY,GAAG,CACnB,CAAC,WAAD,EAAc,UAAd,EAA0B,WAA1B,CADmB,EAEnB,CAAC,UAAD,EAAa,MAAb,EAAqB,UAArB,CAFmB,EAGnB,CAAC,WAAD,EAAc,UAAd,EAA0B,WAA1B,CAHmB,CAArB;;AAMA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAAOC,IAAP,EAAgB;AACpC,SACED,IAAI,CAACE,MAAL,KAAgBD,IAAI,CAACC,MAArB,IACAF,IAAI,CAACG,eAAL,KAAyBF,IAAI,CAACE,eAD9B,IAEAH,IAAI,CAACI,iBAAL,KAA2BH,IAAI,CAACG,iBAFhC,IAGAJ,IAAI,CAACK,eAAL,KAAyBJ,IAAI,CAACI,eAH9B,IAIAL,IAAI,CAACM,GAAL,KAAaL,IAAI,CAACK,GALpB;AAOD,CARD;;AAUA,OAAO,IAAMC,2BAA2B,GAAGjB,IAAI,CAC7C,gBAkBM;AAAA,MAjBIkB,CAiBJ,QAjBJN,MAiBI;AAAA,MAhBJO,WAgBI,QAhBJA,WAgBI;AAAA,MAfJC,gBAeI,QAfJA,gBAeI;AAAA,MAdJP,eAcI,QAdJA,eAcI;AAAA,MAbJC,iBAaI,QAbJA,iBAaI;AAAA,MAZJC,eAYI,QAZJA,eAYI;AAAA,MAXJM,gBAWI,QAXJA,gBAWI;AAAA,MAVJC,cAUI,QAVJA,cAUI;AAAA,MATJC,YASI,QATJA,YASI;AAAA,MARJP,GAQI,QARJA,GAQI;AAAA,MAPJQ,mBAOI,QAPJA,mBAOI;AAAA,MANJC,uBAMI,QANJA,uBAMI;AAAA,MALDC,wBAKC,QALDA,wBAKC;AAAA,MAJJC,mBAII,QAJJA,mBAII;AAAA,MAHJC,iBAGI,QAHJA,iBAGI;AAAA,MAFDC,kBAEC,QAFDA,kBAEC;AAAA,MADDC,sBACC,QADDA,sBACC;AACJ,MAAMC,IAAI,GAAGX,gBAAgB,CAACF,CAAD,CAA7B;AADI,8BAEeK,YAAY,CAACS,OAF5B;AAAA,MAEIC,EAFJ,yBAEIA,EAFJ;AAAA,MAEQC,EAFR,yBAEQA,EAFR;AAGJ,sBACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGhB,CAAC,CAACiB,IAAF,KAAW,WAAX,IACC,CAACtB,eADF,IAEC,CAACE,eAFF,IAGC,CAACG,CAAC,CAACkB,MAHJ,IAIClB,CAAC,CAACmB,WAJH,IAKCrB,GAAG,CAACsB,CAAJ,GAAQ,GALT,IAMC,CACE,CAAC,CAAD,EAAI,CAAJ,CADF,EAEE,CAAC,GAAD,EAAM,CAAN,CAFF,EAGE,CAAC,CAAD,EAAI,CAAJ,CAHF,EAIE,CAAC,CAAD,EAAI,GAAJ,CAJF,EAKE,CAAC,CAAD,EAAI,CAAJ,CALF,EAME,CAAC,GAAD,EAAM,CAAN,CANF,EAOE,CAAC,CAAD,EAAI,CAAJ,CAPF,EAQE,CAAC,CAAD,EAAI,GAAJ,CARF,EASE,CAAC,GAAD,EAAM,GAAN,CATF,EAUEC,GAVF,CAUM,iBAAWC,CAAX;AAAA;AAAA,QAAEC,EAAF;AAAA,QAAMC,EAAN;;AAAA,wBACJ,oBAAC,iBAAD;AACE,MAAA,GAAG,EAAEF;AADP,OAEMrB,WAFN;AAGE,MAAA,WAAW,EAAE,qBAACwB,CAAD,EAAO;AAClB,YAAIA,CAAC,CAACC,MAAF,KAAa,CAAjB,EACE,OAAOpB,mBAAmB,CAACN,CAAD,EAAI,CAACuB,EAAE,GAAG,CAAL,GAAS,CAAV,EAAaC,EAAE,GAAG,CAAL,GAAS,CAAtB,CAAJ,CAA1B;AACFvB,QAAAA,WAAW,CAAC0B,WAAZ,CAAwBF,CAAxB;AACD,OAPH;AAQE,MAAA,KAAK,EAAE;AACLG,QAAAA,IAAI,EAAEf,IAAI,CAACgB,CAAL,GAAS,CAAT,GAAa,CAAb,GAAiBhB,IAAI,CAACiB,CAAL,GAASP,EAD3B;AAELQ,QAAAA,GAAG,EAAElB,IAAI,CAACmB,CAAL,GAAS,CAAT,GAAa,CAAb,GAAiBnB,IAAI,CAACoB,CAAL,GAAST,EAF1B;AAGLU,QAAAA,MAAM,EAAE5C,YAAY,CAACkC,EAAE,GAAG,CAAN,CAAZ,CAAqBD,EAAE,GAAG,CAA1B,CAHH;AAILY,QAAAA,YAAY,EAAEZ,EAAE,KAAK,GAAP,IAAcC,EAAE,KAAK,GAArB,GAA2B,CAA3B,GAA+BY;AAJxC,OART;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADI;AAAA,GAVN,CAPJ,EAmCQpC,CAAC,CAACiB,IAAF,KAAW,QAAX,IACA,CAACtB,eADD,IAEA,CAACE,eAFD,IAGA,CAACG,CAAC,CAACkB,MAHH,IAIAlB,CAAC,CAACmB,WAJF,IAKA,CACI,CAACnB,CAAC,CAAC6B,CAAH,EAAM7B,CAAC,CAACgC,CAAR,CADJ,EAEI,CAAC,CAAChC,CAAC,CAAC6B,CAAF,GAAId,EAAJ,GAASsB,IAAI,CAACC,IAAL,CAAUD,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACwC,EAAF,GAAKxC,CAAC,CAAC6B,CAAR,IAAWd,EAApB,EAAuB,CAAvB,IAA4BsB,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACyC,EAAF,GAAKzC,CAAC,CAACgC,CAAR,IAAWhB,EAApB,EAAuB,CAAvB,CAAtC,CAAV,IAA4ED,EAA7E,EAAiFf,CAAC,CAACgC,CAAnF,CAFJ,EAGI,CAAChC,CAAC,CAAC6B,CAAH,EAAM,CAAC7B,CAAC,CAACgC,CAAF,GAAIhB,EAAJ,GAASqB,IAAI,CAACC,IAAL,CAAUD,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACwC,EAAF,GAAKxC,CAAC,CAAC6B,CAAR,IAAWd,EAApB,EAAuB,CAAvB,IAA4BsB,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACyC,EAAF,GAAKzC,CAAC,CAACgC,CAAR,IAAWhB,EAApB,EAAuB,CAAvB,CAAtC,CAAV,IAA4EA,EAAlF,CAHJ,EAII,CAAC,CAAChB,CAAC,CAAC6B,CAAF,GAAId,EAAJ,GAASsB,IAAI,CAACC,IAAL,CAAUD,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACwC,EAAF,GAAKxC,CAAC,CAAC6B,CAAR,IAAWd,EAApB,EAAuB,CAAvB,IAA4BsB,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACyC,EAAF,GAAKzC,CAAC,CAACgC,CAAR,IAAWhB,EAApB,EAAuB,CAAvB,CAAtC,CAAV,IAA4ED,EAA7E,EAAiFf,CAAC,CAACgC,CAAnF,CAJJ,EAKI,CAAChC,CAAC,CAAC6B,CAAH,EAAM,CAAC7B,CAAC,CAACgC,CAAF,GAAIhB,EAAJ,GAASqB,IAAI,CAACC,IAAL,CAAUD,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACwC,EAAF,GAAKxC,CAAC,CAAC6B,CAAR,IAAWd,EAApB,EAAuB,CAAvB,IAA4BsB,IAAI,CAACE,GAAL,CAAS,CAACvC,CAAC,CAACyC,EAAF,GAAKzC,CAAC,CAACgC,CAAR,IAAWhB,EAApB,EAAuB,CAAvB,CAAtC,CAAV,IAA4EA,EAAlF,CALJ,EAMEK,GANF,CAMM,iBAAWC,CAAX,EAAiB;AAAA;AAAA,QAAfC,EAAe;AAAA,QAAXC,EAAW;;AACnB,QAAMkB,IAAI,GAAG5C,GAAG,CACX6C,KADQ,GAERC,OAFQ,GAGRC,YAHQ,CAGKtB,EAAE,GAAGR,EAHV,EAGcS,EAAE,GAAGR,EAHnB,CAAb;AAIA,wBACI;AACI,MAAA,GAAG,EAAEM,CADT,CAEI;;AAFJ,OAGQrB,WAHR;AAII,MAAA,WAAW,EAAE,qBAAAwB,CAAC,EAAI;AACd,YAAIA,CAAC,CAACC,MAAF,KAAa,CAAb,IAAkBJ,CAAC,IAAE,CAAzB,EAA2B;AACvB,iBAAOV,sBAAsB,CAACZ,CAAD,EAAI,aAAJ,CAA7B;AACH,SAFD,MAEM,IAAGyB,CAAC,CAACC,MAAF,KAAa,CAAb,IAAkBJ,CAAC,IAAE,CAAxB,EAA0B;AAC5B,iBAAOV,sBAAsB,CAACZ,CAAD,EAAI,eAAJ,CAA7B;AACH;;AACDC,QAAAA,WAAW,CAAC0B,WAAZ,CAAwBF,CAAxB;AACH,OAXL;AAYI,MAAA,KAAK,EAAE;AACHG,QAAAA,IAAI,EAAEc,IAAI,CAACb,CAAL,GAAS,CADZ;AAEHE,QAAAA,GAAG,EAAEW,IAAI,CAACV,CAAL,GAAS,CAFX;AAGHG,QAAAA,YAAY,EAAEZ,EAAE,KAAKvB,CAAC,CAAC6B,CAAT,IAAcL,EAAE,KAAKxB,CAAC,CAACgC,CAAvB,GAA2B,CAA3B,GAA+BI;AAH1C,OAZX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADJ;AAoBH,GA/BD,CAxCR,EAyEGpC,CAAC,CAACiB,IAAF,KAAW,SAAX,IACC,CAACtB,eADF,IAEC,CAACE,eAFF,IAGC,CAACG,CAAC,CAACkB,MAHJ,IAIClB,CAAC,CAACmB,WAJH,IAKCnB,CAAC,CAAC8C,MAAF,CAASzB,GAAT,CAAa,iBAAWC,CAAX,EAAiB;AAAA;AAAA,QAAfC,EAAe;AAAA,QAAXC,EAAW;;AAC5B,QAAMkB,IAAI,GAAG5C,GAAG,CACb6C,KADU,GAEVC,OAFU,GAGVC,YAHU,CAGGtB,EAAE,GAAGR,EAHR,EAGYS,EAAE,GAAGR,EAHjB,CAAb;AAIA,wBACE,oBAAC,iBAAD;AACE,MAAA,GAAG,EAAEM;AADP,OAEMrB,WAFN;AAGE,MAAA,WAAW,EAAE,qBAACwB,CAAD,EAAO;AAClB,YAAIA,CAAC,CAACC,MAAF,KAAa,CAAb,KAAmB,CAAC1B,CAAC,CAAC+C,IAAH,IAAWzB,CAAC,KAAK,CAApC,CAAJ,EACE,OAAOf,uBAAuB,CAACP,CAAD,EAAIsB,CAAJ,CAA9B;AACFrB,QAAAA,WAAW,CAAC0B,WAAZ,CAAwBF,CAAxB;AACD,OAPH;AAQE,MAAA,KAAK,EAAE;AACLS,QAAAA,MAAM,EAAE,CAAClC,CAAC,CAAC+C,IAAH,GAAU,MAAV,GAAmBzB,CAAC,KAAK,CAAN,GAAU,SAAV,GAAsBc,SAD5C;AAELjD,QAAAA,MAAM,EAAE,EAFH;AAGL6D,QAAAA,aAAa,EACXhD,CAAC,CAAC+C,IAAF,IAAUzB,CAAC,KAAKtB,CAAC,CAAC8C,MAAF,CAASG,MAAT,GAAkB,CAAlC,GAAsC,MAAtC,GAA+Cb,SAJ5C;AAKLR,QAAAA,IAAI,EAAEc,IAAI,CAACb,CAAL,GAAS,CALV;AAMLE,QAAAA,GAAG,EAAEW,IAAI,CAACV,CAAL,GAAS;AANT,OART;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADF;AAmBD,GAxBD,CA9EJ,EAuGKhC,CAAC,CAACiB,IAAF,KAAW,UAAX,IACD,CAACtB,eADA,IAED,CAACE,eAFA,IAGD,CAACG,CAAC,CAACkB,MAHF,IAIDlB,CAAC,CAACmB,WAJD,IAKDnB,CAAC,CAAC8C,MAAF,CAASzB,GAAT,CAAa,iBAAWC,CAAX,EAAiB;AAAA;AAAA,QAAfC,EAAe;AAAA,QAAXC,EAAW;;AAC1B,QAAMkB,IAAI,GAAG5C,GAAG,CACX6C,KADQ,GAERC,OAFQ,GAGRC,YAHQ,CAGKtB,EAAE,GAAGR,EAHV,EAGcS,EAAE,GAAGR,EAHnB,CAAb;AAIA,wBACI,oBAAC,iBAAD;AACI,MAAA,GAAG,EAAEM;AADT,OAEQrB,WAFR;AAGI,MAAA,WAAW,EAAE,qBAACwB,CAAD,EAAO;AAChB,YAAIA,CAAC,CAACC,MAAF,KAAa,CAAb,KAAmB,CAAC1B,CAAC,CAAC+C,IAAH,IAAWzB,CAAC,KAAK,CAApC,CAAJ,EACI,OAAOd,wBAAwB,CAACR,CAAD,EAAIsB,CAAJ,CAA/B;AACJrB,QAAAA,WAAW,CAAC0B,WAAZ,CAAwBF,CAAxB;AACH,OAPL;AAQI,MAAA,KAAK,EAAE;AACHS,QAAAA,MAAM,EAAE,CAAClC,CAAC,CAAC+C,IAAH,GAAU,MAAV,GAAmBzB,CAAC,KAAK,CAAN,GAAU,SAAV,GAAsBc,SAD9C;AAEHjD,QAAAA,MAAM,EAAE,EAFL;AAGH6D,QAAAA,aAAa,EACThD,CAAC,CAAC+C,IAAF,IAAUzB,CAAC,KAAKtB,CAAC,CAAC8C,MAAF,CAASG,MAAT,GAAkB,CAAlC,GAAsC,MAAtC,GAA+Cb,SAJhD;AAKHR,QAAAA,IAAI,EAAEc,IAAI,CAACb,CAAL,GAAS,CALZ;AAMHE,QAAAA,GAAG,EAAEW,IAAI,CAACV,CAAL,GAAS;AANX,OARX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADJ;AAmBH,GAxBD,CA5GJ,EAqIGhC,CAAC,CAACiB,IAAF,KAAW,SAAX,IACCjB,CAAC,CAACmB,WADH,IAEC,CAACxB,eAFF,IAGC,CAACE,eAHF,IAIC,CAACG,CAAC,CAACkB,MAJJ,IAKC,CAAClB,CAAC,CAAC+C,IALJ,IAMC/C,CAAC,CAAC8C,MAAF,CAASG,MAAT,GAAkB,CANnB,IAOCjD,CAAC,CAAC8C,MAAF,CACGzB,GADH,CACO,UAAC6B,EAAD,EAAK5B,CAAL;AAAA,WAAW,CAAC4B,EAAD,EAAKlD,CAAC,CAAC8C,MAAF,CAAS,CAACxB,CAAC,GAAG,CAAL,IAAUtB,CAAC,CAAC8C,MAAF,CAASG,MAA5B,CAAL,CAAX;AAAA,GADP,EAEG5B,GAFH,CAEO;AAAA;AAAA,QAAE6B,EAAF;AAAA,QAAMC,EAAN;;AAAA,WAAc,CAAC,CAACD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAX,IAAkB,CAAnB,EAAsB,CAACD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAX,IAAkB,CAAxC,CAAd;AAAA,GAFP,EAGG9B,GAHH,CAGO,UAAC+B,EAAD,EAAK9B,CAAL,EAAW;AACd,QAAMoB,IAAI,GAAG5C,GAAG,CACb6C,KADU,GAEVC,OAFU,GAGVC,YAHU,CAGGO,EAAE,CAAC,CAAD,CAAF,GAAQrC,EAHX,EAGeqC,EAAE,CAAC,CAAD,CAAF,GAAQpC,EAHvB,CAAb;AAIA,wBACE,oBAAC,iBAAD;AACE,MAAA,GAAG,EAAEM;AADP,OAEMrB,WAFN;AAGE,MAAA,WAAW,EAAE,qBAACwB,CAAD,EAAO;AAClB,YAAIA,CAAC,CAACC,MAAF,KAAa,CAAjB,EAAoB,OAAOhB,iBAAiB,CAACV,CAAD,EAAIoD,EAAJ,EAAQ9B,CAAC,GAAG,CAAZ,CAAxB;AACpBrB,QAAAA,WAAW,CAAC0B,WAAZ,CAAwBF,CAAxB;AACD,OANH;AAOE,MAAA,KAAK,EAAE;AACLS,QAAAA,MAAM,EAAE,MADH;AAEL/C,QAAAA,MAAM,EAAE,EAFH;AAGLyC,QAAAA,IAAI,EAAEc,IAAI,CAACb,CAAL,GAAS,CAHV;AAILE,QAAAA,GAAG,EAAEW,IAAI,CAACV,CAAL,GAAS,CAJT;AAKL5C,QAAAA,MAAM,EAAE,iBALH;AAMLiE,QAAAA,OAAO,EAAE;AANJ,OAPT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADF;AAkBD,GA1BH,CA5IJ,EAuKKrD,CAAC,CAACiB,IAAF,KAAW,UAAX,IACDjB,CAAC,CAACmB,WADD,IAED,CAACxB,eAFA,IAGD,CAACE,eAHA,IAID,CAACG,CAAC,CAACkB,MAJF,IAKD,CAAClB,CAAC,CAAC+C,IALF,IAMD/C,CAAC,CAAC8C,MAAF,CAASG,MAAT,GAAkB,CANjB,IAODjD,CAAC,CAAC8C,MAAF,CACKzB,GADL,CACS,UAAC6B,EAAD,EAAK5B,CAAL;AAAA,WAAW,CAAC4B,EAAD,EAAKlD,CAAC,CAAC8C,MAAF,CAAS,CAACxB,CAAC,GAAG,CAAL,IAAUtB,CAAC,CAAC8C,MAAF,CAASG,MAA5B,CAAL,CAAX;AAAA,GADT,EAEK5B,GAFL,CAES;AAAA;AAAA,QAAE6B,EAAF;AAAA,QAAMC,EAAN;;AAAA,WAAc,CAAC,CAACD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAX,IAAkB,CAAnB,EAAsB,CAACD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAX,IAAkB,CAAxC,CAAd;AAAA,GAFT,EAGK9B,GAHL,CAGS,UAAC+B,EAAD,EAAK9B,CAAL,EAAW;AACZ,QAAMoB,IAAI,GAAG5C,GAAG,CACX6C,KADQ,GAERC,OAFQ,GAGRC,YAHQ,CAGKO,EAAE,CAAC,CAAD,CAAF,GAAQrC,EAHb,EAGiBqC,EAAE,CAAC,CAAD,CAAF,GAAQpC,EAHzB,CAAb;AAIA,wBACI,oBAAC,iBAAD;AACI,MAAA,GAAG,EAAEM;AADT,OAEQrB,WAFR;AAGI,MAAA,WAAW,EAAE,qBAACwB,CAAD,EAAO;AAChB,YAAIA,CAAC,CAACC,MAAF,KAAa,CAAjB,EAAoB,OAAOf,kBAAkB,CAACX,CAAD,EAAIoD,EAAJ,EAAQ9B,CAAC,GAAG,CAAZ,CAAzB;AACpBrB,QAAAA,WAAW,CAAC0B,WAAZ,CAAwBF,CAAxB;AACH,OANL;AAOI,MAAA,KAAK,EAAE;AACHS,QAAAA,MAAM,EAAE,MADL;AAEH/C,QAAAA,MAAM,EAAE,EAFL;AAGHyC,QAAAA,IAAI,EAAEc,IAAI,CAACb,CAAL,GAAS,CAHZ;AAIHE,QAAAA,GAAG,EAAEW,IAAI,CAACV,CAAL,GAAS,CAJX;AAKH5C,QAAAA,MAAM,EAAE,iBALL;AAMHiE,QAAAA,OAAO,EAAE;AANN,OAPX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADJ;AAkBH,GA1BL,CA9KJ,CADF,CADF;AA8MD,CApO4C,EAqO7C9D,aArO6C,CAAxC;AAwOP,OAAO,IAAM+D,6BAA6B,GAAGxE,IAAI,CAC/C,UAACyE,KAAD,EAAW;AACT,SAAOA,KAAK,CAACC,OAAN,CACJC,MADI,CACG,UAACzD,CAAD;AAAA,WAAOA,CAAC,CAAC0D,OAAF,IAAa1D,CAAC,CAAC0D,OAAF,KAActB,SAAlC;AAAA,GADH,EAEJqB,MAFI,CAEG,UAACzD,CAAD;AAAA,WAAO,CAACA,CAAC,CAACkB,MAAV;AAAA,GAFH,EAGJG,GAHI,CAGA,UAACrB,CAAD,EAAIsB,CAAJ,EAAU;AACb,wBAAO,oBAAC,2BAAD;AAA6B,MAAA,GAAG,EAAEtB,CAAC,CAAC2D;AAApC,OAA4CJ,KAA5C;AAAmD,MAAA,MAAM,EAAEvD,CAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAP;AACD,GALI,CAAP;AAMD,CAR8C,EAS/C,UAAC4D,CAAD,EAAIC,CAAJ;AAAA,SAAUD,CAAC,CAACJ,OAAF,KAAcK,CAAC,CAACL,OAAhB,IAA2BI,CAAC,CAAC9D,GAAF,KAAU+D,CAAC,CAAC/D,GAAjD;AAAA,CAT+C,CAA1C;AAYP,eAAewD,6BAAf","sourcesContent":["import React, { Fragment, memo } from \"react\"\r\nimport { styled } from \"@material-ui/core/styles\"\r\n\r\nconst TransformMyStyles = styled(\"div\")({\r\n  width: 8,\r\n  height: 8,\r\n  zIndex: 2,\r\n  border: \"2px solid #FFF\",\r\n  position: \"absolute\",\r\n})\r\n\r\nconst boxCursorMap = [\r\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\r\n  [\"w-resize\", \"grab\", \"e-resize\"],\r\n  [\"sw-resize\", \"s-resize\", \"se-resize\"],\r\n]\r\n\r\nconst arePropsEqual = (prev, next) => {\r\n  return (\r\n    prev.region === next.region &&\r\n    prev.dragWithPrimary === next.dragWithPrimary &&\r\n    prev.createWithPrimary === next.createWithPrimary &&\r\n    prev.zoomWithPrimary === next.zoomWithPrimary &&\r\n    prev.mat === next.mat\r\n  )\r\n}\r\n\r\nexport const RegionSelectAndTransformBox = memo(\r\n  ({\r\n    region: r,\r\n    mouseEvents,\r\n    projectRegionBox,\r\n    dragWithPrimary,\r\n    createWithPrimary,\r\n    zoomWithPrimary,\r\n    onBeginMovePoint,\r\n    onSelectRegion,\r\n    layoutParams,\r\n    mat,\r\n    onBeginBoxTransform,\r\n    onBeginMovePolygonPoint,\r\n       onBeginMovePolygon1Point,\r\n    onBeginMoveKeypoint,\r\n    onAddPolygonPoint,\r\n       onAddPolygon1Point,\r\n       onBeginCircleTransform\r\n  }) => {\r\n    const pbox = projectRegionBox(r)\r\n    const { iw, ih } = layoutParams.current\r\n    return (\r\n      <Fragment>\r\n        <div>\r\n          {r.type === \"rectangle\" &&\r\n            !dragWithPrimary &&\r\n            !zoomWithPrimary &&\r\n            !r.locked &&\r\n            r.highlighted &&\r\n            mat.a < 1.2 &&\r\n            [\r\n              [0, 0],\r\n              [0.5, 0],\r\n              [1, 0],\r\n              [1, 0.5],\r\n              [1, 1],\r\n              [0.5, 1],\r\n              [0, 1],\r\n              [0, 0.5],\r\n              [0.5, 0.5],\r\n            ].map(([px, py], i) => (\r\n              <TransformMyStyles\r\n                key={i}\r\n                {...mouseEvents}\r\n                onMouseDown={(e) => {\r\n                  if (e.button === 0)\r\n                    return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\r\n                  mouseEvents.onMouseDown(e)\r\n                }}\r\n                style={{\r\n                  left: pbox.x - 4 - 2 + pbox.w * px,\r\n                  top: pbox.y - 4 - 2 + pbox.h * py,\r\n                  cursor: boxCursorMap[py * 2][px * 2],\r\n                  borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined,\r\n                }}\r\n              />\r\n            ))}\r\n            {\r\n                r.type === \"circle\" &&\r\n                !dragWithPrimary &&\r\n                !zoomWithPrimary &&\r\n                !r.locked &&\r\n                r.highlighted &&\r\n                [\r\n                    [r.x, r.y],\r\n                    [(r.x*iw + Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/iw, r.y],\r\n                    [r.x, (r.y*ih + Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/ih],\r\n                    [(r.x*iw - Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/iw, r.y],\r\n                    [r.x, (r.y*ih - Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/ih]\r\n                ].map(([px, py], i) => {\r\n                    const proj = mat\r\n                        .clone()\r\n                        .inverse()\r\n                        .applyToPoint(px * iw, py * ih)\r\n                    return(\r\n                        <div\r\n                            key={i}\r\n                            // className={classes.transformGrabber}\r\n                            {...mouseEvents}\r\n                            onMouseDown={e => {\r\n                                if (e.button === 0 && i==0){\r\n                                    return onBeginCircleTransform(r, \"MOVE_REGION\")\r\n                                }else if(e.button === 0 && i!=0){\r\n                                    return onBeginCircleTransform(r, \"RESIZE_CIRCLE\")\r\n                                }\r\n                                mouseEvents.onMouseDown(e)\r\n                            }}\r\n                            style={{\r\n                                left: proj.x - 4,\r\n                                top: proj.y - 4,\r\n                                borderRadius: px === r.x && py === r.y ? 4 : undefined\r\n                            }}\r\n                        />\r\n                    )\r\n                })\r\n            }\r\n          {r.type === \"polygon\" &&\r\n            !dragWithPrimary &&\r\n            !zoomWithPrimary &&\r\n            !r.locked &&\r\n            r.highlighted &&\r\n            r.points.map(([px, py], i) => {\r\n              const proj = mat\r\n                .clone()\r\n                .inverse()\r\n                .applyToPoint(px * iw, py * ih)\r\n              return (\r\n                <TransformMyStyles\r\n                  key={i}\r\n                  {...mouseEvents}\r\n                  onMouseDown={(e) => {\r\n                    if (e.button === 0 && (!r.open || i === 0))\r\n                      return onBeginMovePolygonPoint(r, i)\r\n                    mouseEvents.onMouseDown(e)\r\n                  }}\r\n                  style={{\r\n                    cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\r\n                    zIndex: 10,\r\n                    pointerEvents:\r\n                      r.open && i === r.points.length - 1 ? \"none\" : undefined,\r\n                    left: proj.x - 4,\r\n                    top: proj.y - 4,\r\n                  }}\r\n                />\r\n              )\r\n            })}\r\n            {r.type === \"polygon1\" &&\r\n            !dragWithPrimary &&\r\n            !zoomWithPrimary &&\r\n            !r.locked &&\r\n            r.highlighted &&\r\n            r.points.map(([px, py], i) => {\r\n                const proj = mat\r\n                    .clone()\r\n                    .inverse()\r\n                    .applyToPoint(px * iw, py * ih)\r\n                return (\r\n                    <TransformMyStyles\r\n                        key={i}\r\n                        {...mouseEvents}\r\n                        onMouseDown={(e) => {\r\n                            if (e.button === 0 && (!r.open || i === 0))\r\n                                return onBeginMovePolygon1Point(r, i)\r\n                            mouseEvents.onMouseDown(e)\r\n                        }}\r\n                        style={{\r\n                            cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\r\n                            zIndex: 10,\r\n                            pointerEvents:\r\n                                r.open && i === r.points.length - 1 ? \"none\" : undefined,\r\n                            left: proj.x - 4,\r\n                            top: proj.y - 4,\r\n                        }}\r\n                    />\r\n                )\r\n            })}\r\n          {r.type === \"polygon\" &&\r\n            r.highlighted &&\r\n            !dragWithPrimary &&\r\n            !zoomWithPrimary &&\r\n            !r.locked &&\r\n            !r.open &&\r\n            r.points.length > 1 &&\r\n            r.points\r\n              .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\r\n              .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\r\n              .map((pa, i) => {\r\n                const proj = mat\r\n                  .clone()\r\n                  .inverse()\r\n                  .applyToPoint(pa[0] * iw, pa[1] * ih)\r\n                return (\r\n                  <TransformMyStyles\r\n                    key={i}\r\n                    {...mouseEvents}\r\n                    onMouseDown={(e) => {\r\n                      if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\r\n                      mouseEvents.onMouseDown(e)\r\n                    }}\r\n                    style={{\r\n                      cursor: \"copy\",\r\n                      zIndex: 10,\r\n                      left: proj.x - 4,\r\n                      top: proj.y - 4,\r\n                      border: \"2px dotted #fff\",\r\n                      opacity: 0.5,\r\n                    }}\r\n                  />\r\n                )\r\n              })}\r\n            {r.type === \"polygon1\" &&\r\n            r.highlighted &&\r\n            !dragWithPrimary &&\r\n            !zoomWithPrimary &&\r\n            !r.locked &&\r\n            !r.open &&\r\n            r.points.length > 1 &&\r\n            r.points\r\n                .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\r\n                .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\r\n                .map((pa, i) => {\r\n                    const proj = mat\r\n                        .clone()\r\n                        .inverse()\r\n                        .applyToPoint(pa[0] * iw, pa[1] * ih)\r\n                    return (\r\n                        <TransformMyStyles\r\n                            key={i}\r\n                            {...mouseEvents}\r\n                            onMouseDown={(e) => {\r\n                                if (e.button === 0) return onAddPolygon1Point(r, pa, i + 1)\r\n                                mouseEvents.onMouseDown(e)\r\n                            }}\r\n                            style={{\r\n                                cursor: \"copy\",\r\n                                zIndex: 10,\r\n                                left: proj.x - 4,\r\n                                top: proj.y - 4,\r\n                                border: \"2px dotted #fff\",\r\n                                opacity: 0.5,\r\n                            }}\r\n                        />\r\n                    )\r\n                })}\r\n        </div>\r\n      </Fragment>\r\n    )\r\n  },\r\n  arePropsEqual\r\n)\r\n\r\nexport const RegionSelectAndTransformBoxes = memo(\r\n  (props) => {\r\n    return props.regions\r\n      .filter((r) => r.visible || r.visible === undefined)\r\n      .filter((r) => !r.locked)\r\n      .map((r, i) => {\r\n        return <RegionSelectAndTransformBox key={r.id} {...props} region={r} />\r\n      })\r\n  },\r\n  (n, p) => n.regions === p.regions && n.mat === p.mat\r\n)\r\n\r\nexport default RegionSelectAndTransformBoxes\r\n"]},"metadata":{},"sourceType":"module"}