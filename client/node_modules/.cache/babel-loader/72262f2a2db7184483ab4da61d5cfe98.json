{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\pccis\\\\Desktop\\\\ML4GIS-develop\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{Fragment,memo}from\"react\";import{styled}from\"@material-ui/core/styles\";var TransformMyStyles=styled(\"div\")({width:8,height:8,zIndex:2,border:\"2px solid #FFF\",position:\"absolute\"});var boxCursorMap=[[\"nw-resize\",\"n-resize\",\"ne-resize\"],[\"w-resize\",\"grab\",\"e-resize\"],[\"sw-resize\",\"s-resize\",\"se-resize\"]];var arePropsEqual=function arePropsEqual(prev,next){return prev.region===next.region&&prev.dragWithPrimary===next.dragWithPrimary&&prev.createWithPrimary===next.createWithPrimary&&prev.zoomWithPrimary===next.zoomWithPrimary&&prev.mat===next.mat;};export var RegionSelectAndTransformBox=memo(function(_ref){var r=_ref.region,mouseEvents=_ref.mouseEvents,projectRegionBox=_ref.projectRegionBox,dragWithPrimary=_ref.dragWithPrimary,createWithPrimary=_ref.createWithPrimary,zoomWithPrimary=_ref.zoomWithPrimary,onBeginMovePoint=_ref.onBeginMovePoint,onSelectRegion=_ref.onSelectRegion,layoutParams=_ref.layoutParams,mat=_ref.mat,onBeginBoxTransform=_ref.onBeginBoxTransform,onBeginMovePolygonPoint=_ref.onBeginMovePolygonPoint,onBeginMovePolygon1Point=_ref.onBeginMovePolygon1Point,onBeginMoveKeypoint=_ref.onBeginMoveKeypoint,onAddPolygonPoint=_ref.onAddPolygonPoint,onAddPolygon1Point=_ref.onAddPolygon1Point,onBeginCircleTransform=_ref.onBeginCircleTransform;var pbox=projectRegionBox(r);var _layoutParams$current=layoutParams.current,iw=_layoutParams$current.iw,ih=_layoutParams$current.ih;return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,r.type===\"rectangle\"&&!dragWithPrimary&&!zoomWithPrimary&&!r.locked&&r.highlighted&&mat.a<1.2&&[[0,0],[0.5,0],[1,0],[1,0.5],[1,1],[0.5,1],[0,1],[0,0.5],[0.5,0.5]].map(function(_ref2,i){var _ref3=_slicedToArray(_ref2,2),px=_ref3[0],py=_ref3[1];return/*#__PURE__*/React.createElement(TransformMyStyles,Object.assign({key:i},mouseEvents,{onMouseDown:function onMouseDown(e){if(e.button===0)return onBeginBoxTransform(r,[px*2-1,py*2-1]);mouseEvents.onMouseDown(e);},style:{left:pbox.x-4-2+pbox.w*px,top:pbox.y-4-2+pbox.h*py,cursor:boxCursorMap[py*2][px*2],borderRadius:px===0.5&&py===0.5?4:undefined}}));}),r.type===\"circle\"&&!dragWithPrimary&&!zoomWithPrimary&&!r.locked&&r.highlighted&&[[r.x,r.y],[(r.x*iw+Math.sqrt(Math.pow((r.xr-r.x)*iw,2)+Math.pow((r.yr-r.y)*ih,2)))/iw,r.y],[r.x,(r.y*ih+Math.sqrt(Math.pow((r.xr-r.x)*iw,2)+Math.pow((r.yr-r.y)*ih,2)))/ih],[(r.x*iw-Math.sqrt(Math.pow((r.xr-r.x)*iw,2)+Math.pow((r.yr-r.y)*ih,2)))/iw,r.y],[r.x,(r.y*ih-Math.sqrt(Math.pow((r.xr-r.x)*iw,2)+Math.pow((r.yr-r.y)*ih,2)))/ih]].map(function(_ref4,i){var _ref5=_slicedToArray(_ref4,2),px=_ref5[0],py=_ref5[1];var proj=mat.clone().inverse().applyToPoint(px*iw,py*ih);return/*#__PURE__*/React.createElement(\"div\",Object.assign({key:i// className={classes.transformGrabber}\n},mouseEvents,{onMouseDown:function onMouseDown(e){if(e.button===0&&i==0){return onBeginCircleTransform(r,\"MOVE_REGION\");}else if(e.button===0&&i!=0){return onBeginCircleTransform(r,\"RESIZE_CIRCLE\");}mouseEvents.onMouseDown(e);},style:{left:proj.x-4,top:proj.y-4,borderRadius:px===r.x&&py===r.y?4:undefined}}));}),r.type===\"polygon\"&&!dragWithPrimary&&!zoomWithPrimary&&!r.locked&&r.highlighted&&r.points.map(function(_ref6,i){var _ref7=_slicedToArray(_ref6,2),px=_ref7[0],py=_ref7[1];var proj=mat.clone().inverse().applyToPoint(px*iw,py*ih);return/*#__PURE__*/React.createElement(TransformMyStyles,Object.assign({key:i},mouseEvents,{onMouseDown:function onMouseDown(e){if(e.button===0&&(!r.open||i===0))return onBeginMovePolygonPoint(r,i);mouseEvents.onMouseDown(e);},style:{cursor:!r.open?\"move\":i===0?\"pointer\":undefined,zIndex:10,pointerEvents:r.open&&i===r.points.length-1?\"none\":undefined,left:proj.x-4,top:proj.y-4}}));}),r.type===\"polygon1\"&&!dragWithPrimary&&!zoomWithPrimary&&!r.locked&&r.highlighted&&r.points.map(function(_ref8,i){var _ref9=_slicedToArray(_ref8,2),px=_ref9[0],py=_ref9[1];var proj=mat.clone().inverse().applyToPoint(px*iw,py*ih);return/*#__PURE__*/React.createElement(TransformMyStyles,Object.assign({key:i},mouseEvents,{onMouseDown:function onMouseDown(e){if(e.button===0&&(!r.open||i===0))return onBeginMovePolygon1Point(r,i);mouseEvents.onMouseDown(e);},style:{cursor:!r.open?\"move\":i===0?\"pointer\":undefined,zIndex:10,pointerEvents:r.open&&i===r.points.length-1?\"none\":undefined,left:proj.x-4,top:proj.y-4}}));}),r.type===\"polygon\"&&r.highlighted&&!dragWithPrimary&&!zoomWithPrimary&&!r.locked&&!r.open&&r.points.length>1&&r.points.map(function(p1,i){return[p1,r.points[(i+1)%r.points.length]];}).map(function(_ref10){var _ref11=_slicedToArray(_ref10,2),p1=_ref11[0],p2=_ref11[1];return[(p1[0]+p2[0])/2,(p1[1]+p2[1])/2];}).map(function(pa,i){var proj=mat.clone().inverse().applyToPoint(pa[0]*iw,pa[1]*ih);return/*#__PURE__*/React.createElement(TransformMyStyles,Object.assign({key:i},mouseEvents,{onMouseDown:function onMouseDown(e){if(e.button===0)return onAddPolygonPoint(r,pa,i+1);mouseEvents.onMouseDown(e);},style:{cursor:\"copy\",zIndex:10,left:proj.x-4,top:proj.y-4,border:\"2px dotted #fff\",opacity:0.5}}));}),r.type===\"polygon1\"&&r.highlighted&&!dragWithPrimary&&!zoomWithPrimary&&!r.locked&&!r.open&&r.points.length>1&&r.points.map(function(p1,i){return[p1,r.points[(i+1)%r.points.length]];}).map(function(_ref12){var _ref13=_slicedToArray(_ref12,2),p1=_ref13[0],p2=_ref13[1];return[(p1[0]+p2[0])/2,(p1[1]+p2[1])/2];}).map(function(pa,i){var proj=mat.clone().inverse().applyToPoint(pa[0]*iw,pa[1]*ih);return/*#__PURE__*/React.createElement(TransformMyStyles,Object.assign({key:i},mouseEvents,{onMouseDown:function onMouseDown(e){if(e.button===0)return onAddPolygon1Point(r,pa,i+1);mouseEvents.onMouseDown(e);},style:{cursor:\"copy\",zIndex:10,left:proj.x-4,top:proj.y-4,border:\"2px dotted #fff\",opacity:0.5}}));})));},arePropsEqual);export var RegionSelectAndTransformBoxes=memo(function(props){return props.regions.filter(function(r){return r.visible||r.visible===undefined;}).filter(function(r){return!r.locked;}).map(function(r,i){return/*#__PURE__*/React.createElement(RegionSelectAndTransformBox,Object.assign({key:r.id},props,{region:r}));});},function(n,p){return n.regions===p.regions&&n.mat===p.mat;});export default RegionSelectAndTransformBoxes;","map":{"version":3,"sources":["C:/Users/pccis/Desktop/ML4GIS-develop/client/src/pages/Home/annotateComponents/TransformBoxes/main_TransformBoxes.js"],"names":["React","Fragment","memo","styled","TransformMyStyles","width","height","zIndex","border","position","boxCursorMap","arePropsEqual","prev","next","region","dragWithPrimary","createWithPrimary","zoomWithPrimary","mat","RegionSelectAndTransformBox","r","mouseEvents","projectRegionBox","onBeginMovePoint","onSelectRegion","layoutParams","onBeginBoxTransform","onBeginMovePolygonPoint","onBeginMovePolygon1Point","onBeginMoveKeypoint","onAddPolygonPoint","onAddPolygon1Point","onBeginCircleTransform","pbox","current","iw","ih","type","locked","highlighted","a","map","i","px","py","e","button","onMouseDown","left","x","w","top","y","h","cursor","borderRadius","undefined","Math","sqrt","pow","xr","yr","proj","clone","inverse","applyToPoint","points","open","pointerEvents","length","p1","p2","pa","opacity","RegionSelectAndTransformBoxes","props","regions","filter","visible","id","n","p"],"mappings":"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","sourcesContent":["import React, { Fragment, memo } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst TransformMyStyles = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\",\n})\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"],\n]\n\nconst arePropsEqual = (prev, next) => {\n  return (\n    prev.region === next.region &&\n    prev.dragWithPrimary === next.dragWithPrimary &&\n    prev.createWithPrimary === next.createWithPrimary &&\n    prev.zoomWithPrimary === next.zoomWithPrimary &&\n    prev.mat === next.mat\n  )\n}\n\nexport const RegionSelectAndTransformBox = memo(\n  ({\n    region: r,\n    mouseEvents,\n    projectRegionBox,\n    dragWithPrimary,\n    createWithPrimary,\n    zoomWithPrimary,\n    onBeginMovePoint,\n    onSelectRegion,\n    layoutParams,\n    mat,\n    onBeginBoxTransform,\n    onBeginMovePolygonPoint,\n       onBeginMovePolygon1Point,\n    onBeginMoveKeypoint,\n    onAddPolygonPoint,\n       onAddPolygon1Point,\n       onBeginCircleTransform\n  }) => {\n    const pbox = projectRegionBox(r)\n    const { iw, ih } = layoutParams.current\n    return (\n      <Fragment>\n        <div>\n          {r.type === \"rectangle\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            mat.a < 1.2 &&\n            [\n              [0, 0],\n              [0.5, 0],\n              [1, 0],\n              [1, 0.5],\n              [1, 1],\n              [0.5, 1],\n              [0, 1],\n              [0, 0.5],\n              [0.5, 0.5],\n            ].map(([px, py], i) => (\n              <TransformMyStyles\n                key={i}\n                {...mouseEvents}\n                onMouseDown={(e) => {\n                  if (e.button === 0)\n                    return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                  mouseEvents.onMouseDown(e)\n                }}\n                style={{\n                  left: pbox.x - 4 - 2 + pbox.w * px,\n                  top: pbox.y - 4 - 2 + pbox.h * py,\n                  cursor: boxCursorMap[py * 2][px * 2],\n                  borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined,\n                }}\n              />\n            ))}\n            {\n                r.type === \"circle\" &&\n                !dragWithPrimary &&\n                !zoomWithPrimary &&\n                !r.locked &&\n                r.highlighted &&\n                [\n                    [r.x, r.y],\n                    [(r.x*iw + Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/iw, r.y],\n                    [r.x, (r.y*ih + Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/ih],\n                    [(r.x*iw - Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/iw, r.y],\n                    [r.x, (r.y*ih - Math.sqrt(Math.pow((r.xr-r.x)*iw,2) + Math.pow((r.yr-r.y)*ih,2)))/ih]\n                ].map(([px, py], i) => {\n                    const proj = mat\n                        .clone()\n                        .inverse()\n                        .applyToPoint(px * iw, py * ih)\n                    return(\n                        <div\n                            key={i}\n                            // className={classes.transformGrabber}\n                            {...mouseEvents}\n                            onMouseDown={e => {\n                                if (e.button === 0 && i==0){\n                                    return onBeginCircleTransform(r, \"MOVE_REGION\")\n                                }else if(e.button === 0 && i!=0){\n                                    return onBeginCircleTransform(r, \"RESIZE_CIRCLE\")\n                                }\n                                mouseEvents.onMouseDown(e)\n                            }}\n                            style={{\n                                left: proj.x - 4,\n                                top: proj.y - 4,\n                                borderRadius: px === r.x && py === r.y ? 4 : undefined\n                            }}\n                        />\n                    )\n                })\n            }\n          {r.type === \"polygon\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n              const proj = mat\n                .clone()\n                .inverse()\n                .applyToPoint(px * iw, py * ih)\n              return (\n                <TransformMyStyles\n                  key={i}\n                  {...mouseEvents}\n                  onMouseDown={(e) => {\n                    if (e.button === 0 && (!r.open || i === 0))\n                      return onBeginMovePolygonPoint(r, i)\n                    mouseEvents.onMouseDown(e)\n                  }}\n                  style={{\n                    cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                    zIndex: 10,\n                    pointerEvents:\n                      r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                    left: proj.x - 4,\n                    top: proj.y - 4,\n                  }}\n                />\n              )\n            })}\n            {r.type === \"polygon1\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n                const proj = mat\n                    .clone()\n                    .inverse()\n                    .applyToPoint(px * iw, py * ih)\n                return (\n                    <TransformMyStyles\n                        key={i}\n                        {...mouseEvents}\n                        onMouseDown={(e) => {\n                            if (e.button === 0 && (!r.open || i === 0))\n                                return onBeginMovePolygon1Point(r, i)\n                            mouseEvents.onMouseDown(e)\n                        }}\n                        style={{\n                            cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                            zIndex: 10,\n                            pointerEvents:\n                                r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                            left: proj.x - 4,\n                            top: proj.y - 4,\n                        }}\n                    />\n                )\n            })}\n          {r.type === \"polygon\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n              .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n              .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n              .map((pa, i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(pa[0] * iw, pa[1] * ih)\n                return (\n                  <TransformMyStyles\n                    key={i}\n                    {...mouseEvents}\n                    onMouseDown={(e) => {\n                      if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      cursor: \"copy\",\n                      zIndex: 10,\n                      left: proj.x - 4,\n                      top: proj.y - 4,\n                      border: \"2px dotted #fff\",\n                      opacity: 0.5,\n                    }}\n                  />\n                )\n              })}\n            {r.type === \"polygon1\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n                .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n                .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n                .map((pa, i) => {\n                    const proj = mat\n                        .clone()\n                        .inverse()\n                        .applyToPoint(pa[0] * iw, pa[1] * ih)\n                    return (\n                        <TransformMyStyles\n                            key={i}\n                            {...mouseEvents}\n                            onMouseDown={(e) => {\n                                if (e.button === 0) return onAddPolygon1Point(r, pa, i + 1)\n                                mouseEvents.onMouseDown(e)\n                            }}\n                            style={{\n                                cursor: \"copy\",\n                                zIndex: 10,\n                                left: proj.x - 4,\n                                top: proj.y - 4,\n                                border: \"2px dotted #fff\",\n                                opacity: 0.5,\n                            }}\n                        />\n                    )\n                })}\n        </div>\n      </Fragment>\n    )\n  },\n  arePropsEqual\n)\n\nexport const RegionSelectAndTransformBoxes = memo(\n  (props) => {\n    return props.regions\n      .filter((r) => r.visible || r.visible === undefined)\n      .filter((r) => !r.locked)\n      .map((r, i) => {\n        return <RegionSelectAndTransformBox key={r.id} {...props} region={r} />\n      })\n  },\n  (n, p) => n.regions === p.regions && n.mat === p.mat\n)\n\nexport default RegionSelectAndTransformBoxes\n"]},"metadata":{},"sourceType":"module"}