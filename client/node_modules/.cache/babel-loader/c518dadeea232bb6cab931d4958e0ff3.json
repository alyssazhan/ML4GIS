{"ast":null,"code":"import _classCallCheck from\"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\GitHub\\\\ML4GIS\\\\client\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import AnnotationTool from\"../annotateComponents/main_Annotate\";import Button from'react-bootstrap/Button';var env=process.env.NODE_ENV;var config=require(\"../../../config.json\");var SubmitHIT=/*#__PURE__*/function(_Component){_inherits(SubmitHIT,_Component);var _super=_createSuper(SubmitHIT);function SubmitHIT(props){var _this;_classCallCheck(this,SubmitHIT);_this=_super.call(this,props);_this.state={error:null,isLoaded:false,EnabledTools:null,AllowComments:null,Tags:null,imgData:null,Local:null};_this.props=props;_this.submitTask=_this.submitTask.bind(_assertThisInitialized(_this));_this.getSubmissionUrl=_this.getSubmissionUrl.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.componentDidMount=_this.componentDidMount(_assertThisInitialized(_this));return _this;}_createClass(SubmitHIT,[{key:\"getTools\",value:function getTools(res){console.log(\"get tool:\",res.Tools['enenabledTools']);}//get data from api\n},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;function getEnabledTools(data){var enabledTools=data[\"enabledTools\"];var res=[];for(var i=0;i<enabledTools.length;i++){if(enabledTools[i][\"create point\"]==true){res.push(\"create-point\");}else if(enabledTools[i][\"create rectangle\"]==true){res.push(\"create-rectangle\");}else if(enabledTools[i][\"create polygon\"]==true){res.push(\"create-polygon\");}else if(enabledTools[i][\"create polygon1\"]==true){res.push(\"create-polygon1\");}else if(enabledTools[i][\"create ellipse\"]==true){res.push(\"create-circle\");}}return res;}fetch(\"./backendConfig.json\").then(function(res){return res.json();}).then(function(result){var enabledTools=getEnabledTools(result[\"setup\"]);if(result[\"setup\"][\"importData\"]){_this2.setState({imgData:result[\"setup\"][\"importData\"]});}else{_this2.setState({imgData:result[\"setup\"][\"defaultImgData\"]});}_this2.setState({isLoaded:true,EnabledTools:enabledTools,AllowComments:result[\"setup\"][\"allow-comments\"],Tags:result[\"setup\"][\"tags\"],Local:result[\"setup\"][\"local\"]});console.log(\"res is: \",result);},// Note: it's important to handle errors here\n// instead of a catch() block so that we don't swallow\n// exceptions from actual bugs in components.\nfunction(error){_this2.setState({isLoaded:true,error:error});});}},{key:\"parseParameters\",value:function parseParameters(url){var params={'assignmentId':null,'hitId':null,'workerId':null,'turkSubmitTo':null};var queryString=url.split('?')[1];if(queryString){var queryPieces=queryString.split('&');for(var i=0;i<queryPieces.length;++i){var pieces=queryPieces[i].split('=');var paramName=pieces[0];var paramValue=pieces[1];if(paramName in params){params[paramName]=paramValue;}}}return params;}},{key:\"handleSubmit\",value:function handleSubmit(e){e.preventDefault();var input=document.getElementById('submitButton');input.setAttribute('value',JSON.stringify(this.state.imgData));console.log(input);var form=document.getElementById('submitForm');HTMLFormElement.prototype.submit.call(form);}},{key:\"submitTask\",value:function submitTask(e){// e.preventDefault();\nconsole.log(\"POSTing data\");axios.post(\"\".concat(this.getSubmissionUrl()),{}).then(function(response){console.log(response);}).catch(function(error){console.log(error);});}},{key:\"getSubmissionUrl\",value:function getSubmissionUrl(){var mturkParams=this.parseParameters(window.location.href);var assignmentID=mturkParams['assignmentId'];var url=config[\"submit\"][env]+\"/?assignmentId=\"+assignmentID;console.log(url);return url;}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,error=_this$state.error,isLoaded=_this$state.isLoaded,EnabledTools=_this$state.EnabledTools,AllowComments=_this$state.AllowComments,Tags=_this$state.Tags,imgData=_this$state.imgData,Local=_this$state.Local;console.log(\"render data is:\",this.state);if(error){return/*#__PURE__*/React.createElement(\"div\",null,\"Error: \",error.message);}else if(!isLoaded){return/*#__PURE__*/React.createElement(\"div\",null,\"Loading...\");}else if(Local){return/*#__PURE__*/React.createElement(\"div\",{id:\"Submit\"},/*#__PURE__*/React.createElement(\"form\",{id:\"submitForm\",type:\"submit\",method:\"POST\"},/*#__PURE__*/React.createElement(AnnotationTool,{name:\"AnnotationTool\",type:\"submit\",ref:function ref(value){_this3.value=value;},images:imgData,enabledTools:EnabledTools,regionTagList:Tags,allowComments:AllowComments,Local:Local,imgData:imgData,onExit:function onExit(output){_this3.setState({imgData:output.images});console.log(\"output:\",JSON.stringify(output.images));console.log(typeof{imgData:imgData});console.log({imgData:imgData});}}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{variant:\"outline-dark\",size:\"lg\",block:true,name:\"Annotation\",type:\"submit\",id:\"submitButton\",href:\"data:text/json;charset=utf-8,\".concat(encodeURIComponent(JSON.stringify(this.state.imgData))),download:\"results.json\"},\"Download Annotations as Json File\"))));}else{return/*#__PURE__*/React.createElement(\"div\",{id:\"Submit\"},/*#__PURE__*/React.createElement(\"form\",{id:\"submitForm\",type:\"submit\",method:\"POST\",action:this.getSubmissionUrl()},/*#__PURE__*/React.createElement(AnnotationTool,{name:\"AnnotationTool\",type:\"submit\",ref:function ref(value){_this3.value=value;},images:imgData,enabledTools:EnabledTools,regionTagList:Tags,allowComments:AllowComments,Local:Local,imgData:imgData,onExit:function onExit(output){_this3.setState({imgData:output.images});console.log(\"output:\",JSON.stringify(output.images));}}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{variant:\"outline-dark\",size:\"lg\",block:true,name:\"Annotation\",type:\"submit\",id:\"submitButton\",value:JSON.stringify(this.state.imgData),ref:function ref(value){_this3.value=value;}},\"Complete the HIT\"))));}}}]);return SubmitHIT;}(Component);export{SubmitHIT as default};","map":{"version":3,"sources":["D:/GitHub/ML4GIS/client/src/pages/Home/SubmitHIT/main_SubmitHIT.js"],"names":["React","Component","axios","AnnotationTool","Button","env","process","NODE_ENV","config","require","SubmitHIT","props","state","error","isLoaded","EnabledTools","AllowComments","Tags","imgData","Local","submitTask","bind","getSubmissionUrl","handleSubmit","componentDidMount","res","console","log","Tools","getEnabledTools","data","enabledTools","i","length","push","fetch","then","json","result","setState","url","params","queryString","split","queryPieces","pieces","paramName","paramValue","e","preventDefault","input","document","getElementById","setAttribute","JSON","stringify","form","HTMLFormElement","prototype","submit","call","post","response","catch","mturkParams","parseParameters","window","location","href","assignmentID","message","value","output","images","encodeURIComponent"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport AnnotationTool from \"../annotateComponents/main_Annotate\";\r\nimport Button from 'react-bootstrap/Button';\r\n\r\nvar env = process.env.NODE_ENV;\r\nvar config = require(\"../../../config.json\");\r\n\r\nexport default class SubmitHIT extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            error: null,\r\n            isLoaded: false,\r\n            EnabledTools:null,\r\n            AllowComments:null,\r\n            Tags:null,\r\n            imgData: null,\r\n            Local:null\r\n        }\r\n\r\n        this.props = props;\r\n        this.submitTask = this.submitTask.bind(this);\r\n        this.getSubmissionUrl = this.getSubmissionUrl.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.componentDidMount=this.componentDidMount(this);\r\n\r\n    }\r\n    getTools(res){\r\n        console.log(\"get tool:\",res.Tools['enenabledTools'])\r\n\r\n    }\r\n//get data from api\r\n    componentDidMount() {\r\n        function getEnabledTools(data) {\r\n            const enabledTools=data[\"enabledTools\"]\r\n            var res=[]\r\n            for (var i = 0; i < enabledTools.length; i++) {\r\n                if (enabledTools[i][\"create point\"]==true){\r\n                    res.push(\"create-point\")\r\n                }\r\n                else if (enabledTools[i][\"create rectangle\"]==true){\r\n                    res.push(\"create-rectangle\")\r\n                }\r\n                else if(enabledTools[i][\"create polygon\"]==true){\r\n                    res.push(\"create-polygon\")\r\n                }\r\n                else if(enabledTools[i][\"create polygon1\"]==true){\r\n                    res.push(\"create-polygon1\")\r\n                }\r\n                else if(enabledTools[i][\"create ellipse\"]==true){\r\n                    res.push(\"create-circle\")\r\n                }\r\n            }\r\n            return res\r\n        }\r\n\r\n        fetch(\"./backendConfig.json\")\r\n            .then(res => res.json())\r\n            .then(\r\n                (result) => {\r\n                    const enabledTools=getEnabledTools(result[\"setup\"])\r\n                    if (result[\"setup\"][\"importData\"]) {\r\n                        this.setState({imgData:result[\"setup\"][\"importData\"]});\r\n                    } else {\r\n                        this.setState({imgData:result[\"setup\"][\"defaultImgData\"]});\r\n                    }\r\n                    \r\n                    this.setState({\r\n                        isLoaded: true,\r\n                        EnabledTools:enabledTools,\r\n                        AllowComments:result[\"setup\"][\"allow-comments\"],\r\n                        Tags:result[\"setup\"][\"tags\"],\r\n                        Local:result[\"setup\"][\"local\"],\r\n                    });\r\n\r\n\r\n\r\n                    console.log(\"res is: \", result)\r\n                },\r\n                // Note: it's important to handle errors here\r\n                // instead of a catch() block so that we don't swallow\r\n                // exceptions from actual bugs in components.\r\n                (error) => {\r\n                    this.setState({\r\n                        isLoaded: true,\r\n                        error\r\n                    });\r\n                }\r\n            )\r\n    }\r\n\r\n    parseParameters(url){\r\n        var params = {\r\n            'assignmentId' : null,\r\n            'hitId' : null,\r\n            'workerId' : null,\r\n            'turkSubmitTo' : null\r\n        };\r\n\r\n        var queryString = url.split('?')[1];\r\n\r\n        if (queryString){\r\n            var queryPieces = queryString.split('&');\r\n            for (var i = 0; i < queryPieces.length; ++i){\r\n                var pieces = queryPieces[i].split('=');\r\n                var paramName = pieces[0];\r\n                var paramValue = pieces[1];\r\n                if(paramName in params){\r\n                    params[paramName] = paramValue;\r\n                }\r\n            }\r\n        }\r\n\r\n        return params;\r\n    }\r\n\r\n    handleSubmit(e) {\r\n        e.preventDefault();\r\n        const input = document.getElementById('submitButton');\r\n        input.setAttribute('value', JSON.stringify(this.state.imgData));\r\n        console.log(input);\r\n        const form = document.getElementById('submitForm');\r\n        HTMLFormElement.prototype.submit.call(form);\r\n\r\n    }\r\n\r\n    submitTask(e) {\r\n        // e.preventDefault();\r\n        console.log(\"POSTing data\");\r\n        axios\r\n            .post(`${this.getSubmissionUrl()}`, {})\r\n            .then(function(response) {\r\n                console.log(response);\r\n            })\r\n            .catch(function(error) {\r\n                console.log(error);\r\n            });\r\n    }\r\n\r\n    getSubmissionUrl() {\r\n        let mturkParams = this.parseParameters(window.location.href);\r\n        const assignmentID =  mturkParams['assignmentId'];\r\n        const url = config[\"submit\"][env] + \"/?assignmentId=\" + assignmentID;\r\n        console.log(url);\r\n        return url;\r\n    }\r\n\r\n    render() {\r\n        const { error, isLoaded, EnabledTools, AllowComments, Tags, imgData, Local} = this.state;\r\n        console.log(\"render data is:\", this.state)\r\n        if (error) {\r\n            return <div>Error: {error.message}</div>;\r\n        } else if (!isLoaded) {\r\n            return <div>Loading...</div>;\r\n        } else if (Local) {\r\n            return (\r\n                <div id=\"Submit\">\r\n\r\n                    <form\r\n                        id=\"submitForm\"\r\n                        type=\"submit\"\r\n                        method=\"POST\"\r\n                    >\r\n                        <AnnotationTool\r\n                            name=\"AnnotationTool\"\r\n                            type=\"submit\"\r\n                            ref={value => {\r\n                                this.value = value;\r\n                            }}\r\n                            images={imgData}\r\n                            enabledTools={EnabledTools}\r\n                            regionTagList={Tags}\r\n                            allowComments={AllowComments}\r\n                            Local={Local}\r\n                            imgData={imgData}\r\n                            onExit={output => {\r\n                                this.setState({imgData: output.images});\r\n                                console.log(\"output:\", JSON.stringify(output.images));\r\n                                console.log(typeof({imgData}));\r\n                                console.log({imgData});\r\n                            }}\r\n\r\n                        />\r\n                        <div>\r\n                            <Button\r\n                                variant=\"outline-dark\" size=\"lg\" block\r\n                                name=\"Annotation\"\r\n                                type=\"submit\"\r\n                                id=\"submitButton\"\r\n                                href={`data:text/json;charset=utf-8,${encodeURIComponent(\r\n                                JSON.stringify(this.state.imgData)\r\n                                )}`}\r\n                                download=\"results.json\"\r\n                            >\r\n                            {`Download Annotations as Json File`}\r\n                            </Button>   \r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (\r\n                <div id=\"Submit\">\r\n\r\n                    <form\r\n                        id=\"submitForm\"\r\n                        type=\"submit\"\r\n                        method=\"POST\"\r\n                        action={this.getSubmissionUrl()}\r\n                    >\r\n                        <AnnotationTool\r\n                            name=\"AnnotationTool\"\r\n                            type=\"submit\"\r\n                            ref={value => {\r\n                                this.value = value;\r\n                            }}\r\n                            images={imgData}\r\n                            enabledTools={EnabledTools}\r\n                            regionTagList={Tags}\r\n                            allowComments={AllowComments}\r\n                            Local={Local}\r\n                            imgData={imgData}\r\n                            onExit={output => {\r\n                                this.setState({imgData: output.images});\r\n                                console.log(\"output:\", JSON.stringify(output.images));\r\n                            }}\r\n\r\n                        />\r\n                        <div>\r\n                            <Button variant=\"outline-dark\" size=\"lg\" block\r\n                                    name=\"Annotation\"\r\n                                    type=\"submit\"\r\n                                    id=\"submitButton\"\r\n                                    value={JSON.stringify(this.state.imgData)}\r\n                                    ref={value => {\r\n                                        this.value = value;\r\n                                    }}\r\n                            >Complete the HIT</Button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}