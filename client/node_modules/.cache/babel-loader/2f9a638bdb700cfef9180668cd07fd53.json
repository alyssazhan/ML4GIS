{"ast":null,"code":"var _jsxFileName = \"/Users/yan/Documents/GItHub/ML4GIS/client/src/pages/Home/annotateComponents/TransformBoxes/main_TransformBoxes.js\";\nimport React, { Fragment, memo } from \"react\";\nimport { styled } from \"@material-ui/core/styles\";\nconst TransformMyStyles = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\"\n});\nconst boxCursorMap = [[\"nw-resize\", \"n-resize\", \"ne-resize\"], [\"w-resize\", \"grab\", \"e-resize\"], [\"sw-resize\", \"s-resize\", \"se-resize\"]];\n\nconst arePropsEqual = (prev, next) => {\n  return prev.region === next.region && prev.dragWithPrimary === next.dragWithPrimary && prev.createWithPrimary === next.createWithPrimary && prev.zoomWithPrimary === next.zoomWithPrimary && prev.mat === next.mat;\n};\n\nexport const RegionSelectAndTransformBox = memo(({\n  region: r,\n  mouseEvents,\n  projectRegionBox,\n  dragWithPrimary,\n  createWithPrimary,\n  zoomWithPrimary,\n  onBeginMovePoint,\n  onSelectRegion,\n  layoutParams,\n  mat,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onBeginMovePolygon1Point,\n  onBeginMoveKeypoint,\n  onAddPolygonPoint,\n  onAddPolygon1Point\n}) => {\n  const pbox = projectRegionBox(r);\n  const _layoutParams$current = layoutParams.current,\n        iw = _layoutParams$current.iw,\n        ih = _layoutParams$current.ih;\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, r.type === \"rectangle\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && mat.a < 1.2 && [[0, 0], [0.5, 0], [1, 0], [1, 0.5], [1, 1], [0.5, 1], [0, 1], [0, 0.5], [0.5, 0.5]].map(([px, py], i) => /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n    key: i\n  }, mouseEvents, {\n    onMouseDown: e => {\n      if (e.button === 0) return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1]);\n      mouseEvents.onMouseDown(e);\n    },\n    style: {\n      left: pbox.x - 4 - 2 + pbox.w * px,\n      top: pbox.y - 4 - 2 + pbox.h * py,\n      cursor: boxCursorMap[py * 2][px * 2],\n      borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 15\n    }\n  }))), r.type === \"polygon\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && r.points.map(([px, py], i) => {\n    const proj = mat.clone().inverse().applyToPoint(px * iw, py * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: e => {\n        if (e.button === 0 && (!r.open || i === 0)) return onBeginMovePolygonPoint(r, i);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n        zIndex: 10,\n        pointerEvents: r.open && i === r.points.length - 1 ? \"none\" : undefined,\n        left: proj.x - 4,\n        top: proj.y - 4\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }\n    }));\n  }), r.type === \"polygon1\" && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && r.points.map(([px, py], i) => {\n    const proj = mat.clone().inverse().applyToPoint(px * iw, py * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: e => {\n        if (e.button === 0 && (!r.open || i === 0)) return onBeginMovePolygon1Point(r, i);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n        zIndex: 10,\n        pointerEvents: r.open && i === r.points.length - 1 ? \"none\" : undefined,\n        left: proj.x - 4,\n        top: proj.y - 4\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 21\n      }\n    }));\n  }), r.type === \"polygon\" && r.highlighted && !dragWithPrimary && !zoomWithPrimary && !r.locked && !r.open && r.points.length > 1 && r.points.map((p1, i) => [p1, r.points[(i + 1) % r.points.length]]).map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2]).map((pa, i) => {\n    const proj = mat.clone().inverse().applyToPoint(pa[0] * iw, pa[1] * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: e => {\n        if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: \"copy\",\n        zIndex: 10,\n        left: proj.x - 4,\n        top: proj.y - 4,\n        border: \"2px dotted #fff\",\n        opacity: 0.5\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 19\n      }\n    }));\n  }), r.type === \"polygon1\" && r.highlighted && !dragWithPrimary && !zoomWithPrimary && !r.locked && !r.open && r.points.length > 1 && r.points.map((p1, i) => [p1, r.points[(i + 1) % r.points.length]]).map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2]).map((pa, i) => {\n    const proj = mat.clone().inverse().applyToPoint(pa[0] * iw, pa[1] * ih);\n    return /*#__PURE__*/React.createElement(TransformMyStyles, Object.assign({\n      key: i\n    }, mouseEvents, {\n      onMouseDown: e => {\n        if (e.button === 0) return onAddPolygon1Point(r, pa, i + 1);\n        mouseEvents.onMouseDown(e);\n      },\n      style: {\n        cursor: \"copy\",\n        zIndex: 10,\n        left: proj.x - 4,\n        top: proj.y - 4,\n        border: \"2px dotted #fff\",\n        opacity: 0.5\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 25\n      }\n    }));\n  })));\n}, arePropsEqual);\nexport const RegionSelectAndTransformBoxes = memo(props => {\n  return props.regions.filter(r => r.visible || r.visible === undefined).filter(r => !r.locked).map((r, i) => {\n    return /*#__PURE__*/React.createElement(RegionSelectAndTransformBox, Object.assign({\n      key: r.id\n    }, props, {\n      region: r,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 16\n      }\n    }));\n  });\n}, (n, p) => n.regions === p.regions && n.mat === p.mat);\nexport default RegionSelectAndTransformBoxes;","map":{"version":3,"sources":["/Users/yan/Documents/GItHub/ML4GIS/client/src/pages/Home/annotateComponents/TransformBoxes/main_TransformBoxes.js"],"names":["React","Fragment","memo","styled","TransformMyStyles","width","height","zIndex","border","position","boxCursorMap","arePropsEqual","prev","next","region","dragWithPrimary","createWithPrimary","zoomWithPrimary","mat","RegionSelectAndTransformBox","r","mouseEvents","projectRegionBox","onBeginMovePoint","onSelectRegion","layoutParams","onBeginBoxTransform","onBeginMovePolygonPoint","onBeginMovePolygon1Point","onBeginMoveKeypoint","onAddPolygonPoint","onAddPolygon1Point","pbox","current","iw","ih","type","locked","highlighted","a","map","px","py","i","e","button","onMouseDown","left","x","w","top","y","h","cursor","borderRadius","undefined","points","proj","clone","inverse","applyToPoint","open","pointerEvents","length","p1","p2","pa","opacity","RegionSelectAndTransformBoxes","props","regions","filter","visible","id","n","p"],"mappings":"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","sourcesContent":["import React, { Fragment, memo } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst TransformMyStyles = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\",\n})\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"],\n]\n\nconst arePropsEqual = (prev, next) => {\n  return (\n    prev.region === next.region &&\n    prev.dragWithPrimary === next.dragWithPrimary &&\n    prev.createWithPrimary === next.createWithPrimary &&\n    prev.zoomWithPrimary === next.zoomWithPrimary &&\n    prev.mat === next.mat\n  )\n}\n\nexport const RegionSelectAndTransformBox = memo(\n  ({\n    region: r,\n    mouseEvents,\n    projectRegionBox,\n    dragWithPrimary,\n    createWithPrimary,\n    zoomWithPrimary,\n    onBeginMovePoint,\n    onSelectRegion,\n    layoutParams,\n    mat,\n    onBeginBoxTransform,\n    onBeginMovePolygonPoint,\n       onBeginMovePolygon1Point,\n    onBeginMoveKeypoint,\n    onAddPolygonPoint,\n       onAddPolygon1Point,\n  }) => {\n    const pbox = projectRegionBox(r)\n    const { iw, ih } = layoutParams.current\n    return (\n      <Fragment>\n        <div>\n          {r.type === \"rectangle\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            mat.a < 1.2 &&\n            [\n              [0, 0],\n              [0.5, 0],\n              [1, 0],\n              [1, 0.5],\n              [1, 1],\n              [0.5, 1],\n              [0, 1],\n              [0, 0.5],\n              [0.5, 0.5],\n            ].map(([px, py], i) => (\n              <TransformMyStyles\n                key={i}\n                {...mouseEvents}\n                onMouseDown={(e) => {\n                  if (e.button === 0)\n                    return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                  mouseEvents.onMouseDown(e)\n                }}\n                style={{\n                  left: pbox.x - 4 - 2 + pbox.w * px,\n                  top: pbox.y - 4 - 2 + pbox.h * py,\n                  cursor: boxCursorMap[py * 2][px * 2],\n                  borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined,\n                }}\n              />\n            ))}\n          {r.type === \"polygon\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n              const proj = mat\n                .clone()\n                .inverse()\n                .applyToPoint(px * iw, py * ih)\n              return (\n                <TransformMyStyles\n                  key={i}\n                  {...mouseEvents}\n                  onMouseDown={(e) => {\n                    if (e.button === 0 && (!r.open || i === 0))\n                      return onBeginMovePolygonPoint(r, i)\n                    mouseEvents.onMouseDown(e)\n                  }}\n                  style={{\n                    cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                    zIndex: 10,\n                    pointerEvents:\n                      r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                    left: proj.x - 4,\n                    top: proj.y - 4,\n                  }}\n                />\n              )\n            })}\n            {r.type === \"polygon1\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n                const proj = mat\n                    .clone()\n                    .inverse()\n                    .applyToPoint(px * iw, py * ih)\n                return (\n                    <TransformMyStyles\n                        key={i}\n                        {...mouseEvents}\n                        onMouseDown={(e) => {\n                            if (e.button === 0 && (!r.open || i === 0))\n                                return onBeginMovePolygon1Point(r, i)\n                            mouseEvents.onMouseDown(e)\n                        }}\n                        style={{\n                            cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                            zIndex: 10,\n                            pointerEvents:\n                                r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                            left: proj.x - 4,\n                            top: proj.y - 4,\n                        }}\n                    />\n                )\n            })}\n          {r.type === \"polygon\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n              .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n              .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n              .map((pa, i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(pa[0] * iw, pa[1] * ih)\n                return (\n                  <TransformMyStyles\n                    key={i}\n                    {...mouseEvents}\n                    onMouseDown={(e) => {\n                      if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      cursor: \"copy\",\n                      zIndex: 10,\n                      left: proj.x - 4,\n                      top: proj.y - 4,\n                      border: \"2px dotted #fff\",\n                      opacity: 0.5,\n                    }}\n                  />\n                )\n              })}\n            {r.type === \"polygon1\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n                .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n                .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n                .map((pa, i) => {\n                    const proj = mat\n                        .clone()\n                        .inverse()\n                        .applyToPoint(pa[0] * iw, pa[1] * ih)\n                    return (\n                        <TransformMyStyles\n                            key={i}\n                            {...mouseEvents}\n                            onMouseDown={(e) => {\n                                if (e.button === 0) return onAddPolygon1Point(r, pa, i + 1)\n                                mouseEvents.onMouseDown(e)\n                            }}\n                            style={{\n                                cursor: \"copy\",\n                                zIndex: 10,\n                                left: proj.x - 4,\n                                top: proj.y - 4,\n                                border: \"2px dotted #fff\",\n                                opacity: 0.5,\n                            }}\n                        />\n                    )\n                })}\n        </div>\n      </Fragment>\n    )\n  },\n  arePropsEqual\n)\n\nexport const RegionSelectAndTransformBoxes = memo(\n  (props) => {\n    return props.regions\n      .filter((r) => r.visible || r.visible === undefined)\n      .filter((r) => !r.locked)\n      .map((r, i) => {\n        return <RegionSelectAndTransformBox key={r.id} {...props} region={r} />\n      })\n  },\n  (n, p) => n.regions === p.regions && n.mat === p.mat\n)\n\nexport default RegionSelectAndTransformBoxes\n"]},"metadata":{},"sourceType":"module"}